= Security testing
include::platform:ROOT:partial$templates/document-attributes/default-set-en.adoc[]

== Introduction

The purpose of the Security Testing approach is to outline the strategy, objectives, and scope of security testing for the _Registries Platform_. It provides a thorough description on how security vulnerabilities are identified and addressed to ensure the protection of sensitive data and maintain the integrity of the application.

=== Scope of the Security Testing
The security testing focused on identifying vulnerabilities within the Registries Platform web application and related infrastructure. It covers areas such as authentication, authorization, input validation, session management, data encryption, and secure configuration. 

=== Objectives
The main objectives of security testing are:

* Identify security vulnerabilities and weaknesses in the application.
* Assess the effectiveness of existing security controls.
* Address identified vulnerabilities and improving the overall security posture.

=== References

The Registries Platform is developed following the next security standards:

* The software security posture management according to OWASP Software Assurance Maturity Model (SAMM).
* The OWASP Application Security Verification Standard (ASVS) Project as a basis for testing web application technical security controls and source of requirements for secure development.
* Center for Internet Security Software Supply Chain Security Guide (CIS SSCS) as a basis for supply chain security
* Comprehensive information protection system (CIS) - legislative certification for information security controls, a set of technical measures that ensure information protection in Information and Communication Technology (ICT) system.


== Security Testing Approach
=== Security Testing Methodologies

The security testing follow a combination of manual and automated testing approaches. It include vulnerability scanning, penetration testing, code reviews, gitops security, cloud security posture management and security best practices analysis.

Security testing methodologies are systematic approaches used to identify and assess security vulnerabilities and weaknesses in software applications, networks, or systems. They help ensure that security testing is conducted effectively and comprehensively. Here are the list of used security testing methodologies:

* **Penetration Testing (Pen Test)**:
Penetration Testing, often referred to as "pen testing" or "ethical hacking," is a method of assessing the security of a computer system, network, application, or organization by simulating real-world cyberattacks. The primary objective of penetration testing is to identify vulnerabilities and weaknesses that malicious attackers could exploit to compromise the system or steal sensitive information. 

* **Threat Modeling:**
Threat modeling involves identifying potential threats and risks to a system or application. It helps in understanding possible attack vectors and aids in making informed decisions about security measures. 
We are trying to adopt continuous Threat Modeling which is an iterative and ongoing process of identifying and analyzing potential security threats and risks throughout the entire software development lifecycle. 

* **Secure Software Development Lifecycle (SSDLC):**
It is a structured and systematic approach to software development that integrates security practices at every stage of the development process.

* **Secure Architecture Assessment:**
The Architecture Assessment approach ensures that the application and infrastructure architecture adequately meets all relevant security and compliance requirements, and sufficiently mitigates identified security threats.


=== Tools and Technologies Used
The following types, tools and technologies are used during security testing:

|===
| Security testing type | Toolset
| Static Application Security Testing (SAST)
| Semgrep

| Software Composition Analysis (SCA)
a| 
- CycloneDx SBOM
- OWASP Dependency Track

| Secrets scanning
| Detect Secrets

| Iaac security
| KICS

| Container orchestration security
| Kube bench

| Container security
| Trivy

| Dynamic Application Security Testing (DAST)
| OWASP ZAP

| Security Cloud Posture Management
| Qualys CloudView
|===

=== Description of the Test Environment

Security testing continiously conducted on separate prod like environment which is owned and managed by Security Team. 

== Security Test Scenarios

Here are a set of specific test cases or situations designed to evaluate the security aspects of the Regitry Platform:

[cols="3a,3a,3a"]
|===
| Information Leak | Buffer Overflow | Cloud Metadata Attack
| Code Injection | Command Injection | Cross Site Scripting (Reflected)
| Cross Site Scripting (Persistent) | CRLF Injection | Directory Browsing
| External Redirect | Format String Error | GET for POST
| Heartbleed OpenSSL Vulnerability | Hidden File Finder | Log4Shell (CVE-2021-44228 and CVE-2021-45046)
| Padding Oracle | Parameter Tampering | Path Traversal
| Remote Code Execution - CVE-2012-1823 | Remote File Include | Server Side Include
| Server Side Template Injection | Source Code Disclosure | Spring4Shell (CVE-2022-22965)
| SQL Injection | User Agent Fuzzing | XPath Injection
| XSLT Injection | XXE | ICMP checks
| Port checks | Check SSL/TLS | Content Security Policy (CSP)
| HSTS | Re-registration | Overwrite the existing user
| Uniqueness of the username | Weak Password Policy | Email Confirmation
| Disposable Email Addresses | Fuzz folder | Long password (200+)
| Authentication Testing | JSON attack | Resistance to password guessing
| XSS to name or email | Failure to confirm password when changing email, password or 2FA | User account blocking mechanism
| Rate limit | Check redirect on registration page after login | Broken Access Control
| Test tokens for predictability | Disclosure of Tokens | Safe termination of the session
| Session fixation | CSRF | Cookie scope
| Decode Cookie (Base64, hex, URL, etc.) | Expiration of cookies | Reuse of cookie after closing the session
| Log out and press the "return" function in the browser (Alt + left arrow) | Two instances are open, change or reset the 1st instance, update the 2nd instance | IDOR user profile
| CSRF user profile | Email validate | IDOR parameters
| Check the policies for different roles | Fuzzing all request parameters | Reflected XSS
| HTTP header injection in GET & POST (X Forwarded Host) | RCE via Referer Header | SQL injection via User-Agent Header
| Arbitrary redirection | Stored attacks | Script injection
| XPath injection | XXE in any request, change content-type to text/xl | Stored XSS
| HTTP Request Smuggling | Open redirect | SSRF in previously discovered open ports
| File upload
|===

== Test Data

Data that are inherently open was directly used during the testing process. Such data is publicly accessible and available on the respective resource https://data.gov.ua/dataset. Real and pure data are not used during testing process.

== Test Execution Phases

=== Architecture review

During architecture review of a new feature we examine correct provision of general security mechanisms such as authentication, authorization, user and rights management, secure communication, data protection, key management and log management.

Verifying that the solution architecture addresses all identified security and compliance requirements. All the application interfaces analyzed against the list of security and compliance requirements. Additionally data flow is amenable to analysis to ensure that the requirements are adequately addressed over different components.

Mentioned types of analysis are performed on both internal interfaces, e.g. between tiers, as well as external ones, e.g. those comprising the attack surface.

=== Threat modeling

We are striving to adopt continuous threat modeling approach and build iterative and ongoing process of identifying and assessing potential security threats and vulnerabilities throughout the entire software development lifecycle. 
Currently the threat model is made for the entire application andalmost all the changes incrementally modeled in order to discover possible new threats. 

=== Automated scanning

Development of the Registy Platform performed following Secure Software Development Life Cycle (SSDLC) approach.
Automated security scanning plays a crucial role in SSDLC by helping to identify and mitigate security vulnerabilities and weaknesses in the software early in the development process. It is an essential component of the SSDLC, providing continuous security testing and feedback throughout the development lifecycle.

There are plenty of security control have been integrated in CI/CD pipeles. All of them were integrated with Vulnerability Management system in order to build security quality gates which can break the pipeline according to set criteria for particular service or condition. There is also an exception mechanism in place to bypass this behavior if the risk of a particular vulnerability has been accepted or mitigated. Such cases are explicitly approved first and all occurrence are loged together with a rationale.

All the services which are developed in-hause automatically go thorugh the list of security control every new change introduced. 

* Static application security testing
* Software composition analysis
* Detection of sensative information disclosure
* Security of helm charts used for service deployment
* Overal code quality checks
* Container security

Once all the quality gates are passed successfully the artifact is deployed on separate security environment where dymic testing happening. Dynamic Application Security Testing (DAST) is a type of security testing that involves assessing the security of an application while it is running or in a dynamic state. The primary goal of DAST is to identify security vulnerabilities and weaknesses that may not be apparent in the application's source code but could be exploited when the application is running.

There are six phases of Dynamic Application Security Testing of every change:

* Environment configuration
* Automated test data ingestion by application and data flow recording by security framework in order to automatically reveal data flow and structure.
* Authentication teting
* Vulnerability scanning of web application
* Vulnerability scanning of Rest API using updated contracts
* Results import into vulnerability management system for further analysis by security engineer

In result we utilize thorought approach for proactive finding and fixing vulnerabilities in order to enhance the security posture of the Registry Platform and protect it against potential cyber threats.

=== Penetration testing

Penetration testing performed anually by 3r party vendors on dedicated prod like environment. The report is triaged, sorted and consumed by vulnerability management system in order to mititgate any found issues.

== Vulnerability management

Vulnerability Management is a proactive approach to gather, assess, prioritize, and remediate security vulnerabilities in an organization's information systems, applications, and network infrastructure. The goal of vulnerability management is to reduce the organization's exposure to potential cyber threats and attacks by addressing weaknesses before they can be exploited by malicious actors. It is a continuous and cyclical process.

We use OWASP DefectDojo to aggregate vulnerabilities all over the platform development process. Every scan result from all development pipelines consumed by Defectdojo for deduplication, grouping, false-positive analysis and to keep up-to-date status of discovered vulnerabilities.

Vulnerability management system is deeply integreted with ticketing system which let us lead the defect throughout the entire project task managemt process and transparently accompany it through mitigation process.

Additionally it contains important and most complete history about any vulnerability discovered on the project. Using this information we can easily track down any decision made like risk acceptance, etc. 

Mentioned approach also quite useful for high-level vulnerabilities analysis to spot patterns, quick wins and improve security posture in general.

Eventually vulnerability management system is a source of truth for our security engineers.

== Reporting

We use vulnerability management system reporting capabilities to generate reports of different immersion levels to get insight about overal picture of the Registry Platform development and to adjust security program.