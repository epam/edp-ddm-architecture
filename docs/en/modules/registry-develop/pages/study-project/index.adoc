= Registry regulations development training course
include::ROOT:partial$templates/document-attributes/default-set-en.adoc[]

include::ROOT:partial$admonitions/language-en.adoc[]

//Розділ містить xref:study-project/study-tasks/overview.adoc[навчальні] та xref:study-project/control-tasks/overview.adoc[контрольні] матеріали для розвитку практичних навичок по роботі з регламентом реєстрів.
This section contains xref:study-project/study-tasks/overview.adoc[educational] and xref:study-project/control-tasks/overview.adoc[testing] materials for developing practical skills when working with registry regulations.

//Цей курс містить перелік навчальних завдань, які адміністратор регламенту виконуватиме покроково, від простого до складного.
The course consists of a set of training tasks for the regulations administrators to complete one by one, from simple to complex.

//Також для закріплення практичного матеріалу розроблено контрольні завдання.
Practical assignments are developed to reinforce the learning materials.

//== Загальні положення
== Overview

=== What are registry regulations

//[.underline]#Регламент реєстру# -- це набір сутностей, що зібрані в окремому git-каталозі за певною структурою. Кожна сутність -- це папка, що містить набір файлів (шаблони, схеми, конфігураційні файли тощо), які виконують певні задачі для роботи за певними правилами у рамках бізнес-процесів.
_Registry regulations_ are a set of entities collected in a separate Git directory according to a particular structure. Each entity is a folder with a group of files (such as templates, schemas, and configuration files) that perform specific tasks according to the rules within the business processes framework.

TIP: For details, see xref:registry-develop:registry-admin/regulations-deploy/registry-regulations-structure.adoc[].

=== How are the regulations deployed

//Розгортання регламенту реєстру автоматизовано інструментами CI/CD. За розгортання регламенту відповідає Jenkins-пайплайн публікацій `*MASTER-Build-registry-regulations*` та пов'язані пайплайни.
Registry regulations deployment is automated by the CI/CD tools. The `*MASTER-Build-registry-regulations*` Jenkins pipeline and related pipelines are responsible for deploying the regulations.

TIP: For details, see xref:arch:architecture/registry/administrative/regulation-management/registry-regulation/registry-regulation.adoc[].

[NOTE]
====
//Збірка коду (Build) стосується лише тих файлів, які були в останньому коміті (commit).
Code build applies only to the files that were in the latest commit.

For example: ::

//* У першому коміті (`git commit`) ви внесли зміни до 2-х файлів (_form.json_ для UI-форми та _process.bpmn_ для процесу) та зберегли зміни до майстер-версії Gerrit-репозиторію (`git push` + `git merge`).
* In the first commit (`git commit`), you modified two files (_form.json_ for the UI form and _process.bpmn_ for the process) and saved the changes to the master version of the Gerrit repository (`git push` + `git merge`).
//* Пайплайн публікацій регламенту не пройшов із помилкою на кроці валідації.
* The regulations publication pipeline failed the validation step.
//* У другому коміті ви вносите зміни до файлу _form.json_, виправляючи помилку. Припустимо, що з ним була проблема.
* In the second commit, you make changes to the _form.json_ file, fixing the error.
//* Пайплайн публікацій проходить, але в такому випадку ваш бізнес-процес не розгорнеться й не відобразиться у Кабінеті користувачів (хоча в Gerrit-репозиторії й лежатиме).
* This time the publication pipeline goes through, but your business process is not deployed and does not appear in the user portal, even though it is present in the Gerrit repository.

//Для розв'язання такої проблеми необхідно, щоб після невдалої збірки (проходження пайплайну) у новому коміті також були присутні усі ті файли, які ви намагалися розгорнути з попереднім комітом.
To solve this issue, ensure that the next commit after a failed build contains all the files you previously tried to deploy.

//Повертаючись до прикладу вище, вам необхідно у другому коміті додати й файл з UI-формою, яку ви підправили, й файл зі схемою бізнес-процес, який після невдалої збірки не розгорнувся.
Going back to our example, your second commit must include both the UI form file that you patched *and* the business process schema file that failed to deploy previously.

//Щоб додати файл (в якому не було помилок) в репозиторій, можете внести незначні зміни (відступ у кінці, або пробіл) -- це необхідно для того, щоб він потрапив до нового коміту.
To ensure a file that had no fixable errors gets into the new commit, make minor changes, such as an indent or a space at the end.

====

[#preconditions-setup]
== Getting started

=== Local environment setup

//Snippet
include::partial$snippets/study/local-environment-setup-en.adoc[]

=== Development tools: work environment

include::partial$snippets/study/platform-tools-en.adoc[]

////
Цей розділ презентує перелік основних сервісів та інструментів, якими доведеться, або зручно користуватися в процесі розробки та супроводу реєстрів.

. https://console-openshift-console.apps.envone.dev.registry.eua.gov.ua/[*OpenShift (Kubernetes)*] -- консоль керування Платформою. Призначення:

+
* Перегляд технічних логів.
* Управління подами (програмами, частинами мікросервісної архітектури реєстру).
* Перегляд посилань, що доступні в рамках реєстру (список посилань до вебпорталів, Gerrit, Jenkins тощо).
* Перегляд секретів (username:password) для доступу до різних систем.

. https://kibana-openshift-logging.apps.envone.dev.registry.eua.gov.ua/app/kibana[*Kibana*] -- сервіс перегляду технічних логів.
+
Найбільш поширені випадки використання Kibana:

* Пошук причин помилки за `traceId`.
* Пошук причетних логів за id конкретного бізнес-процесу (за аналогію до `traceId`).

+
[TIP]
====
Документація: ::
xref:registry-develop:bp-modeling/bp/kibana.adoc[].
====

. https://gerrit-control-plane-platform-main.apps.envone.dev.registry.eua.gov.ua/[*Gerrit*] -- система рецензування коду, сховище коду регламенту реєстру.
+
[TIP]
====
Документація: ::
xref:registry-develop:registry-admin/regulations-deploy/registry-admin-deploy-regulation.adoc[].
====

. https://jenkins-control-plane-platform-main.apps.envone.dev.registry.eua.gov.ua/[*Jenkins*] -- сервіс для автоматизованої збірки коду та розгортання компонентів регламенту. Призначення:

* Перегляд та управління процесом збірки коду.
* Перегляд логів, пов'язаних зі збіркою та розгортанням.

+
[TIP]
====
Документація: ::

* xref:platform-develop:registry-regulations-deployment.adoc[]
* xref:registry-develop:registry-admin/regulations-deploy/registry-regulations-auto-validation.adoc[]
====

. *Camunda Cockpit* -- сервіс для адміністрування екземплярів бізнес-процесів.
+
Призначення:

* Адміністрування бізнес-процесів
* Моніторинг бізнес-процесів
* Перевірка розгортання бізнес-процесів

+
[TIP]
====
Посилання до сервісу: :: https://business-proc-admin-<registry-name>.apps.envone.dev.registry.eua.gov.ua/

Документація: ::
xref:registry-develop:registry-admin/registry-admin-bp-management-cockpit.adoc[].
====

. https://platform-keycloak.apps.envone.dev.registry.eua.gov.ua/[*Keycloak*] -- сервіс управління ідентифікацією користувачів та надання їм прав доступу.

+
[TIP]
====
Документація: ::

* xref:registry-develop:registry-admin/create-users/manual-user-creation.adoc[]
* xref:admin:user-management-auth/keycloak-create-users.adoc[]
====

. *Swagger* -- інструмент для перегляду згенерованих API-точок доступу реєстру.

+
[TIP]
====
Посилання до сервісу: :: https://registry-rest-api-<registry-name>.apps.envone.dev.registry.eua.gov.ua/openapi.

Обов'язково додавайте [.underline]`*/openapi*` в кінець посилання, інакше ви потрапите до тестового середовища (пісочниці) Swagger.
====

. *pgAdmin* -- інструмент для роботи із базою даних реєстру, перегляд таблиць та представлень (Search Conditions).
+
[TIP]
====
Посилання до сервісу: :: https://pgadmin-<registry-name>.apps.envone.dev.registry.eua.gov.ua/.
====

. *Redash* -- інструмент для роботи з аналітичною звітністю. Створення та перегляд аналітичної звітності, створення запитів (Queries) та дашбордів (Dashboards), публікація та експорт звітності.
+
Є 2 екземпляри (сервіси) Redash: ::

* `*redash-admin*` -- необхідний для моделювання запитів та звітів зі сторони розробників/адміністраторів реєстру.
+
[TIP]
====
Посилання до сервісу: ::
https://redash-admin-<registry-name>.apps.envone.dev.registry.eua.gov.ua/

Документація: ::

* xref:registry-develop:study-project/study-tasks/task-6-registry-reports-modeling.adoc[] (Детальний опис створення та публікації аналітичної звітності)

* xref:registry-develop:data-modeling/reports/data-analytical-reports-creation.adoc[]
* xref:registry-develop:data-modeling/reports/data-analytical-data-access-rights.adoc[]
====

* `*redash-viewer*` -- необхідний для перегляду сформованих звітів зі сторони користувачів кабінету посадової особи (авторизація за допомогою КЕП ключа).
+
[TIP]
====
Посилання до сервісу: https://redash-viewer-<registry-name>.apps.envone.dev.registry.eua.gov.ua/
====
////

== Registry regulations modeling roadmap

//Дорожня карта з моделювання регламенту (Roadmap) показує верхньорівневі етапи по роботі з основними сутностями регламенту та надає загальний контекст командам розробки та супроводу реєстрів.
The regulations modeling roadmap shows high-level stages of working with the main elements of the regulations and provides a general context for the registry development and maintenance teams.

[NOTE]
====
//На діаграмі представлено лише основні елементи регламенту.
The diagram shows only the main elements of the regulations.

//Платформа наразі дозволяє гнучко налаштовувати широкий спектр функціональності в рамках роботи з регламентом. Наприклад, _моделювання витягів різних форматів_, _налаштування відправлення повідомлень різними каналами зв'язку_, _управління налаштування реєстру_ тощо.
The Platform provides flexible customization options for a wide range of features related to working with the regulations—for example, modeling excerpts in different formats, configuring notifications through various communication channels, managing registry settings, and so on.
====

image:study-project/registry-regulations-roadmap.png[]

== Study tasks

//У цьому розділі представлені етапи, які знайомлять безпосередньо із практичними завданнями курсу та проводять короткий екскурс до основних задач, над якими працюватиме розробник регламенту.
This section goes over the training stages and introduces the practical tasks that the registry regulations developer is required to perform.

//=== Створити модель даних реєстру
=== Create the registry data model

//В рамках цього завдання моделювальники мають: ::
As part of this task, the modeler needs to: ::

//. Створити логічну модель даних, створити ERD-діаграму.
. Create a logical data model and an ERD diagram.
//. Створити фізичну модель даних відповідно до логічної моделі:
. Create a physical data model based on the logical model:
+
//* Створити план розробки фізичної моделі:
* Create a physical model development plan:
//** Визначити первинні ключі для кожної із сутностей.
** Define primary keys for each of the entities.
//** Визначити вторинні ключі, якщо вони є в сутності.
** Define secondary keys if the entity has them.
//** Визначити обов'язкові поля.
** Identify mandatory fields.
//** Визначити поля або комбінацію полів, що мають унікальні значення.
** Identify fields or a combination of fields that have unique values.
//** Визначити назву таблиць та полів латиницею.
** Define the names of tables and fields in Latin characters.
+
//* Створити таблиці та зв'язки між ними.
* Create tables and relationships between them.
//* Створити критерії пошуку (таблиці-представлення, `VIEW`).
* Create search conditions (view tables).
//* Виконати первинне наповнення даними таблиць-довідників.
//TODO: Таблиці-довідники - це reference tables?
* Perform initial data load for reference tables.
//. Застосувати розроблену модель у регламенті.
. Apply the developed model via the regulations.

TIP: For details, see xref:study-project/study-tasks/task-1-registry-db-modeling.adoc[].

//=== Змоделювати простий бізнес-процес без інтеграцій
=== Model a simple business process without integration

As part of this task, the modeler needs to: ::

//. Змоделювати простий бізнес-процес без інтеграцій із фабрикою даних або іншими реєстрами.
. Model a simple business process without integration with the data factory or other registries.
//. Створити UI-форми введення даних до бізнес-процесу.
. Create data entry UI forms for the business process.
//. Визначити ролі та надати права доступу до бізнес-процесу.
. Define the roles and grant access to the business process.
//. Застосувати зміни у регламенті.
. Apply changes to the regulations.

TIP: For details, see xref:study-project/study-tasks/task-2-bp-modeling-without-integration.adoc[].

//=== Змоделювати бізнес-процес з інтеграцією
=== Model a business process with integration

As part of this task, the modeler needs to: ::

//. Змоделювати бізнес-процес, що має інтеграцію з фабрикою даних.
. Model a business process integrated with the data factory.
//* Змоделювати гілки у бізнес-процесі.
* Model business process branches.
//* Змоделювати уніфіковані кроки у бізнес-процесах за допомогою `Call Activity`.
* Model unified steps in the business processes using `Call Activity`.
//. Змоделювати  UI-форми введення даних до бізнес-процесу та налаштувати компоненти `Select` для отримання даних із фабрики даних.
. Model the UI forms for entering data into the business process and configure the `Select` components to retrieve data from the data factory.
//. Визначити ролі та надати права доступу до бізнес-процесу.
. Define the roles and grant access to the business process.
//. Застосувати зміни у регламенті.
. Apply changes to the regulations.

TIP: For details, see xref:study-project/study-tasks/task-3-bp-modeling-with-integration.adoc[].

//=== Змоделювати бізнес-процес зі стартовою формою та залежними компонентами на формах
=== Model a business process with a start form and dependent components on forms

As part of this task, the modeler needs to: ::

//. Змоделювати бізнес-процес, який має стартову форму.
. Model a business process that has a start form.
//. Змоделювати UI-форми введення даних із залежними компонентами та компонентом *Edit Grid*.
. Model data entry UI forms with dependent components and an *Edit Grid* component.
//. Визначити ролі та надати права доступу до бізнес-процесу.
. Define the roles and grant access to the business process.
//. Застосувати зміни у регламенті.
. Apply changes to the regulations.

TIP: For details, see xref:study-project/study-tasks/task-4-bp-modeling-with-start-form-and-depending-components.adoc[].

//=== Змоделювати бізнес-процес із декількома учасниками
=== Model a business process with multiple participants

As part of this task, the modeler needs to: ::

//. Змоделювати бізнес-процес, що має декількох учасників.
. Model a business process that has multiple participants.
//. Змоделювати UI-форми введення даних та налаштувати їх за допомогою *formVariables*.
. Model data entry UI forms and configure them using *formVariables*.
. Define the roles and grant access to the business process.
. Apply changes to the regulations.

TIP: For details, see xref:study-project/study-tasks/task-5-bp-modeling-multiple-participants.adoc[].

//=== Розробити аналітичну звітність
=== Prepare analytical reports

As part of this task, the modeler needs to: ::

//. Змоделювати аналітичне представлення.
. Model an analytics view.
//. Надати доступ до аналітичного представлення.
. Provide access to the analytics view.
//. Створити 3 запити (Query) в Redash.
. Create three queries in Redash.
//. Створити дашборд в Redash.
. Create a dashboard in Redash.
//. Вивантажити архів із дашбордом та розпакувати його в регламенті.
. Download the archive with the dashboard and unpack it in the regulations.
//. Перенести зміни до віддаленого Gerrit-репозиторію.
. Apply the changes to the remote Gerrit repository.
//. Перевірити сформований звіт у Кабінеті посадової особи.
. Verify the report in the officer's portal.

TIP: For details, see xref:study-project/study-tasks/task-6-registry-reports-modeling.adoc[].

=== Model a business process with a call to Secure exchange gateway
//TODO: Maybe delete this point: UA specific or substitute with the REST connector

As part of this task, the modeler needs to: ::

//. Змоделювати 1 бізнес-процес.
. Model one business process.
//. Змоделювати 3 форми внесення даних до бізнес-процесу.
. Model 3 data entry UI forms for the business process.
//. Надати доступи до бізнес-процесу для відповідних ролей.
. Grant access to the business process for corresponding roles.
//. Зберегти створені артефакти до локального git-репозиторію.
. Save the created artifacts to the local Git repository.
//. Перенести локальні зміни до віддаленого Gerrit-репозиторію.
. Apply local changes to the remote Gerrit repository.
//. Перевірити працездатність бізнес-процесу.
. Check the functionality of the business process.

TIP: For details, see xref:study-project/study-tasks/task-7-bp-modeling-trembita-invocation.adoc[].

//== Контрольні завдання
== Tests

//Розділ охоплює контрольні завдання для самоперевірки після завершення навчальної частини. Наразі розроблені такі завдання, від простого до складного:
This section covers the self-assessment tests you can take after completing the learning part of the training. Tests go from simple to complex.

//* xref:registry-develop:study-project/control-tasks/control-task-registry-update.adoc[] -- має на меті отримати поглиблені практичні знання зі створення бізнес-процесів на Платформі.
* xref:registry-develop:study-project/control-tasks/control-task-1.adoc[]: Gain in-depth practical knowledge of creating business processes on the Platform.
//* xref:registry-develop:study-project/control-tasks/control-task-2.adoc[] -- подальше поглиблення практичних навичок зі створення бізнес-процесів.
* xref:registry-develop:study-project/control-tasks/control-task-2.adoc[]: Deepen your practical skills in developing business processes.
//* xref:registry-develop:study-project/control-tasks/control-task-backup-restore.adoc[] -- подальше поглиблення практичних навичок зі створення бізнес-процесів, ознайомлення із вкладеними сутностями.
* xref:registry-develop:study-project/control-tasks/control-task-3.adoc[]: Deepen your business process creation skills even further by mastering nested entities.