= Emulating external integrations
include::platform:ROOT:partial$templates/document-attributes/default-set-en.adoc[]

include::platform:ROOT:partial$admonitions/language-en.adoc[]

== General overview

//–í–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –µ–º—É–ª—è—Ç–æ—Ä–∏ (–º–æ–∫–∏) –¥–ª—è —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π —ñ–∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ —á–µ—Ä–µ–∑ SOAP –∞–±–æ REST –≤ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω—ñ–π –ø–∞–Ω–µ–ª—ñ Control Plane –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é https://wiremock.org/[WireMock].
You can configure mock integrations with external systems via SOAP or REST in the Control Plane administrative panel https://wiremock.org/[WireMock].

image:release-notes:wn-1-9-5/whats-new-1-9-5-2.png[]

Key features: ::

//* [*] üîÑ –ü—ñ–¥—Ç—Ä–∏–º–∫–∞ *SOAP* —Ç–∞ *REST*: –µ–º—É–ª—è—Ü—ñ—ó –º–æ–∂—É—Ç—å –±—É—Ç–∏ —Å—Ç–≤–æ—Ä–µ–Ω—ñ –¥–ª—è –æ–±–æ—Ö –ø—Ä–æ—Ç–æ–∫–æ–ª—ñ–≤ -- SOAP —ñ REST, —â–æ –¥–∞—î –±—ñ–ª—å—à—É –≥–Ω—É—á–∫—ñ—Å—Ç—å –ø—Ä–∏ —Ä–æ–±–æ—Ç—ñ –∑ —Ä—ñ–∑–Ω–∏–º–∏ –∑–æ–≤–Ω—ñ—à–Ω—ñ–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏.
* [*] üîÑ Support of *SOAP* and *REST*:Mock integrations can be created for both protocols -- SOAP and REST, which provides greater flexibility when working with different external systems.

//* [*] üîß –ö–µ—Ä—É–≤–∞–Ω–Ω—è —á–µ—Ä–µ–∑ *Control Plane*: –∞–∫—Ç–∏–≤–∞—Ü—ñ—è —Ç–∞ –∫–µ—Ä—É–≤–∞–Ω–Ω—è –º–æ–∫–∞–º–∏ –∑–¥—ñ–π—Å–Ω—é—î—Ç—å—Å—è —á–µ—Ä–µ–∑ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω—É –ø–∞–Ω–µ–ª—å Control Plane –≤ —Ä–∞–º–∫–∞—Ö *`-dev`*-—à–∞–±–ª–æ–Ω—ñ–≤ —Ä–µ—î—Å—Ç—Ä—É.
* [*] üîß Management via  *Control Plane*: –∞Activation and management of mocks is done through the Control Plane administrative panel within the *_dev_* registry templates.

//* [*] üõ†Ô∏è *WireMock* -- –ø–æ—Ç—É–∂–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è: WireMock —î —Å–∏–º—É–ª—è—Ç–æ—Ä–æ–º HTTP-—Å–µ—Ä–≤–µ—Ä—ñ–≤, —è–∫–∏–π –¥–æ–∑–≤–æ–ª—è—î —Å—Ç–≤–æ—Ä—é–≤–∞—Ç–∏ –º–æ–∫–∏ HTTP-–≤–∑–∞—î–º–æ–¥—ñ–π. –¶–µ –∑—Ä—É—á–Ω–∏–π —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —ñ–º—ñ—Ç–∞—Ü—ñ—ó —Ä–æ–±–æ—Ç–∏ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö API —Ç–∞ —Å–µ—Ä–≤—ñ—Å—ñ–≤.

* [*] üõ†Ô∏è *WireMock* -- powerful testing tool: WireMock is an HTTP server simulator that allows creating mock HTTP interactions. This is a convenient tool for simulating the work of external APIs and services.

//* [*] üìÅ –ö–∞—Å—Ç–æ–º—ñ–∑–∞—Ü—ñ—è –º–æ–∫—ñ–≤ —á–µ—Ä–µ–∑ *_mock-integrations_*: –≤–∏ –º–æ–∂–µ—Ç–µ –∑–∞–¥–∞—Ç–∏ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –º–æ–∫—ñ–≤ –Ω–∞ —Ä—ñ–≤–Ω—ñ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—É —Ä–µ—î—Å—Ç—Ä—É, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—á–∏ –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—é _mock-integrations_.
* [*] üìÅ Customization of mocks via *_mock-integrations_*: You can define the structure of mock integrations at the registry policy level using the mock-integrations directory _mock-integrations_.

Use cases: ::

//* [*] üß™ –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è: —Å—Ç–≤–æ—Ä—é–π—Ç–µ –º–æ–¥—É–ª—å–Ω—ñ (unit) —Ç–∞ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω—ñ —Ç–µ—Å—Ç–∏ –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è–º WireMock –¥–ª—è –µ–º—É–ª—è—Ü—ñ—ó –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö API –π —Å–µ—Ä–≤—ñ—Å—ñ–≤.
* [*] üß™ Testing: Create unit and integration tests using WireMock to emulate external APIs and services.

//* [*] üíª –†–æ–∑—Ä–æ–±–∫–∞: —è–∫—â–æ —Ä–µ–∞–ª—å–Ω–∏–π —Å–µ—Ä–≤—ñ—Å —â–µ –Ω–µ –≥–æ—Ç–æ–≤–∏–π –∞–±–æ —Ç–∏–º—á–∞—Å–æ–≤–æ –Ω–µ–¥–æ—Å—Ç—É–ø–Ω–∏–π, WireMock –¥–æ–ø–æ–º–æ–∂–µ —ñ–º—ñ—Ç—É–≤–∞—Ç–∏ –π–æ–≥–æ –ø–æ–≤–µ–¥—ñ–Ω–∫—É, —â–æ –¥–æ–∑–≤–æ–ª–∏—Ç—å –ø—Ä–æ–¥–æ–≤–∂—É–≤–∞—Ç–∏ —Ä–æ–∑—Ä–æ–±–∫—É –±–µ–∑ –ø–µ—Ä–µ—Ä–≤.
* [*] üíª Development: If a real service is not yet ready or temporarily unavailable, WireMock will help simulate its behavior, allowing development to continue uninterrupted.

//* [*] üîç –í—ñ–¥—Ç–≤–æ—Ä–µ–Ω–Ω—è –ø–æ–º–∏–ª–æ–∫: –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ WireMock –¥–ª—è –º–æ–¥–µ–ª—é–≤–∞–Ω–Ω—è —Ä—ñ–∑–Ω–∏—Ö —Å—Ç–∞–Ω—ñ–≤ —Ç–∞ –ø–æ–º–∏–ª–æ–∫ HTTP-—Å–µ—Ä–≤—ñ—Å—ñ–≤, —â–æ –¥–æ–ø–æ–º–æ–∂–µ –≤ –≥–ª–∏–±—à–æ–º—É —Ä–æ–∑—É–º—ñ–Ω–Ω—ñ —Ç–∞ —Ä–æ–∑–≤'—è–∑–∞–Ω–Ω—ñ –ø—Ä–æ–±–ª–µ–º.
* [*] üîç Replicating errors: Use WireMock to model different states and HTTP service errors to gain deeper understanding and help resolve issues.

//–§—É–Ω–∫—Ü—ñ–æ–Ω–∞–ª—å–Ω—ñ—Å—Ç—å –ø—Ä–∏–∑–Ω–∞—á–µ–Ω–∞ –¥–ª—è –ø–æ–ª—ñ–ø—à–µ–Ω–Ω—è —è–∫–æ—Å—Ç—ñ —Ä–æ–∑—Ä–æ–±–∫–∏ —Ç–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è, –Ω–∞–¥–∞—é—á–∏ –±—ñ–ª—å—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—é —Ç–∞ –≥–Ω—É—á–∫–æ—Å—Ç—ñ –ø—Ä–∏ —Ä–æ–±–æ—Ç—ñ –∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏.
This functionality is intended to improve development and testing quality, providing more control and flexibility when working with external systems.

//== –ü–ª–∞–Ω –¥—ñ–π –∑ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –µ–º—É–ª—è—Ç–æ—Ä—ñ–≤ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π
== Action plan for using external integration emulators
////
[%interactive]
* [ ] xref:admin:registry-management/control-plane-create-registry.adoc[–†–æ–∑–≥–æ—Ä–Ω—ñ—Ç—å —Ä–µ—î—Å—Ç—Ä] —ñ–∑ —à–∞–±–ª–æ–Ω—É –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏ *`-dev*`. –ü–ª–∞—Ç—Ñ–æ—Ä–º–∞ –Ω–∞–¥–∞—î –¥–µ–∫—ñ–ª—å–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–∏—Ö —à–∞–±–ª–æ–Ω—ñ–≤. –û–±–µ—Ä—ñ—Ç—å, –Ω–∞–ø—Ä–∏–∫–ª–∞–¥, *`-dev-recommended*`.
* [ ] xref:#activate-wiremock[–ê–∫—Ç–∏–≤—É–π—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –µ–º—É–ª—è—Ç–æ—Ä—ñ–≤] –ø—Ä–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—ñ –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ —ñ–Ω—à–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ —É *Control Plane*.
* [ ] xref:registry-admin/external-integration/ext-integration-overview.adoc[–ù–∞–ª–∞—à—Ç—É–π—Ç–µ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω—É –≤–∑–∞—î–º–æ–¥—ñ—é —É Control Plane].
* [ ] xref:#wiremock-templates[–ù–∞–ª–∞—à—Ç—É–π—Ç–µ —à–∞–±–ª–æ–Ω–∏ –µ–º—É–ª—è—Ç–æ—Ä—ñ–≤ —É —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—ñ –≤–∞—à–æ–≥–æ —Ä–µ—î—Å—Ç—Ä—É].
* [ ] xref:#create-wiremock-route[–°—Ç–≤–æ—Ä—ñ—Ç—å —Ä–æ—É—Ç –¥–ª—è —Å–µ—Ä–≤—ñ—Å—É WireMock —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è —Ä–æ–±–æ—Ç–∏ —ñ–∑ –∫–æ–ª–µ–∫—Ü—ñ—î—é –º–æ–∫—ñ–≤].
* [ ] xref:#wiremock-testing-postman[–ù–∞–ª–∞—à—Ç—É–π—Ç–µ –≤–∑–∞—î–º–æ–¥—ñ—é –∑ API WireMock —á–µ—Ä–µ–∑ Postman].
* [ ] xref:#bp-soap-rest-connectors[–ó–º–æ–¥–µ–ª—é–π—Ç–µ –≤–∑–∞—î–º–æ–¥—ñ—é —ñ–∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏ —É –±—ñ–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å–∞—Ö —á–µ—Ä–µ–∑ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω—ñ –∫–æ–Ω–µ–∫—Ç–æ—Ä–∏].
////

[%interactive]
* [ ] xref:admin:registry-management/control-plane-create-registry.adoc[Deploy registry] from a development template *`-dev*`. The platform provides several available templates. Choose, for example, *`-dev-recommended*`.
* [ ] xref:#activate-wiremock[Activate the emulators using] when configuring integration with other systems in *Control Plane*.
* [ ] xref:registry-admin/external-integration/ext-integration-overview.adoc[Configure integration interaction in Control Plane].
* [ ] xref:#wiremock-templates[Configure emulator templates in the policy of your registry].
* [ ] xref:#create-wiremock-route[Create a route for the WireMock service and use the interface to work with the collection of mock integrations].
* [ ] xref:#wiremock-testing-postman[Configure interaction with the WireMock API via Postman].
* [ ] xref:#bp-soap-rest-connectors[Model interaction with external systems in business processes through integration connectors].


[#activate-wiremock]
//== –ê–∫—Ç–∏–≤–∞—Ü—ñ—è –µ–º—É–ª—è—Ç–æ—Ä—ñ–≤ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π
== Activation of emulators for external integrations

//–í–∏ –º–æ–∂–µ—Ç–µ —É–≤—ñ–º–∫–Ω—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –µ–º—É–ª—è—Ç–æ—Ä—ñ–≤ –ø—Ä–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—ñ –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π –≤ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–∏–≤–Ω–æ—ó –ø–∞–Ω–µ–ª—ñ Control Plane, –∑–æ–∫—Ä–µ–º–∞ –ø—ñ–¥ —á–∞—Å:
You can enable the use of emulators when configuring external integrations in the Control Plane administrative panel interface, specifically during:

* Configuring interaction with registries via secure exchange gateway "Trembita" within SOAP protocol

include::platform:ROOT:partial$admonitions/ua-specific.adoc[]

* xref:registry-admin/external-integration/cp-integrate-ext-system.adoc[Configuring interaction with other systems]

//–ê–∫—Ç–∏–≤—É–π—Ç–µ –ø–µ—Ä–µ–º–∏–∫–∞—á +++<b style="font-weight: 600">–í–∏–∫–æ—Ä–∏—Å—Ç–∞—Ç–∏ –º–æ–∫ –∑–æ–≤–Ω—ñ—à–Ω—å–æ—ó —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ—ó<b>+++ –¥–ª—è –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ–≥–æ —Ç–∏–ø—É –≤–∑–∞—î–º–æ–¥—ñ—ó.
Activate the toggle switch +++<b style="font-weight: 600">Use an external integration mock<b>+++ for the corresponding type of interaction.

//.–£–≤—ñ–º–∫–Ω–µ–Ω–Ω—è –µ–º—É–ª—è—Ç–æ—Ä—ñ–≤ –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ —Ä–µ—î—Å—Ç—Ä–∞–º–∏ —á–µ—Ä–µ–∑ –®–ë–û "–¢—Ä–µ–º–±—ñ—Ç–∞"
.Enabling emulators for interaction with registries via secure exchange gateway "Trembita" within SOAP protocol

image::release-notes:wn-1-9-5/whats-new-1-9-5-2.png[]

//.–£–≤—ñ–º–∫–Ω–µ–Ω–Ω—è –µ–º—É–ª—è—Ç–æ—Ä—ñ–≤ –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ —ñ–Ω—à–∏–º–∏ —Å–∏—Å—Ç–µ–º–∞–º–∏
.Enabling emulators for interaction with other systems
image::registry-admin/external-integration/mock-integrations/mock-integrations-1.png[]

[#wiremock-templates]
//== –í–∏–∑–Ω–∞—á–µ–Ω–Ω—è —à–∞–±–ª–æ–Ω—ñ–≤ –µ–º—É–ª—è—Ç–æ—Ä—ñ–≤ —É —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—ñ
== Defining templates of emulators in the policy

//–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —à–∞–±–ª–æ–Ω—ñ–≤ –µ–º—É–ª—è—Ü—ñ–π –∑–æ–≤–Ω—ñ—à–Ω—ñ—Ö —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π –≤–∏–∑–Ω–∞—á–∞—î—Ç—å—Å—è –Ω–∞ —Ä—ñ–≤–Ω—ñ Gerrit-—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä—ñ—é —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—É –≤–∞—à–æ–≥–æ —Ä–µ—î—Å—Ç—Ä—É, —É –¥–∏—Ä–µ–∫—Ç–æ—Ä—ñ—ó *_mock-integrations_*. –®–∞–±–ª–æ–Ω–∏ –º–∞—é—Ç—å –±—É—Ç–∏ –≤–∏–∑–Ω–∞—á–µ–Ω–∏–º–∏ –∑–≥—ñ–¥–Ω–æ –∑ –∫–æ–Ω–≤–µ–Ω—Ü—ñ—è–º–∏ https://wiremock.org/[WireMock] —É —Ñ–æ—Ä–º–∞—Ç—ñ *JSON*.

Configuration of external integration emulator templates is defined at the Gerrit repository policy level of your registry, in the *_mock-integrations_* directory. The templates should follow the conventions outlined by https://wiremock.org/[WireMock] in *JSON* format.

//.–§–∞–π–ª–∏ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —à–∞–±–ª–æ–Ω—ñ–≤ –º–æ–∫—ñ–≤ —É —Å—Ç—Ä—É–∫—Ç—É—Ä—ñ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—É —Ä–µ—î—Å—Ç—Ä—É
.Configuration files for the mock templates are located within the policy structure of the registry
[plantuml, create-tables-regulation-structure, svg]
----
@startsalt
{
{T
+ <&folder> registry-regulations
++ <&folder> bpmn
++ <&folder> <b>data-model</b>
++ <&folder> <b>mock-integrations</b>
+++ <&file> <b>external-service-1.json</b>
+++ <&file> <b>external-service-2.json</b>
+++ ...
++ ...
}
}
@endsalt
----

=== REST

//–®–∞–±–ª–æ–Ω–∏ —É WireMock –º–æ–∂–Ω–∞ —Ä–æ–∑–¥—ñ–ª–∏—Ç–∏ –Ω–∞ –¥–≤—ñ –æ—Å–Ω–æ–≤–Ω—ñ —á–∞—Å—Ç–∏–Ω–∏:
WireMock templates can be divided into two main parts

//. *Request Matching* -- –≤–∏–∑–Ω–∞—á–∞—î, —è–∫—ñ HTTP-–∑–∞–ø–∏—Ç–∏ –ø–æ–≤–∏–Ω–Ω—ñ –±—É—Ç–∏ –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω—ñ. –í–∏ –º–æ–∂–µ—Ç–µ –≤–∫–∞–∑–∞—Ç–∏ URL, –º–µ—Ç–æ–¥ (`GET`, `POST` —Ç–æ—â–æ), –∑–∞–≥–æ–ª–æ–≤–∫–∏, —Ç—ñ–ª–æ –∑–∞–ø–∏—Ç–∞ —Ç–æ—â–æ.
. *Request Matching* -- defines which HTTP requests should be intercepted. You can specify the URL, method (`GET`, `POST` etc.), headers, request body, and more.

//. *Response Definition* -- –≤–∏–∑–Ω–∞—á–∞—î, —è–∫ –ø–æ–≤–∏–Ω–Ω–∞ –≤–∏–≥–ª—è–¥–∞—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å, —è–∫–∞ –ø–æ–≤–µ—Ä—Ç–∞—î—Ç—å—Å—è –Ω–∞ —Å–ø—ñ–≤—Å—Ç–∞–≤–ª–µ–Ω–∏–π –∑–∞–ø–∏—Ç. –¢—É—Ç –º–æ–∂–Ω–∞ –≤–∫–∞–∑–∞—Ç–∏ —Å—Ç–∞—Ç—É—Å –∫–æ–¥, –∑–∞–≥–æ–ª–æ–≤–∫–∏, —Ç—ñ–ª–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —Ç–æ—â–æ.
. *Response Definition* -- defines how the response that is returned for a matched request should look like. You can specify the status code, headers, response body, and more.

//.–ü—Ä–∏–∫–ª–∞–¥ —à–∞–±–ª–æ–Ω—É WireMock —É —Ñ–æ—Ä–º–∞—Ç—ñ JSON:
.Example of a WireMock template in JSON format:
[source,json]
----
{
  "request": {
    "method": "GET",
    "urlPathPattern": "/some/endpoint"
  },
  "response": {
    "status": 200,
    "headers": {
      "Content-Type": "application/json"
    },
    "jsonBody": {"key": "value"}
  }
}
----

//–¶–µ–π —à–∞–±–ª–æ–Ω –≤–∫–∞–∑—É—î –Ω–∞ —Ç–µ, —â–æ –∫–æ–ª–∏ WireMock –æ—Ç—Ä–∏–º—É—î GET –∑–∞–ø–∏—Ç –Ω–∞ URL `/some/endpoint`, –≤—ñ–Ω –ø–æ–≤–∏–Ω–µ–Ω –ø–æ–≤–µ—Ä–Ω—É—Ç–∏ –≤—ñ–¥–ø–æ–≤—ñ–¥—å –∑—ñ —Å—Ç–∞—Ç—É—Å-–∫–æ–¥–æ–º `200`, –∑–∞–≥–æ–ª–æ–≤–∫–æ–º `Content-Type` –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–º —è–∫ `application/json`, —Ç–∞ —Ç—ñ–ª–æ–º –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ —É —Ñ–æ—Ä–º–∞—Ç—ñ `{"key":"value"}`.
This template specifies that when WireMock receives a GET request to the URL `/some/endpoint`, it should return a response with a `200`status code, a header of `Content-Type` set to `application/json`, and a response body in the format `{"key":"value"}`.

=== SOAP

//WireMock —Ç–∞–∫–æ–∂ –º–æ–∂–µ –±—É—Ç–∏ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–∏–π –¥–ª—è –º–æ–∫—É–≤–∞–Ω–Ω—è SOAP –≤–µ–±—Å–µ—Ä–≤—ñ—Å—ñ–≤. SOAP (Simple Object Access Protocol) —î –ø—Ä–æ—Ç–æ–∫–æ–ª–æ–º –¥–ª—è –æ–±–º—ñ–Ω—É –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º–∏ –º—ñ–∂ –∑–∞—Å—Ç–æ—Å—É–Ω–∫–∞–º–∏ —á–µ—Ä–µ–∑ HTTP, —ñ, –Ω–∞ –≤—ñ–¥–º—ñ–Ω—É –≤—ñ–¥ REST, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î —Ñ–æ—Ä–º–∞—Ç *XML* –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏–∑–∞—Ü—ñ—ó –¥–∞–Ω–∏—Ö.
WireMock can also be used to mock SOAP web services. SOAP (Simple Object Access Protocol) is a protocol for exchanging messages between applications over HTTP and, unlike REST, uses the *XML* format to structure data.

//–ö–æ–ª–∏ –≤–∏ –º–æ–∫—É—î—Ç–µ SOAP-—Å–µ—Ä–≤—ñ—Å –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é WireMock, –≤–∏ –∑–∞–∑–≤–∏—á–∞–π —Ö–æ—á–µ—Ç–µ —Å—Ç–≤–æ—Ä–∏—Ç–∏ –º–æ–∫–∏ –¥–ª—è SOAP –∑–∞–ø–∏—Ç—ñ–≤ —ñ –≤—ñ–¥–ø–æ–≤—ñ–¥–µ–π, —è–∫—ñ –≤–æ–Ω–∏ –æ—Ç—Ä–∏–º—É—é—Ç—å. –û—Å—å –ø—Ä–∏–∫–ª–∞–¥ —Ç–æ–≥–æ, —è–∫ –º–æ–∂–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ –∫–æ–Ω—Ñ—ñ–≥—É—Ä–∞—Ü—ñ–π–Ω–∏–π —Ñ–∞–π–ª WireMock –¥–ª—è –º–æ–∫—É–≤–∞–Ω–Ω—è SOAP-–≤–µ–±—Å–µ—Ä–≤—ñ—Å—É:
When mocking a SOAP service using WireMock, you would typically want to create mocks for the SOAP requests and responses they receive. Here is an example of what a WireMock configuration file could look like for mocking a SOAP web service:

//.–®–∞–±–ª–æ–Ω –º–æ–∫—É–≤–∞–Ω–Ω—è SOAP-–≤–µ–±—Å–µ—Ä–≤—ñ—Å—É
.SOAP web service mocking template
[source,json]
----
{
  "request": {
    "method": "POST",
    "url": "/soap-endpoint",
    "headers": {
      "Content-Type": "text/xml; charset=utf-8"
    },
    "bodyPatterns": [
      {
        "matchesXPath": "//your-xpath-expression"
      }
    ]
  },
  "response": {
    "status": 200,
    "headers": {
      "Content-Type": "text/xml; charset=utf-8"
    },
    "body": "<your-soap-response-xml>"
  }
}
----

//–£ —Ü—å–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ WireMock –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–∏–π —Ç–∞–∫, —â–æ –∫–æ–ª–∏ –≤—ñ–Ω –æ—Ç—Ä–∏–º—É—î POST-–∑–∞–ø–∏—Ç –Ω–∞ URL `/soap-endpoint` –∑ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–º–∏ –∑–∞–≥–æ–ª–æ–≤–∫–∞–º–∏ —Ç–∞ —Ç—ñ–ª–æ–º, —è–∫–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î –∑–∞–¥–∞–Ω–æ–º—É `XPath`-–≤–∏—Ä–∞–∑—É, –≤—ñ–Ω –ø–æ–≤–µ—Ä—Ç–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥—å –∑—ñ —Å—Ç–∞—Ç—É—Å-–∫–æ–¥–æ–º `200` —Ç–∞ XML-–≤–º—ñ—Å—Ç–æ–º —è–∫ —Ç—ñ–ª–æ –≤—ñ–¥–ø–æ–≤—ñ–¥—ñ.
In this example, WireMock is configured such that when it receives a POST request to the URL `/soap-endpoint` with the appropriate headers and a body that matches the given `XPath` expression, it will return a response with a `200` status code and an XML payload as the response body.

//–í–∞–∂–ª–∏–≤–æ –ø—ñ–¥–≥–æ—Ç—É–≤–∞—Ç–∏ –ø—Ä–∞–≤–∏–ª—å–Ω–∏–π XML-–≤–º—ñ—Å—Ç –¥–ª—è —Ç—ñ–ª–∞ SOAP-–≤—ñ–¥–ø–æ–≤—ñ–¥—ñ –π, –∑–∞ –ø–æ—Ç—Ä–µ–±–∏, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ `XPath` –¥–ª—è –∑—ñ—Å—Ç–∞–≤–ª–µ–Ω–Ω—è –µ–ª–µ–º–µ–Ω—Ç—ñ–≤ —É —Ç—ñ–ª—ñ SOAP-–∑–∞–ø–∏—Ç–∞.
It is important to prepare the correct XML payload for the SOAP response body and, if necessary, use `XPath` to match elements within the SOAP request payload.

[%collapsible]
.Imitation of SOAP service behavior for requests to SearchSubjects endpoint.
====

include::platform:ROOT:partial$admonitions/ua-specific.adoc[]

[source,json]
----
{
  "mappings": [
    {
      "priority": 100,
      "request": {
        "method": "POST",
        "bodyPatterns": [
          {
            "matchesXPath": "//*[local-name()='serviceCode'][text()='SearchSubjects']"
          }
        ]
      },
      "response": {
        "status": 200,
        "body": "<soap11env:Envelope xmlns:soap11env=\"http://schemas.xmlsoap.org/soap/envelope/\" xmlns:tns=\"http://nais.gov.ua/api/sevdeir/EDR\" xmlns:xroad=\"http://x-road.eu/xsd/xroad.xsd\" xmlns:id=\"http://x-road.eu/xsd/identifiers\">\n   <soap11env:Header>\n      <tns:AuthorizationToken>token</tns:AuthorizationToken>\n      <xroad:userId>MDTUDDM</xroad:userId>\n      <xroad:client id:objectType=\"SUBSYSTEM\">\n         <id:xRoadInstance>SEVDEIR-TEST</id:xRoadInstance>\n         <id:memberClass>GOV</id:memberClass>\n         <id:memberCode>43395033</id:memberCode>\n         <id:subsystemCode>IDGOV_TEST_01</id:subsystemCode>\n      </xroad:client>\n      <xroad:service id:objectType=\"SERVICE\">\n         <id:xRoadInstance>SEVDEIR-TEST</id:xRoadInstance>\n         <id:memberClass>GOV</id:memberClass>\n         <id:memberCode>00015622</id:memberCode>\n         <id:subsystemCode>2_MJU_EDR_prod</id:subsystemCode>\n         <id:serviceCode>SearchSubjects</id:serviceCode>\n      </xroad:service>\n      <xroad:protocolVersion>4.0</xroad:protocolVersion>\n      <xroad:id>MDTUDDM</xroad:id>\n      <xroad:requestHash algorithmId=\"http://www.w3.org/2001/04/xmldsig-more#gost34311\">kfkfkjkfjkjkfjkfjkjokojkkjlkjkjlkjdlkjljkdlk=</xroad:requestHash>\n   </soap11env:Header>\n   <soap11env:Body>\n      <tns:SearchSubjectsResponse>\n         <tns:SubjectList/>\n      </tns:SearchSubjectsResponse>\n   </soap11env:Body>\n</soap11env:Envelope>",
        "headers": {
          "Content-Type": "text/xml"
        }
      }
    }
]
}
----
====

//–¶–µ–π —à–∞–±–ª–æ–Ω —Å—Ç–≤–æ—Ä—é—î—Ç—å—Å—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é WireMock —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –¥–ª—è —ñ–º—ñ—Ç–∞—Ü—ñ—ó –≤–µ–±—Å–µ—Ä–≤—ñ—Å—É, —è–∫–∏–π –æ–±—Ä–æ–±–ª—è—î SOAP-–∑–∞–ø–∏—Ç–∏.
This template is created using WireMock and is used to simulate a web service that handles SOAP requests.

//–ü—Ä–∞—Ü—é—î —Ü–µ –Ω–∞—Å—Ç—É–ø–Ω–∏–º —á–∏–Ω–æ–º: ::
This works as follows: ::
+
//. *`request`* -- –≤–∏–∑–Ω–∞—á–∞—î –∫—Ä–∏—Ç–µ—Ä—ñ—ó, —è–∫–∏–º SOAP-–∑–∞–ø–∏—Ç –º–∞—î –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—Ç–∏, —â–æ–± –±—É—Ç–∏ –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–∏–º. –£ –Ω–∞—à–æ–º—É –ø—Ä–∏–∫–ª–∞–¥—ñ —à–∞–±–ª–æ–Ω —à—É–∫–∞—î `POST`-–∑–∞–ø–∏—Ç–∏, —Ç—ñ–ª–æ —è–∫–∏—Ö –≤—ñ–¥–ø–æ–≤—ñ–¥–∞—î —Ç–∞–∫–æ–º—É `XPath`-–≤–∏—Ä–∞–∑—É:
. *`request`* -- specifies the criteria that a SOAP request must meet in order to be intercepted. In our example template, the pattern is looking for `POST` requests whose body matches the following `XPath` expression:
+
----
"//*[local-name()='serviceCode'][text()='SearchSubjects']"
----
+
//–¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –∑–∞–ø–∏—Ç –±—É–¥–µ –ø–µ—Ä–µ—Ö–æ–ø–ª–µ–Ω–∏–π, —è–∫—â–æ –≤—ñ–Ω –º—ñ—Å—Ç–∏—Ç—å –µ–ª–µ–º–µ–Ω—Ç –∑ –ª–æ–∫–∞–ª—å–Ω–∏–º —ñ–º'—è–º `'serviceCode'` —Ç–∞ —Ç–µ–∫—Å—Ç–æ–º `'SearchSubjects'`.
This means that the request will be intercepted if it contains an element with the local name `'serviceCode'` and the text `'SearchSubjects'`.

. *`response`* -- defines the response that WireMock will return when it finds an incoming request that matches the template. In this case, it returns an `HTTP` response with a status code of `200`, a header `Content-Type: text/xml` and a specific XML payload which is the response to the SOAP request.

. *SOAP Envelope* is the top-level element of a SOAP (Simple Object Access Protocol) message and identifies that the message is a SOAP message. It contains information that needs to be conveyed between client and server applications.
+
//SOAP-–ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è –ø–æ–≤–∏–Ω–Ω–æ –º—ñ—Å—Ç–∏—Ç–∏ `Envelope` —ñ–∑ –Ω–∞—Å—Ç—É–ø–Ω–æ—é —Å—Ç—Ä—É–∫—Ç—É—Ä–æ—é:
SOAP message must contain an Envelope with the following structure:
+

.Structure of a basic SOAP message
[source,xml]
----
<soap11env:Envelope
    xmlns:soap11env="http://schemas.xmlsoap.org/soap/envelope/"
    xmlns:tns="http://nais.gov.ua/api/sevdeir/EDR"
    xmlns:xroad="http://x-road.eu/xsd/xroad.xsd"
    xmlns:id="http://x-road.eu/xsd/identifiers">
    <soap11env:Header>
        <!-- Header -->
    </soap11env:Header>
    <soap11env:Body>
        <!-- Body -->
    </soap11env:Body>
</soap11env:Envelope>
----

//* *`Envelope`* -- —Ü–µ –∫–æ—Ä–µ–Ω–µ–≤–∏–π –µ–ª–µ–º–µ–Ω—Ç –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è SOAP, —â–æ –æ–±–≥–æ—Ä—Ç–∞—î —É—Å—é —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é, —è–∫–∞ –ø–µ—Ä–µ–¥–∞—î—Ç—å—Å—è.
* *`Envelope`* -- this is the root element of the SOAP message, which wraps all the information being transmitted.

//* *`Header`* (–ó–∞–≥–æ–ª–æ–≤–æ–∫) -- –Ω–µ–æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π –µ–ª–µ–º–µ–Ω—Ç, —è–∫–∏–π –º—ñ—Å—Ç–∏—Ç—å –¥–æ–¥–∞—Ç–∫–æ–≤—É —ñ–Ω—Ñ–æ—Ä–º–∞—Ü—ñ—é (–º–µ—Ç–∞–¥–∞–Ω—ñ), —è–∫–∞ –º–æ–∂–µ –±—É—Ç–∏ –Ω–µ–æ–±—Ö—ñ–¥–Ω–∞ –¥–ª—è –æ–±—Ä–æ–±–∫–∏ –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è. –£ –Ω–∞—à–æ–º—É –≤–∏–ø–∞–¥–∫—É –∑–∞–≥–æ–ª–æ–≤–æ–∫ –º—ñ—Å—Ç–∏—Ç—å –µ–ª–µ–º–µ–Ω—Ç–∏ –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü—ñ—ó, —ñ–¥–µ–Ω—Ç–∏—Ñ—ñ–∫–∞—Ü—ñ—ó –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞, –∫–ª—ñ—î–Ω—Ç–∞, —Å–µ—Ä–≤—ñ—Å—É —Ç–æ—â–æ.
* *`Header`* -- an optional element that contains additional information (metadata) that may be required to process the message. In our case, the header contains elements for authorization, user identification, client, service, etc.

//* *`Body`* (–¢—ñ–ª–æ) -- –º—ñ—Å—Ç–∏—Ç—å —Ñ–∞–∫—Ç–∏—á–Ω—ñ –¥–∞–Ω—ñ, —è–∫—ñ –ø–µ—Ä–µ–¥–∞—é—Ç—å—Å—è. –¶–µ —î–¥–∏–Ω–∏–π –æ–±–æ–≤'—è–∑–∫–æ–≤–∏–π –µ–ª–µ–º–µ–Ω—Ç SOAP Envelope. –£ –Ω–∞—à–æ–º—É –≤–∏–ø–∞–¥–∫—É —Ç—ñ–ª–æ –º—ñ—Å—Ç–∏—Ç—å –≤—ñ–¥–ø–æ–≤—ñ–¥—å –∑ –µ–ª–µ–º–µ–Ω—Ç–æ–º `SearchSubjectsResponse`.
* *`Body`* -- contains the actual data being transmitted. This is the only mandatory element of the SOAP Envelope. In our case, the body contains a response with the `SearchSubjectsResponse` element.
+
[NOTE]
//–¢–∞–∫–æ–∂ —Å–ª—ñ–¥ –∑–≤–µ—Ä–Ω—É—Ç–∏ —É–≤–∞–≥—É –Ω–∞ –∞—Ç—Ä–∏–±—É—Ç–∏ –∑ –æ–≥–æ–ª–æ—à–µ–Ω–Ω—è–º–∏ –ø—Ä–æ—Å—Ç–æ—Ä—ñ–≤ —ñ–º–µ–Ω (`xmlns`), —è–∫—ñ –≤–∏–∑–Ω–∞—á–∞—é—Ç—å –ø—Ä–æ—Å—Ç–æ—Ä–∏ —ñ–º–µ–Ω –¥–ª—è —Ä—ñ–∑–Ω–∏—Ö —á–∞—Å—Ç–∏–Ω –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è —ñ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è –¥–ª—è —Ç–æ–≥–æ, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –∫–æ–Ω—Ñ–ª—ñ–∫—Ç—ñ–≤ –º—ñ–∂ –µ–ª–µ–º–µ–Ω—Ç–∞–º–∏ –∑ –æ–¥–Ω–∞–∫–æ–≤–∏–º–∏ —ñ–º–µ–Ω–∞–º–∏, –∞–ª–µ –∑ —Ä—ñ–∑–Ω–∏—Ö –¥–∂–µ—Ä–µ–ª.
It is also important to note the attributes with namespace declarations (xmlns), which define the namespaces for different parts of the message and are used to avoid conflicts between elements with the same name but from different sources.

[#create-wiremock-route]
//== –°—Ç–≤–æ—Ä–µ–Ω–Ω—è —Ä–æ—É—Ç–∞ –¥–ª—è —Å–µ—Ä–≤—ñ—Å—É —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è WireMock
== Creating a route for the service and using WireMock

//–í —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ñ –≤–∏—â–µ–∑–∞–∑–Ω–∞—á–µ–Ω–∏—Ö –¥—ñ–π, —Å—Ç–≤–æ—Ä–∏—Ç—å—Å—è –ø–æ–¥ —Å–µ—Ä–≤—ñ—Å—É *`wiremock`*. –¢–µ–ø–µ—Ä –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ —ñ–∑ –∫–æ–ª–µ–∫—Ü—ñ—î—é API WireMock –¥–≤–æ–º–∞ —à–ª—è—Ö–∞–º–∏:
Following the steps mentioned above, a sub-service wiremock will be created. Now, you can interact with the WireMock API collection in two ways:

* xref:#wiremock-testing-postman[through Postman directly];
//* —á–µ—Ä–µ–∑ —Ä–æ—É—Ç –¥–æ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É WireMock –≤ OpenShift (_–¥–∏–≤. –æ–ø–∏—Å –Ω–∏–∂—á–µ —É —Ü—å–æ–º—É —Ä–æ–∑–¥—ñ–ª—ñ_).
* through a route to the WireMock interface in OpenShift (_see description below in this section_).

//–°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π —Ä–æ—É—Ç –¥–ª—è —Ü—å–æ–≥–æ —Å–µ—Ä–≤—ñ—Å—É –≤—Ä—É—á–Ω—É. –î–ª—è —Ü—å–æ–≥–æ –≤–∏–∫–æ–Ω–∞–π—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—ñ –∫—Ä–æ–∫–∏:
To create a new route for this service manually, follow these steps:

. Sign in to the *OpenShift* console, go to the *Projects* section and find your registry project.

. Go to *Networking* > *Routes* and create a new route by clicking the *`Create Route`* button.

. Select *Configure via* > *Form view* in a new window.

. In the *Name* field, provide a unique name for the route in your registry project. For example, `test-wiremock-route`.

. In the *Hostname*  field, provide the hostname where the route will be deployed. For example, `test-wiremock-route.apps.1-9-6-1.mdtu-ddm.projects.epam.com`.
+
NOTE: This is the public hostname for the route. You can leave the field empty-- and the system will generate a `hostname` automatically.

. In the *Path* field, provide the path that the router uses to route traffic to the service. For example,`/`.

. In the *Service* field, select the sub-service from the available list -- *`wiremock`*.

. In the *Target port* field, specify the target port where the traffic should be allowed. Select the option `9021->9021 (TCP)`.

. Define security settings for the connection. Routes can be secured using several types of TLS termination.
+
[NOTE]
====
[%collapsible]
.What TLS termination is?
=====
*TLS termination* in OpenShift refers to the process of decrypting TLS-encrypted traffic at a certain level in the structure of your service and is used to secure communication between clients and servers.

//OpenShift –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î –∫–æ–Ω—Ü–µ–ø—Ü—ñ—é "—Ä–æ—É—Ç—ñ–≤" –¥–ª—è –µ–∫—Å–ø–æ–Ω—É–≤–∞–Ω–Ω—è —Å–µ—Ä–≤—ñ—Å—ñ–≤ –Ω–∞ –∑–æ–≤–Ω—ñ—à–Ω—ñ–π –º–µ—Ä–µ–∂—ñ. –†–æ—É—Ç –¥–æ–∑–≤–æ–ª—è—î –≤–∞–º –≤–∏–∑–Ω–∞—á–∞—Ç–∏, —è–∫ –∑–æ–≤–Ω—ñ—à–Ω—ñ –∑–∞–ø–∏—Ç–∏ –ø–æ–≤–∏–Ω–Ω—ñ —Ç—Ä–∞–Ω—Å–ª—é–≤–∞—Ç–∏—Å—è –Ω–∞ —Å–µ—Ä–≤—ñ—Å–∏ –≤—Å–µ—Ä–µ–¥–∏–Ω—ñ –∫–ª–∞—Å—Ç–µ—Ä–∞.
In OpenShift, the concept of "routes" is used to expose services to the external network. A route allows you to define how external requests should be routed to services inside the cluster.

//–ü—Ä–∏ —Å—Ç–≤–æ—Ä–µ–Ω–Ω—ñ —Ä–æ—É—Ç–∞ –≤ OpenShift, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∫–∞–∑–∞—Ç–∏, –¥–µ —Å–∞–º–µ –º–∞—î –≤—ñ–¥–±—É–≤–∞—Ç–∏—Å—è TLS-—Ç–µ—Ä–º—ñ–Ω–∞—Ü—ñ—è:
When creating a route in OpenShift, you can specify exactly where TLS termination should occur:

//* *Edge Termination*: –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—è TLS –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –Ω–∞ —Ä—ñ–≤–Ω—ñ —Ä–æ—É—Ç–∞. –¶–µ –æ–∑–Ω–∞—á–∞—î, —â–æ OpenShift —Ä–æ–∑—à–∏—Ñ—Ä–æ–≤—É—î —Ç—Ä–∞—Ñ—ñ–∫, –ø–µ—Ä—à –Ω—ñ–∂ –≤—ñ–Ω –ø–æ—Ç—Ä–∞–ø–ª—è—î –¥–æ –≤–∞—à–æ–≥–æ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É. –ü—ñ—Å–ª—è —Ä–æ–∑—à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è, —Ç—Ä–∞—Ñ—ñ–∫ –º–æ–∂–µ –±—É—Ç–∏ –ø–µ—Ä–µ–¥–∞–Ω–∏–π –¥–æ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É —è–∫ –Ω–µ–∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π –∞–±–æ –ø–æ–≤—Ç–æ—Ä–Ω–æ –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–π.
* *Edge Termination*: TLS termination occurs at the route level. This means that OpenShift decrypts the traffic before it reaches your application. After decryption, the traffic can be passed to the application as either unencrypted or re-encrypted.

//* *Passthrough Termination*: –∑ OpenShift –Ω–µ –≤—Ç—Ä—É—á–∞—î—Ç—å—Å—è —É —à–∏—Ñ—Ä—É–≤–∞–Ω–Ω—è, —ñ TLS —Ç—Ä–∞—Ñ—ñ–∫ –ø—Ä–æ—Ö–æ–¥–∏—Ç—å —á–µ—Ä–µ–∑ —Ä–æ—É—Ç –±–µ–∑ –∑–º—ñ–Ω. –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è TLS –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –Ω–∞ —Ä—ñ–≤–Ω—ñ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É –∞–±–æ —Å–µ—Ä–≤—ñ—Å—É.
* *Passthrough Termination*: OpenShift does not interfere with encryption, and TLS traffic passes through the route unchanged. TLS termination occurs at the application or service level.

//* *Re-encrypt Termination*: —Ü–µ –∫–æ–º–±—ñ–Ω–∞—Ü—ñ—è `Edge` —Ç–∞ `Passthrough`. –ó–∞–≤–µ—Ä—à–µ–Ω–Ω—è TLS –≤—ñ–¥–±—É–≤–∞—î—Ç—å—Å—è –Ω–∞ —Ä–æ—É—Ç—ñ, –∞ –ø–æ—Ç—ñ–º —Ç—Ä–∞—Ñ—ñ–∫ —à–∏—Ñ—Ä—É—î—Ç—å—Å—è –∑–Ω–æ–≤—É –ø–µ—Ä–µ–¥ –ø–µ—Ä–µ–¥–∞—á–µ—é –¥–æ –∑–∞—Å—Ç–æ—Å—É–Ω–∫—É. –¶–µ –º–æ–∂–µ –±—É—Ç–∏ –∫–æ—Ä–∏—Å–Ω–∏–º, —è–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —Ä—ñ–∑–Ω—ñ —Å–µ—Ä—Ç–∏—Ñ—ñ–∫–∞—Ç–∏ –¥–ª—è –∑–æ–≤–Ω—ñ—à–Ω—å–æ—ó —Ç–∞ –≤–Ω—É—Ç—Ä—ñ—à–Ω—å–æ—ó –∫–æ–º—É–Ω—ñ–∫–∞—Ü—ñ—ó.
* *Re-encrypt Termination*: this is a combination of `Edge` and `Passthrough`. TLS termination occurs at the route, and then the traffic is encrypted again before being passed to the application. This can be useful if you want to use different certificates for external and internal communication.
=====
====

. In the *Insecure traffic*  field, define the policy for HTTP traffic. The available options are:

* `None`
* `Allow`
* `Redirect`

. Click *`Create`* and save the changes. As a result, the route for emulating external interaction will be added to the list of available routes in your registry project.
+
image:registry-admin/external-integration/mock-integrations/mock-integrations-2.png[]

. Follow the link to the corresponding service *`wiremock`*.
+
image:registry-admin/external-integration/mock-integrations/mock-integrations-3.png[]
+
[WARNING]
====

//–û–±–æ–≤'—è–∑–∫–æ–≤–æ –¥–æ–¥–∞–π—Ç–µ –µ–Ω–¥–ø–æ—ñ–Ω—Ç *`/__admin/webapp`* —É –∫—ñ–Ω—Ü—ñ URL —Å–µ—Ä–≤—ñ—Å—É, —â–æ–± —É–Ω–∏–∫–Ω—É—Ç–∏ –ø–æ–º–∏–ª–∫–∏ `403 Forbidden`.
Be sure to add the endpoint *`/__admin/webapp`* to the end of the service URL to avoid `403 Forbidden`error.

image:registry-admin/external-integration/mock-integrations/mock-integrations-4.png[]
====
+
//–¢–µ–ø–µ—Ä –≤–∏ –∑–º–æ–∂–µ—Ç–µ –ø–æ–±–∞—á–∏—Ç–∏ —É—Å—ñ –æ–ø—É–±–ª—ñ–∫–æ–≤–∞–Ω—ñ –º–æ–∫–∏ –≤ –∑—Ä—É—á–Ω–æ–º—É —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—ñ, –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–æ –¥–æ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏ –≤–∞—à–æ–≥–æ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—É. –í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å WireMock –¥–ª—è —Ä–æ–±–æ—Ç–∏ —ñ–∑ –∫–æ–ª–µ–∫—Ü—ñ—î—é –º–æ–∫—ñ–≤.
Now you can see all the published mocks in a convenient interface, according to the structure of your registry. You can use the WireMock interface to work with the collection of mocks
+
image:registry-admin/external-integration/mock-integrations/mock-integrations-5.png[]
+
TIP: Explore the capabilities of WireMock at https://wiremock.org/docs/[in the official product documentation].
//–û–∑–Ω–∞–π–æ–º—Ç–µ—Å—è —ñ–∑ –º–æ–∂–ª–∏–≤–æ—Å—Ç—è–º–∏ WireMock –≤ https://wiremock.org/docs/[–æ—Ñ—ñ—Ü—ñ–π–Ω—ñ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó] –ø—Ä–æ–¥—É–∫—Ç—É.


[#wiremock-testing-postman]
//== –¢–µ—Å—Ç—É–≤–∞–Ω–Ω—è API –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é Postman
== API testing using Postman

//–í–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –∫–æ–ª–µ–∫—Ü—ñ—é –º–æ–∫—ñ–≤ —á–µ—Ä–µ–∑ –∑'—î–¥–Ω–∞–Ω–Ω—è —ñ–∑ –ø–æ–¥–æ–º —Å–µ—Ä–≤—ñ—Å—É `wiremock` —Ç–∞ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ API WireMock –ø—Ä–∏ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—ñ —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω–æ—ó –≤–∑–∞—î–º–æ–¥—ñ—ó.
You can use the collection of mocks by connecting to the sub-service `wiremock` and using the WireMock API for testing integration scenarios.

[NOTE]
====
//–î–ª—è —Ü—å–æ–≥–æ –≤–∞–º –º–æ–∂–µ –∑–Ω–∞–¥–æ–±–∏—Ç–∏—Å—è https://www.postman.com/downloads/[Postman] -- —ñ–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç –¥–ª—è —Ä–æ–∑—Ä–æ–±–∫–∏ —Ç–∞ —Ç–µ—Å—Ç—É–≤–∞–Ω–Ω—è API. –ó–∞ –ø–æ—Ç—Ä–µ–±–∏, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–≤–∞—Ç–∏ –±—É–¥—å-—è–∫–∏–π –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π –≤–∞—Ä—ñ–∞–Ω—Ç.
You may need https://www.postman.com/downloads/[Postman] - a tool for developing and testing APIs. If necessary, you can use any alternative option.

//–¢–∞–∫–æ–∂ –≤—Å—Ç–∞–Ω–æ–≤—ñ—Ç—å https://docs.openshift.com/container-platform/4.12/cli_reference/openshift_cli/getting-started-cli.html[OpenShift CLI] -- —É—Ç–∏–ª—ñ—Ç–∞ –∫–æ–º–∞–Ω–¥–Ω–æ–≥–æ —Ä—è–¥–∫–∞, —è–∫–∞ –Ω–∞–¥–∞—î –¥–æ—Å—Ç—É–ø –¥–æ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —Ç–∞ –≤–∑–∞—î–º–æ–¥—ñ—ó –∑ –∫–ª–∞—Å—Ç–µ—Ä–æ–º OpenShift.
Also, install https://docs.openshift.com/container-platform/4.12/cli_reference/openshift_cli/getting-started-cli.html[OpenShift CLI] - a command-line utility that provides access to managing and interacting with the OpenShift cluster.
====

//. –£–≤—ñ–π–¥—ñ—Ç—å –¥–æ *OpenShift*-–∫–æ–Ω—Å–æ–ª—ñ.
. Sign in to the *OpenShift*- console

. In the top right corner of the interface, click on the user -- `<your name>` , and copy the login command for logging in through `oc cli` -- *`Copy login command`*.
//. –£ –ø—Ä–∞–≤–æ–º—É –≤–µ—Ä—Ö–Ω—å–æ–º—É –∫—É—Ç—ñ —ñ–Ω—Ç–µ—Ä—Ñ–µ–π—Å—É –Ω–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞ -- `<–≤–∞—à–µ —ñ–º'—è>` —Ç–∞ —Å–∫–æ–ø—ñ—é–π—Ç–µ –∫–æ–º–∞–Ω–¥—É –¥–ª—è –≤—Ö–æ–¥—É —á–µ—Ä–µ–∑ `oc cli` -- *`Copy login command`*.

. Click on *`Display Token`* and copy the command in the *Log in with this token*.. The command may look like this:
//. –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å *`Display Token`* —Ç–∞ —Å–∫–æ–ø—ñ—é–π—Ç–µ –∫–æ–º–∞–Ω–¥—É —É –ø–æ–ª—ñ *Log in with this token*. –ö–æ–º–∞–Ω–¥–∞ –º–æ–∂–µ –≤–∏–≥–ª—è–¥–∞—Ç–∏ —Ç–∞–∫:
+
----
oc login --token=sha256~kjshdfhfdj_jnksdjnfksdnf-KMCZ0vMR2Y --server=https://api.1-9-6-1.mdtu-ddm.projects.epam.com:6443
----

. Open the terminal or console on your operating system and paste the copied command for logging in.
//. –í—ñ–¥–∫—Ä–∏–π—Ç–µ —Ç–µ—Ä–º—ñ–Ω–∞–ª –∞–±–æ –∫–æ–Ω—Å–æ–ª—å –Ω–∞ –≤–∞—à—ñ–π –æ–ø–µ—Ä–∞—Ü—ñ–π–Ω—ñ–π —Å–∏—Å—Ç–µ–º—ñ —Ç–∞ –≤—Å—Ç–∞–≤—Ç–µ —Å–∫–æ–ø—ñ–π–æ–≤–∞–Ω—É –∫–æ–º–∞–Ω–¥—É –¥–ª—è –≤—Ö–æ–¥—É.
+
//–¢–∞–∫–∏–º —á–∏–Ω–æ–º –≤–∏ –∑–º–æ–∂–µ—Ç–µ –≤–∑–∞—î–º–æ–¥—ñ—è—Ç–∏ —è–∫ –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä –∑ OpenShift —á–µ—Ä–µ–∑ `oc cli`.
This way, you will be able to interact as an administrator with OpenShift through `oc cli`.

. Configure port forwarding from the sub-service `wiremock` to your local machine. To do this, run the following command in the terminal:
//. –ù–∞–ª–∞—à—Ç—É–π—Ç–µ –ø–µ—Ä–µ–∞–¥—Ä–µ—Å–∞—Ü—ñ—é –ø–æ—Ä—Ç—ñ–≤ (port forwarding) —ñ–∑ –ø–æ–¥—É —Å–µ—Ä–≤—ñ—Å—É `wiremock` –Ω–∞ –≤–∞—à—É –ª–æ–∫–∞–ª—å–Ω—É –º–∞—à–∏–Ω—É. –î–ª—è —Ü—å–æ–≥–æ —É —Ç–µ—Ä–º—ñ–Ω–∞–ª—ñ –≤–∏–∫–æ–Ω–∞–π—Ç–µ –Ω–∞—Å—Ç—É–ø–Ω—É –∫–æ–º–∞–Ω–¥—É:
+
.Port forwarding for connecting to the sub-service wiremock
====
----
oc port-forward wiremock-644c996b78-5ftrx 9021:9021 -n abc-01
----

* `wiremock-644c996b78-5ftrx` -- the name of the pod with the `wiremock`service in your registry project.

* `9021:9021` -- ports for forwarding.

** First port (`9021` before a colon) -- this is the port on your local machine. By default, this is port `9021`. You can choose any free port.
** Second port (`9021` after a colon) -- this is the port on the target pod (`wiremock-644c996b78-5ftrx`) in the namespace `abc-01`.

+
[TIP]
=====
.How to check the list of open ports on the local machine?
[%collapsible]
======
You can check the list of open ports on your machine using the following commands
(for Windows):

----
netstat -ano
----

//–¶—è –∫–æ–º–∞–Ω–¥–∞ –≤—ñ–¥–æ–±—Ä–∞–∑–∏—Ç—å —Å–ø–∏—Å–æ–∫ —É—Å—ñ—Ö –∞–∫—Ç–∏–≤–Ω–∏—Ö TCP-–∑'—î–¥–Ω–∞–Ω—å, —ó—Ö –ø–æ—Ä—Ç—ñ–≤ —Ç–∞ PID (Process ID) –ø—Ä–æ—Ü–µ—Å—ñ–≤, —â–æ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å —Ü—ñ –∑'—î–¥–Ω–∞–Ω–Ω—è.
This command will display a list of all active TCP connections, their ports, and the PID (Process ID) of the processes that use these connections.

//–Ø–∫—â–æ –≤–∏ —Ö–æ—á–µ—Ç–µ –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–∏–π –ø–æ—Ä—Ç, –≤–∏ –º–æ–∂–µ—Ç–µ –¥–æ–¥–∞—Ç–∏ –π–æ–≥–æ –≤ –∫–æ–º–∞–Ω–¥—É `netstat` –∑ –∫–ª—é—á–µ–º `findstr`. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —â–æ–± –ø–µ—Ä–µ–≤—ñ—Ä–∏—Ç–∏, —á–∏ –≤—ñ–ª—å–Ω–∏–π –ø–æ—Ä—Ç `8080`, –≤–∏ –º–æ–∂–µ—Ç–µ –≤–∏–∫–æ–Ω–∞—Ç–∏ –Ω–∞—Å—Ç—É–ø–Ω—É –∫–æ–º–∞–Ω–¥—É:
If you want to check a specific port, you can add it to the `netstat` command with the `findstr` key. For example, to check if the port `8080` is available, you can run the following command:

----
netstat -ano | findstr 8080
----

//–Ø–∫—â–æ –∫–æ–º–∞–Ω–¥–∞ –Ω—ñ—á–æ–≥–æ –Ω–µ –≤–∏–≤–æ–¥–∏—Ç—å, —Ü–µ –æ–∑–Ω–∞—á–∞—î, —â–æ –ø–æ—Ä—Ç `8080` –≤—ñ–ª—å–Ω–∏–π.
If the command returns no output, it means that the port 8080 is available and not being used.
======
=====

* `abc-01` -- name of your registry.
====

+
image:registry-admin/external-integration/mock-integrations/mock-integrations-6.png[]

. Open the Postman application and create a new collection. You can name it Wiremock as an example.
//. –í—ñ–¥–∫—Ä–∏–π—Ç–µ –∑–∞—Å—Ç–æ—Å—É–Ω–æ–∫ Postman —Ç–∞ —Å—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤—É –∫–æ–ª–µ–∫—Ü—ñ—é. –í–∏ –º–æ–∂–µ—Ç–µ –Ω–∞–∑–≤–∞—Ç–∏ —ó—ó Wiremock, —è–∫ –ø—Ä–∏–∫–ª–∞–¥.

. Create a new GET request and send it to the endpoint `http://localhost:9021/__admin/mappings`.  This way, you will get a list of all available mocks in the wiremock service, provided by the structure of your registry.
//. –°—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π GET-–∑–∞–ø–∏—Ç —Ç–∞ –Ω–∞–¥—ñ—à–ª—ñ—Ç—å –π–æ–≥–æ –Ω–∞ –µ–Ω–¥–ø–æ—ñ–Ω—Ç `http://localhost:9021/__admin/mappings`. –¢–∞–∫–∏–º —á–∏–Ω–æ–º, –≤–∏ –æ—Ç—Ä–∏–º–∞—î—Ç–µ —Å–ø–∏—Å–æ–∫ —É—Å—ñ—Ö –¥–æ—Å—Ç—É–ø–Ω–∏—Ö –º–æ–∫—ñ–≤ —É —Å–µ—Ä–≤—ñ—Å—ñ wiremock, –ø–µ—Ä–µ–¥–±–∞—á–µ–Ω–∏—Ö —Å—Ç—Ä—É–∫—Ç—É—Ä–æ—é –≤–∞—à–æ–≥–æ —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—É.
+
image:registry-admin/external-integration/mock-integrations/mock-integrations-7.png[]

. Create new requests to test the rules and interaction scenarios with external services and systems specified in the mocks.
//. –ù–∞–¥–∞–ª—ñ —Å—Ç–≤–æ—Ä—é–π—Ç–µ –Ω–æ–≤—ñ –∑–∞–ø–∏—Ç–∏ –¥–ª—è –ø–µ—Ä–µ–≤—ñ—Ä–∫–∏ –∑–∞–¥–∞–Ω–∏—Ö —É –º–æ–∫–∞—Ö –ø—Ä–∞–≤–∏–ª —Ç–∞ —Å—Ü–µ–Ω–∞—Ä—ñ—ó–≤ –≤–∑–∞—î–º–æ–¥—ñ—ó —ñ–∑ –∑–æ–≤–Ω—ñ—à–Ω—ñ–º–∏ —Å–µ—Ä–≤—ñ—Å–∞–º–∏ —Ç–∞ —Å–∏—Å—Ç–µ–º–∞–º–∏.

[#bp-soap-rest-connectors]
//== –í–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω–∏—Ö –∫–æ–Ω–µ–∫—Ç–æ—Ä—ñ–≤ —É –±—ñ–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å–∞—Ö
== Usage of integration connectors in business processes

//–ü—ñ—Å–ª—è –∞–∫—Ç–∏–≤–∞—Ü—ñ—ó –º–æ–∫—ñ–≤ —É *Control Plane* —Ç–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è —à–∞–±–ª–æ–Ω—ñ–≤ _mock-integrations_ —É —Ä–µ–≥–ª–∞–º–µ–Ω—Ç—ñ, –≤–∏ –º–æ–∂–µ—Ç–µ –º–æ–¥–µ–ª—é–≤–∞—Ç–∏ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω—É –≤–∑–∞—î–º–æ–¥—ñ—é —É –±—ñ–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å–∞—Ö –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏—Ö SOAP —Ç–∞ REST-–∫–æ–Ω–µ–∫—Ç–æ—Ä—ñ–≤.
After activating the mocks in the Control Plane and configuring the mock-integrations templates in the registry, you can model integration scenarios in business processes using the corresponding SOAP and REST connectors.

[TIP]
====
//–î–µ—Ç–∞–ª—å–Ω—ñ—à–µ –ø—Ä–æ —ñ–Ω—Ç–µ–≥—Ä–∞—Ü—ñ–π–Ω—ñ –∫–æ–Ω–µ–∫—Ç–æ—Ä–∏ –≤–∏ –º–æ–∂–µ—Ç–µ –ø–µ—Ä–µ–≥–ª—è–Ω—É—Ç–∏ —Å—Ç–æ—Ä—ñ–Ω–∫–∞—Ö:
You can find more detailed information about integration connectors in the following pages:

* xref:bp-modeling/external-integration/api-call/connectors-external-registry.adoc[]
* xref:bp-modeling/bp/rest-connector.adoc[]
====

