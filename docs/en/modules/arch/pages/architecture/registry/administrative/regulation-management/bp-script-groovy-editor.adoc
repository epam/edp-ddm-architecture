= Editing business process groovy scripts in admin-portal
include::platform:ROOT:partial$templates/document-attributes/arch-set-en.adoc[]

include::platform:ROOT:partial$admonitions/language-en.adoc[]

== Problem statement and solution

The development of the registry regulations business processes includes the development of Groovy scripts that reflect the logic of the business process steps. The admin portal allows the development of business processes for the registry regulations.

Developing Groovy scripts in specialized development tools, such as IDE (Desktop or Web versions), is much more efficient.

Extending the admin portal with the rich web editors for editing groovy scripts will improve the user experience to the level of using Desktop IDE tools, as well as reduce the time for continuous transfer of scripts to Desktop IDE for editing and back to BPMN.IO visual business process designer.
//Розширення адмін-порталу використанням rich веб редакторів редагування Groovy скриптів покращить user experience до рівня використання Desktop IDE інструментів, а також зменшить час на постійне переміщення скриптів в Desktop IDE для редагування та назад в BPMN.IO візуальний конструктор бізнес-процесів

[NOTE]
xref:architecture-workspace/research/admin-portal/code-editor-language-server-protocol.adoc[The POC results] to learn about the LSP protocol and the MonacoEditor web code editor.
//xref:architecture-workspace/research/admin-portal/code-editor-language-server-protocol.adoc[Результати POC] для ознайомлення з LSP протоколом та веб-редактором коду MonacoEditor

== Glossary
//== Глосарій

- LSP - Language Server Protocol
- LS - Language Server
- WS - WebSocket
- WSS - WebSocket Secure

== Actors
//== Актори
- Registry regulations developer
//- Розробник регламенту реєстру

== Editor functionality
//== Функціональні можливості редактору

[NOTE]
The following functionality is equally used for two functional scenarios: creating a new workflow step and editing or viewing an existing one.
//Наступні функціональні можливості в рівній мірі використовуються для двох функціональних сценаріїв: створення нового кроку бізнес-процесу та редагування або перегляд існуючого.

- Auto-completion as a drop-down list of the call variants.
//- Автодоповнення у вигляді випадаючого списку варіантів виклику
- Display the results of code analysis for errors using the language server.
//- Відображення результату аналізу коду на наявність помилок за допомогою language server
- Display Hoover tooltip with javadoc information.
//- Показ Hoover тултипу з javadoc інформацією
- Use different colors when viewing code.
//- Використання різних кольорів при перегляді коду
- Auto-completion for DDM JUEL functions:
//- Автодоповнення для DDM JUEL функцій:
** initiator
** completer
** system_user
** submission
** sign_submission
** get_variable
** set_variable
** set_transient_variable
** process_caller
** message_payload

== Basic principles
//== Основні принципи

- Monaco editor as a Web tool for the development of groovy scripts.
//- Monaco editor в якості Web інструменту розробки groovy скриптів
- Using third-party Language Servers (LS) to get hints, the list for auto-completion and results of errors of semantic analysis of Groovy scripts.
//- Використання сторонніх Language Server's (LS's) для отримання підказок, переліку для автодоповнення та результату помилок семантичного аналізу Groovy скриптів
- Using Language Server Protocol for communication between Language Server and Monaco editor.
//- Використання Language Server Protocol для комунікації між Language Server та Monaco editor
- Using lsp4j for LS management (orchestration).
//- Використання lsp4j для менеджменту (orchestration) LS's
- Transport communication protocol between Monaco editor and LS - WebSocket over HTTP (HTTPS).
//- Транспортний протокол комунікації між Monaco editor та LS - WebSocket over HTTP (HTTPS)
- Logical communication protocol (payload structure in the transport protocol messages) between Monaco editor and LS.
//- Логічний протокол комунікації (структура payload в повідомленнях транспортного протоколу) між Monaco editor та LS - Json-RPC

== High level design
//== Високорівневий дизайн

image::architecture/registry/administrative/regulation-management/bpmnio-groovy-editor/bp-groovy-script-editor.svg[]

=== Description and purpose of components
//=== Опис та призначення компонентів

|===
|Name|Programming language|Description
//|Назва|Мова програмування|Опис

|https://microsoft.github.io/monaco-editor/[Monaco editor] | JavaScript | Visual browser-based code editor
//|https://microsoft.github.io/monaco-editor/[Monaco editor] | JavaScript | Візуальний веб-редактор коду

|Remote LS's | Java, LSP4J | Instances of LS services that use the LSP protocol and perform the client code check returning the test results in Json-RPC (LSP) format.
//|Remote LS's | Java, LSP4J | Екземпляри LS сервісів, що реалізує LSP протокол та виконують перевірку клієнтського коду з поверненням результатів перевірки в форматі Json-RPC(LSP).

|LS Manager, Websocket Manager|Java, Spring|Spring boot web controller. Creates the required LS instances. Creates a WebSocket and uses the appropriate LS instance to analyze and validate code from the visual editor to the client.
//|LS Manager, Websocket Manager|Java, Spring|Spring boot web controller. Створює необхідні екземпляри LS. Створює WebSocket та використовує  відповідний LS екземпляр для аналізу та перевірки коду з візуального редактору клієнту.

|===

=== LSP communication
//=== LSP комунікація

- WSS protocol is used as transport protocol.
//- В якості транспортного протоколу використовується WSS протокол
- The https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/[LSP] protocol, version 3.17 is used as RPC interaction.
//- В якості RPC взаємодії використовується https://microsoft.github.io/language-server-protocol/specifications/lsp/3.17/specification/[LSP] протокол версії 3.17


==== WebSocket communication
//==== WebSocket комунікація

image::architecture/registry/administrative/regulation-management/bpmnio-groovy-editor/web-sockets-diagram.svg[]

- WSS is used as transport protocol.
//- В якості транспортного протоколу використовується WSS
- To configure Web-socket communication from the UI layer side, the https://www.npmjs.com/package/monaco-languageclient[monaco-languageclient] is used.
//- Для налаштування Web-socket зв'язку зі сторони UI layer використовується https://www.npmjs.com/package/monaco-languageclient[monaco-languageclient].
- spring-websocket is used to organize the websocket backend part.
//- Для організації websocket backend частини використовується spring-websocket.

==== Number of LS instances
//==== Кількість екземплярів LS

image::architecture/registry/administrative/regulation-management/bpmnio-groovy-editor/web-sockets-concurrency-diagram.svg[]

- Each window with monaco editor uses its own individual web-socket instance to connect to LS.
//- Кожне вікно з monaco editor використовує свій окремий web-socket instance для з'єднання з LS
- Each web-socket uses an individual LS instance.
//- Кожний web-socket використовує окремий екземпляр LS.
- All LS instances are in the same JVM instance. Technically, each LS instance is a new instance with the `org.eclipse.lsp4j.services.LanguageServer` interface.
//- Всі LS екземпляри знаходяться в одному JVM екземплярі. Технічно кожний екземпляр LS це новий екземпляр з інтерфейсом `org.eclipse.lsp4j.services.LanguageServer`.

[plantuml,bp-script-editing ls-communication-sequence,svg]
----
include::partial$architecture/registry/administrative/regulation-management/bpmnio-groovy-editor/language-server-communication-sequence.puml[ls-communication-sequence]
----

== Component deployment
//== Розгортання компоненту

image::architecture/registry/administrative/regulation-management/bpmnio-groovy-editor/ls-deployment.svg[]

== Scaling
//== Масштабування

In the current version of the service deployment, it is suggested to use only vertical scaling (RAM, CPU).
//В поточній версії розгортання сервісу пропонується використовувати лише вертикальне масштабування (RAM, CPU).
Since the approach of placing all LSs within a single JVM is used, therefore, a significant increase in the use of computing resources is not expected during an increase in the number of the LS clients working at the same time.
//Оскільки використовується підхід розміщення всіх LS в рамках однієї JVM, тому не очікується значного збільшення використання обчислювальних ресурсів під час збільшення кількості одночасно працюючих кліентів LS.

[TIP]
Horizontal scaling is possible by adding Load Balancer for the LSP (WebSocket JSON-RPC) traffic.
//Горизонтальне маштабування можливе шляхом додавання Load Balancer для LSP (WebSocket JSON-RPC) трафіку.
Out of scope.

== Threat modeling
//== Моделювання загроз

|===
|Area|Name|Description|Limit Value
//|Area|Назва|Опис|Значення ліміту

.5+|Kong|WSS traffic through Kong|Settings of the traffic through admin kong by using Upgrade headers. https://docs.konghq.com/enterprise/2.4.x/proxy/#proxy-websocket-traffic[WebSocket kong manual] |
//.5+|Kong|WSS трафік через Kong|Налаштування пропускання трафіку через admin kong шляхом використання Upgrade headers. https://docs.konghq.com/enterprise/2.4.x/proxy/#proxy-websocket-traffic[WebSocket kong manual] |

| Authorization during the handshake process| Current authorization in admin kong. `GET /groovy` shall be accessible only for authorized users through admin realm |
//| Авторизація під час handshake процесу| Поточна авторизація на admin kong. `GET /groovy` повинен бути доступним тільки авторизованим користувачам через admin realm |

| Maximum request size| Limit for payload in LSP (JSON-RPC). Use https://docs.konghq.com/hub/kong-inc/request-size-limiting/[Request Size Limiting] | 65kb (30kb after SC)
//| Максимальний розмір запиту| Ліміт для payload всередині LSP (JSON-RPC). Використати https://docs.konghq.com/hub/kong-inc/request-size-limiting/[Request Size Limiting] | 65kb (30kb after SC)

| Socket timeout| Idle time for the socket through which it automatically closes. Required configuration on both BE and FE side. Kong config property `proxy_read_timeout`| 60s (should be by default)
//| Socket timeout| Idle time для сокету, через який він автоматично закривається. Необхідна конфігурація як на BE так і на FE side. Kong config property `proxy_read_timeout`| 60s (should be by default)

| Socket open Rate limit | Limit on the number of requests to create web-socket `/groovy`. Use existing plugin in Kong https://docs.konghq.com/hub/kong-inc/rate-limiting/[Rate limit plugin] | 10 per minute per user
//| Socket open Rate limit | Ліміт на кількість запитів на створення web-socket `/groovy`. Використати існуючий плагін в Kong https://docs.konghq.com/hub/kong-inc/rate-limiting/[Rate limit plugin] | 10 per minute per user

|Java application | CORS configuration | Configure CORS for the `/groovy` method for web-socket opening |
//|Java application | Конфігурація CORS | Налаштувати CORS для `/groovy` методу відкриття web-socket |

|Chart configuration| RAM limit |Set the RAM limit by configuring resources.requests.memory in the Chart deployment| 1GB
//|Chart configuration| RAM limit |Встановити RAM ліміт шляхом налаштування resources.requests.memory в Chart deployment| 1GB

|===

== Tech stack
//== Технологічний стек

[cols="2,1,1,2"]
|===
|Name|Version|License|Description
//|Назва|Версія|Ліцензія|Опис

|https://microsoft.github.io/monaco-editor/[Monaco editor] |0.34.1|https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt[MIT] | Visual browser-based code editor
//|https://microsoft.github.io/monaco-editor/[Monaco editor] |0.34.1|https://github.com/microsoft/monaco-editor/blob/main/LICENSE.txt[MIT] | Візуальний веб-редактор коду

|https://www.npmjs.com/package/monaco-languageclient[monaco-languageclient]|4.0.3|https://github.com/TypeFox/monaco-languageclient/blob/master/License.txt[MIT]|The language server client connected to the Monaco editor and used to connect to remote language servers using LSP protocol)
//|https://www.npmjs.com/package/monaco-languageclient[monaco-languageclient]|4.0.3|https://github.com/TypeFox/monaco-languageclient/blob/master/License.txt[MIT]|Language server клієнт, що підключається до Monaco editor та використовується для з'єднання з віддаленими language серверами використовуючи LSP протокол)

|https://www.npmjs.com/package/vscode-languageclient[vscode-languageclient]|8.0.2|https://github.com/Microsoft/vscode-languageserver-node/blob/main/License.txt[MIT]|Transitive dependency with monaco-languageclient
//|https://www.npmjs.com/package/vscode-languageclient[vscode-languageclient]|8.0.2|https://github.com/Microsoft/vscode-languageserver-node/blob/main/License.txt[MIT]|Транзитивна залежність з monaco-languageclient

|https://github.com/eclipse/lsp4j/tree/main/documentation[LSP4J]|0.19| https://github.com/eclipse/lsp4j/blob/main/LICENSE[Eclipse Public License - v 2.0]| Library for managing LS instances. Used to run LS code.
//|https://github.com/eclipse/lsp4j/tree/main/documentation[LSP4J]|0.19| https://github.com/eclipse/lsp4j/blob/main/LICENSE[Eclipse Public License - v 2.0]| Бібліотека для менеджменту екземплярів LS. Використовується для запуску LS коду.

|https://github.com/GroovyLanguageServer/groovy-language-server[Groovy language server] |-| https://github.com/GroovyLanguageServer/groovy-language-server/blob/master/LICENSE[APACHE LICENSE, v2.0]| Implements LSP protocol and performs Groovy code check returning test results in the Json-RPC format
//|https://github.com/GroovyLanguageServer/groovy-language-server[Groovy language server] |-| https://github.com/GroovyLanguageServer/groovy-language-server/blob/master/LICENSE[APACHE LICENSE, v2.0]| Реалізує LSP протокол та виконую перевірку Groovy коду з поверненням результатів перевірки в форматі Json-RPC

|https://github.com/spring-projects/spring-boot[Spring Boot]|2.6.1|https://www.apache.org/licenses/LICENSE-2.0[APACHE LICENSE, v2.0]|Spring Framework extension to simplify the construction of applications based on Spring due to the automatic configuration and spring boot starters
//|https://github.com/spring-projects/spring-boot[Spring Boot]|2.6.1|https://www.apache.org/licenses/LICENSE-2.0[APACHE LICENSE, v2.0]|Розширення до Spring Framework для спрощення побудови аплікацій на базі Spring завдяки автоматичній конфігурації та наявності spring boot стартерів

|https://spring.io/guides/gs/messaging-stomp-websocket/[spring-boot-starter-websocket]|2.6.1|https://www.apache.org/licenses/LICENSE-2.0[APACHE LICENSE, v2.0]|Spring extension for Web Socket management in the server applications (uses https://mvnrepository.com/artifact/org.springframework/spring-websocket/5.3.13[spring-websocket:5.3.13])
//|https://spring.io/guides/gs/messaging-stomp-websocket/[spring-boot-starter-websocket]|2.6.1|https://www.apache.org/licenses/LICENSE-2.0[APACHE LICENSE, v2.0]|Розширення для Spring для менеджменту веб-сокетів в серверних додатках (використовує https://mvnrepository.com/artifact/org.springframework/spring-websocket/5.3.13[spring-websocket:5.3.13])

|===

== Control interface
//== Інтерфейс управління

BPMN.io will be extended with an additional button to call the modal window editing groovy scripts.
//BPMN.io буде розширено додатковою кнопкою визову модального вікна редагування groovy скриптів.

.Business process script editor call window
//.Вікно визову редактору скриптів бізнес-процесів
image::architecture/registry/administrative/regulation-management/bpmnio-groovy-editor/bp-groovy-script-open-window.svg[]

.Script edit window in Monaco Editor
//.Вікно редагування скрипта в Monaco Editor
image::architecture/registry/administrative/regulation-management/bpmnio-groovy-editor/bp-groovy-script-edit-window.png[]

== High level development plan
//== Високорівневий план розробки

=== Required expertise
//===  Необхідні експертизи

- Java
- Javascript
- DevOps
- QA, AQA

==== Backend Java activities

- Create Spring Boot based backend service ddm-language-server.
//- Створити Spring Boot based backend service ddm-language-server
- Develop WebSocket proxy component.
//- Розробити WebSocket proxy component
- Upgrade the LSP4J version to 0.19 for GroovyLanguageServer.
//- Підвищити версію LSP4J до 0.19 для GroovyLanguageServer

==== Javascript activities

- Integration of Monaco Editor into the BPMN.IO business process editor.
//- Інтеграція Monaco editor в BPMN.IO редактор бізнес-процесів
- Monaco Editor integration with ddm-language-server using monaco-languageclient.
//- Інтеграція Monaco-editor з ddm-language-server використовуючи monaco-languageclient

==== DevOps activities

- Onboard https://github.com/GroovyLanguageServer/groovy-language-server: add codebase into gerrit and create pipeline around
- Create deploy-templates and Dockerfile for service ddm-language-server (openjdk based image).
//- Створити deploy-templates та Dockerfile для service ddm-language-server (openjdk based image)
- AdminKong configuration for ddm-language-server traffic. Add websocket proxy headers to the Kong configuration.
//- Конфігурація AdminKong для пропускання трафіку в ddm-language-server. Додати websocket proxy headers в конфігурацію Kong
- Configuring Kong plugins to check the security limits.
//- Конфігурація плагінів Kong для перевірки security лімітів
- Add the `languageServerUrl` variable to `environment-js` with the relative ddm-laguage-server address.
//- Додати в `environment-js` змінну `languageServerUrl` з відносною адресою ddm-laguage-server

== Security
//== Безпека

=== Business data
//=== Бізнес Дані
|===
|Data Category|Description|Privacy|Integrity|Accessibility
//|Категорія Даних|Опис|Конфіденційність|Цілісність|Доступність
|Interim business process data containing open information|Business form and process data that does not contain restricted information|Low|High|Average
//|Проміжні дані бізнес-процесів, що містять відкриту інформацію|Дані бізнес форм та процесів що не містять інформацію з обмеженим доступом|Низька|Висока|Середня
|Operational logs|Lists of recorded/logged calls to the service and its operation logs|Average|High|High
//|Операційні журнали|Списки зафіксованих/залогованих звернень до сервісу та журнали його роботи|Середня|Висока|Висока
|===
=== Simplified threat model
//=== Спрощена модель загроз

image::architecture/registry/administrative/regulation-management/bpmnio-groovy-editor/groovy_TM.svg[]

=== Countermeasures against safety risks and compliance with safety requirements
//=== Механізми протидії ризикам безпеки та відповідність вимогам безпеки

|===
| Risk | Security controls | Implementation | Priority
//| Ризик | Засоби контролю безпеки | Реалізація | Пріорітет
| Breach of data integrity and confidentiality during transmission | Use of HTTPS and WSS | Taken into account in the original design | High
//| Порушення цілісності та конфіденційності даних при передачі | Використання HTTPS та WSS | Враховано в початковому дизайні | Високий
| Unsafe session termination on the server side | During the user initiated exit from the system or in case of the automatic session timeout, any communication with the web socket must be terminated | Not taken into account in the initial design | High
//| Небезпечне завершення сеансу на стороні сервера | Під час виходу з системи ініційованого користувачем або при автоматичному закінченні терміну дії сесії будь-яка комунікація з веб сокетом повинна бути зупинена | Не враховано в початковому дизайні | Високий
| Denial of service due to depletion of computing resources (DoS) caused by the lack of restrictions for web sockets
//| Відмова в обслуговуванні через вичерпання обчислювальних ресурсів (DOS) спричинине відсутністю обмежень для веб сокетів
a|
- Implement the maximum request size limit of 30 kb
//- Впровадження ліміту на максимальний розмір запиту на рівні 30 kb
- Socket timeout: 60s
//- Час очікування сокету: 60s
- Limit the number of open sockets to 10 sockets per user per minute
//- Обмеження кількості відкритих сокетів на рівні 10 сокетів для одного користувача протягом хвилини
|Taken into account in the initial design | High
//|Враховано в початковому дизайні | Високий
| Denial of service due to depletion of computing resources (DoS) caused by the lack of restrictions for the service at the openshift level
//| Відмова в обслуговуванні через вичерпання обчислювальних ресурсів (DOS) спричинине відсутністю обмежень для сервісу на рівні опеншифту
a|
- Limit RAM usage. The limit itself must be calculated after testing.
//- Обмеження споживання оперативної памяті. Сам ліміт повинен бути прорахований після проведення тестування.
- Limit CPU time consumption. The limit itself must be calculated after testing.
//- Обмеження споживання часу процесора. Сам ліміт повинен бути прорахований після проведення тестування.
- Configure the mechanism for restarting the service in case of excessive use of resources.
//- Налаштувати механізм перезапуска сервісу в разі надмірного використання ресурсів.
| Taken into account in the initial design | High
//| Враховано в початковому дизайні | Високий
| Denial of service due to depletion of computing resources (DoS) caused by the lack of restrictions for HTTP requests at the level of the Kong ingress controller
//| Відмова в обслуговуванні через вичерпання обчислювальних ресурсів (DOS) спричинине відсутністю обмежень для HTTP запитів на рівні інгрес контролеру Kong
a|
- The socket limit and the number of requests must be configured separately in the /groovy endpoint. That is, the rate limit plugin for Kong must be set in /groovy
//- Обмеження сокету та кількості запитів має бути налаштований окремо на /groovy ендпоінт. Тобто плагін рейт лімітів для Kong має бути налаштований на /groovy
| Not taken into account in the initial design | High
//| Не враховано в початковому дизайні | Високий
| Risk of backdoor in the language-server component
//| Ризик бекдору у компоненті language-server
a|
- Embed all the necessary resources and language dictionaries to parse AST in the ddm-language-server image to prevent any calls of this service to external sources
//- Вбудувати усі необхідні ресурси та мовні словники для розбору AST в імедж ddm-language-server для запобігання будь-яких звернень цього сервісу до зовнішніх джерел
- Prohibit any communications of the ddm-language-server service with external resources at the level of openshift network policies and allow communications with the logging service and services involved according to the business logics.
//- Заборонити на рівні мережевих політик openshift будь яке спілкування сервісу ddm-language-server з зовнішніми ресурсами і дозволити комунікацію з сервісом логування та сервісами задіяними згідно бізнес логіки.
| Partially taken into account in the initial design. It is required to completely isolate the ddm-language-server service from the external network | High
//| Частково враховано в початковому дизайні. Неодхідно повністю ізолювати сервіс ddm-language-server від зовнішньої мережі | Високий
| Risk of executing vulnerability of interactive information systems (XSS)
//| Ризик виконання вразливості інтерактивних інформаційних систем (XSS)
a|
- CORS settings
//- Налатування CORS
| Taken into account in the initial design | High
//| Враховано в початковому дизайні | Високий
| Risk of disclosing technical information about the system
//| Ризик розкриття технічної інформації про систему
a|
- The service must return a general error in case of problems.
//- Сервіс має віддавати загальну помилку при появі проблем.
- The service must have the "last resort" mechanism that handles any errors that have not been processed before.
//- Сервіс повинен мати механізм "last resort" який опрацює будь-які помилки які не були опрацьовані до цього.
- Make sure the DEBUG mode is off at all levels in the pre-production and production environments.
//- Переконатись що режим DEBUG вимкнений на усіх рівнях у пре-продакшн та продакшн середовищах.
- language-server does not return its version and any technical and/or system information in the HTTP response.
//- language-server не віддає свою версію та будь-яку технічну та/або системну інформацію у HTTP  відповіді.

| Not taken into account in the initial design | Medium
//| Не враховано в початковому дизайні | Середній
| Deserialization of unreliable data
//| Десеріалізація ненадійних даних
a|
- Make sure that there is avoidance of or protection against deserialization of unreliable data both in the developed code and in third-party libraries.
//- Переконатись, що десеріалізація ненадійних даних уникається або захищена як у розробленому коді, так і в бібліотеках сторонніх розробників.
- Make sure that there is a check of the JSON scheme, and it is checked before accepting the entered data.
//- Переконатись, що присутня перевірка схеми JSON та вона перевірена, перш ніж приймати введені дані.
| Not taken into account in the initial design | Medium
//| Не враховано в початковому дизайні | Середній

| Risk of a group of web vulnerabilities and compliance with security requirements
//| Ризик появи групи веб вразливостей та відповідність вимогам безпеки
a|
- Make sure that requests containing unexpected or missing Content Types are rejected by the corresponding headers (status of the HTTP response: 406 Unacceptable, or 415 Unsupported media type).
//- Переконатись, що запити, які містять неочікувані або відсутні Content Types, відхиляються відповідними заголовками (статус відповіді HTTP 406 Неприйнятний або 415 Непідтримуваний тип медіа).
- The web server accepts only approved HTTP methods.
//- Веб сервер приймає тільки затверджені HTTP методи.
- Make sure that the HTTP response has the Content-Type header as well as a safe character set (for example, UTF-8, ISO-8859-1).
//- Переконатись що HTTP відповідь має заголовок Content-Type а також безпечний набір символів (наприклад, UTF-8, ISO-8859-1).
- The web page with Monaco Editor must contain the customized Content Security Policy (CSP) headers.
//- Веб сторінка з Монако редактором має містити налаштовані заголовки Content Security Policy (CSP).
- Monaco Editor web page must contain the X-Content-Type-Options title: nosniff
//- Веб сторінка з Монако редактором має містити заголовок X-Content-Type-Options: nosniff
| Not taken into account in the initial design | Medium
//| Не враховано в початковому дизайні | Середній

| The risk of fixing in the system when exploiting a vulnerability to the system level and subsequent lateral movement. Compliance with the requirements.
//| Ризик закріплення в системі при експлуатації вразливості до системного рівня та подальший бічний рух. Відповідність вимогам.
a|
- The system service must not receive the account service key from openshift (unless it is a requirement), and must be run from a non-privileged system user.
//- Системний сервіс не повинен отримувати ключ сервіс аккаунту від openshift (якщо це не являється вимогою) та повинен бути запущенний від не привілейованого системного користувача.
| Not taken into account in the initial design | Medium
//| Не враховано в початковому дизайні | Середній

| Insufficient logging and safety compliance
//| Недостатнє журналювання та відповідність вимогам безпеки
a|
- The target service must log all requests and send them to a centralized logging and monitoring system.
//- Цільовий сервіс має логувати усі запити та надсилати їх до централізованої системи логування та моніторингу.
- Make sure that all unsuccessful requests and errors arising during operations are logged.
//- Переконатись що усі неуспішні запити та помилки при виконанні операцій будуть залоговані.
- The logging system must use the unified time and time zone.
//- Система логування має використовувати уніфікований час та часову зону.
- Logs must have the unified format and contain all the necessary information for investigation of security incidents.
//- Логи мають бути у уніфікованому форматі та містити усю необхідну інформацію для розслідування інцидентів безпеки.
- Logs must not contain sensitive information, or it must be obfuscated accordingly
//- Логи не мають містити чутливої інформації або вона повинна бути заплутана (obfuscated) відповідним чином
| Not taken into account in the initial design | Low
//| Не враховано в початковому дизайні | Низький

| Misconfiguration of the service and/or framework
//| Місконфігурація сервісу та/або фреймфорку
a|
- Make sure that the server configuration is protected in accordance with the recommendations of the application server and the frameworks used.(web server/app server/framework hardening)
//- Переконатись, що конфігурація сервера захищена відповідно до рекомендацій сервера додатків і фреймворків, які використовуються.(web server/app server/framework hardening)
| Not taken into account in the initial design | Low
//| Не враховано в початковому дизайні | Низький

|===

=== Comprehensive protection measures testing system
//=== Система тестування комплексу засобів захисту (КCЗ)
. The repository with the source code must be onboarded to the vulnerability management system and undergo regular testing.
//. Репозиторій з вихідним кодом повинен бути заонборджений до системи керування вразливостями та проходити регулярне тестування
. The basic image of the service must be scanned and not contain unresolved critical vulnerabilities.
//. Базовий імедж сервісу повинен бути просканований та не містити не вирішенних критичних вразливостей
. The basic image must be placed in a trusted repository controlled by the organization.
//. Базовий імедж повинен бути розміщений в довіреному сховищі підконтрольному організації
. The language-server technology should be added to the list of the used 3rd party products (inventory).
//. Технологія language-server повинна бути додана до переліку 3rd party продуктів які використовуються (inventory)




