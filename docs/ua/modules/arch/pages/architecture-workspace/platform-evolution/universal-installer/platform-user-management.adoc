= Адаптація "Підсистеми управління користувачами та ролями"

[NOTE]
--
В даній статті фіксується обсяг змін що були виконані для реалізації підтримки Платформою регіонів обслуговування.
--

== Опис
Для автентифікації в кабінети надавача та отримувача послуг для глобального регіону використовувати вхід по паролю
замість автентифікації по КЕП та _id.gov.ua__

== Епіки
* _https://jiraeu.epam.com/browse/MDTUDDM-28892[[BN-08-03\][S23\][OSS\] Адаптація "Підсистеми управління користувачами та ролями" згідно налаштованого регіону обслуговування]_

== Функціональні сценарії
* Логін в кабінет надавача послуг
* Логін в кабінет отримувача послуг
* Самореєстрація отримувача послуг при першому вході в кабінет
* Самореєстрація надавача послуг при першому вході в кабінет
* Створення облікових записів надавачів послуг через csv файл

== Зміни в підсистемах
|===

|Підсистема|Компонент|Зміна

.7+|Підсистема управління користувачами та ролями

.6+|Сервіс управління користувачами та ролями (_keycloak_)
|Використання стандартного флоу авторизації по паролю
|Використання _Hardcoded claim_ _attribute mapper_ для додавання фіктивних значень полів _drfo_ та _edrpou_ в токен
авторизації
|Створення та використання окремого _attribute mapper_ для додавання поля _fullName_ в токен авторизації, шляхом конкатенації _firstName_
та _lastName_ користувача
|Налаштування режиму самореєстрації в _keycloak_ (інструкція)
|Додавання системних ролей _officer_ та _citizen_ за замовчуванням на рівні відповідного ріалму (інструкція)
|Вимкнення ідентіті провайдерів на рівні ріалмів

|Сервіс цифрових підписів (_digital_signature_ops_)
|Повне вимкнення (не розгортати) для глобального регіону

|===

== Поза скоупом

|===

|Підсистема|Компонент|Зміна|Коментар

|Підсистема управління Платформою та реєстрами
|Веб-інтерфейс управління Платформою та реєстрами (_control-plane_)
|Вимкнути секції _Дані про ключ_ та _Дані для перевірки підписів_ у налаштуваннях платформи
|У скоупі xref:arch:architecture-workspace/platform-evolution/universal-installer/platform-control-plane.adoc[]

|Підсистема моделювання регламенту реєстру
|Веб-інтерфейс моделювання регламенту (_admin-portal_)
|Вимкнення розділу "Управління користувачами"
|У скоупі xref:arch:architecture-workspace/platform-evolution/universal-installer/regulation-management.adoc[]

|===

== Вплив на підсистеми

|===
|Підсистема|Компонент|Зміна

|Підсистема виконання бізнес-процесів
|Сервіс виконання бізнес-процесів (_bpms_)
|Фіктивні значення атрибутів _edrpou_ та _dfro_ при використанні juel функцій _completer_ та _initiator_

|Підсистема управління даними реєстру
|Операційна БД реєстру (_registry_)
|Зберігання фіктивної інформації про персону, що змінювала запис (фіктивний _dfro_ з авторизаційного токену)

|===

== Перелік git комітів

Для відстеження MR зі змінами використовувати https://gerrit-mdtu-ddm-edp-cicd.apps.cicd2.mdtu-ddm.projects.epam.com/q/status:open+-is:wip+MDTUDDM-28892[фільтр].