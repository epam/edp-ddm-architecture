= Структура конфігурації Платформи

include::configuration-structure-general.adoc[]

[caption=]
.Налаштування Платформи
|===
|Рівень налаштувань|Репозиторій|Шлях|Призначення

.2+|_Платформа_
.2+|`cluster-mgmt`
|`/deploy-templates/values.yaml`
|Загальні налаштування Платформи. Налаштовується адміністратором через адмін-консоль.

|`/deploy-templates/values.gotmpl`
|Містить шаблони та значення за замовчуванням для системних параметрів. У більшості випадків не потребує коригувань.

|===

== Специфікація yaml конфігурації Платформи
У цьому розділі наведено список загальних параметрів налаштувань Платформи.

=== Параметри налаштувань адміністраторів Платформи

`administrators` визначає перелік адміністраторів Платформи.

[[parent-administrators]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.Параметри налаштувань адміністраторів Платформи
|===
|Поле| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`<<administrators,administrators>>`
|object
|&#10007;
|&#10007;
|Вказання переліку користувачів Платформи, що мають роль адміністратора Платформи (`cp-cluster-mgmt-admin`)

|===

[[administrators]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.administrators object | <<parent-administrators,Повернутись на батьківську таблицю>>
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`email`
|string
|&#10007;
|&#10003;
|Адреса електронної пошти, що ідентифікує користувача.

|`firstName`
|string
|&#10007;
|&#10003;
|Імʼя користувача

|`lastName`
|string
|&#10007;
|&#10003;
|Прізвище користувача

|`passwordVaultSecret`
|string
|&#10007;
|&#10003;
|Шлях до тимчасового пароля в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`passwordVaultSecretKey`
|string
|&#10007;
|&#10003;
|Ключ для пошуку тимчасового пароля в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`username`
|string
|&#10007;
|&#10003;
|Імʼя акаунту користувача. Дорівнює полю `email`.

|===

[source,yaml]
.Приклад специфікації налаштування адміністраторів
----
administrators:
    - email: user@company.com
      firstName: user
      lastName: user
      passwordVaultSecret: registry-kv/cluster/user@company.com
      passwordVaultSecretKey: password
      username: user@company.com
----


=== Параметри налаштувань сервісу управління користувачами та ролями

`keycloak` визначає налаштування сервісу управління користувачами та ролями Keycloak.

[[parent-keycloak]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.Параметри сервісу управління користувачами та ролями Keycloak
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<customHosts,keycloak>>`
|object
|&#10007;
|&#10007;
|Загальні налаштування компонента Keycloak.

|===

`keycloak.customHosts` визначає перелік альтернативних DNS-імен для Keycloak.

[[customHosts]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.Параметри альтернативних DNS-імен Keycloak | <<parent-keycloak,Повернутись на батьківську таблицю>>
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<child-customHosts,customHosts>>`
|object
|&#10007;
|&#10007;
|Перелік альтернативних DNS-імен для Keycloak.

|===

[[child-customHosts]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.Параметри альтернативних DNS-імен Keycloak | <<customHosts,Повернутись на батьківську таблицю>>
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`certificatePath`
|string
|&#10007;
|&#10004;
|Шлях до TLS/SSL сертифікату в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`host`
|string
|&#10007;
|&#10004;
|Назва альтернативного DNS-імені.

|===

[source,yaml]
.Приклад специфікації налаштувань сервісу управління користувачами та ролями
----
keycloak:
  customHosts:
    - certificatePath: registry-kv/cluster/domains/example-keycloak.openshift.company.com/20230505T085919Z
      host: example-keycloak.openshift.company.com
----

=== Параметри налаштувань сервісу резервного копіювання та відновлення

.Налаштування сервісу резервного копіювання та відновлення
|===
|Назва|Тип|Значення за замовчуванням|Призначення

|`velero`
|
|-
|

|`velero.backup`
|
|-
|

|`velero.backup.controlPlane`
|
|-
|

|`velero.backup.controlPlane.expires_in_days`
|
|-
|

|`velero.backup.controlPlane.schedule`
|
|-
|

|`velero.backup.controlPlaneNexus`
|
|-
|

|`velero.backup.controlPlaneNexus.expires_in_days`
|
|-
|

|`velero.backup.controlPlaneNexus.schedule`
|
|-
|

|`velero.backup.monitoring`
|
|-
|

|`velero.backup.monitoring.expires_in_days`
|
|-
|

|`velero.backup.monitoring.schedule`
|
|-
|

|`velero.backup.userManagement`
|
|-
|

|`velero.backup.userManagement.expires_in_days`
|
|-
|

|`velero.backup.userManagement.schedule`
|
|-
|

|===

=== Інші параметри

.Інші налаштування
|===
|Назва|Тип|Значення за замовчуванням|Призначення

|`global`
|map
|-
|Глобальні налаштування Платформи.

|`global.deploymentMode`
|string
|development
|Налаштування режиму розгортання Платформи. Визначає наявніть чи відсутність `external-integration-mocks`.

|`global.whiteListIP`
|map
|-
|Налаштування доступу до роутів компонентів Платформи.

|`global.whiteListIP.adminRoutes`
|string
|0.0.0.0/0
|Налаштування доступу до роутів адміністративних компонентів Платформи.

|`cdPipelineName`
|string
|platform
|Назва Платформного CD пайплайну. Є сутністю xref:arch:architecture/platform-technologies.adoc#edp-codebase-operator[EDP] і частиною CI/CD процесу Платформи.

|`cdPipelineStageName`
|string
|main
|Назва етапу Платформного CD пайплайну. Є сутністю xref:arch:architecture/platform-technologies.adoc#edp-codebase-operator[EDP] і частиною CI/CD процесу Платформи.

a|`source_catalog_version`
[WARNING]
====
Застарілий параметр. Буде видалений в наступних версіях Платформи.
====
|string
|4.6
|Вказання версії для ресурсу `CatalogSource` OpenShift OLM оператора.

|consoleVersions
|list
|-
|

|consoleVersions[*].consoleVersion
|string
|-
|

|consoleVersions[*].stream
|string
|-
|

|consoleVersions[*].registryVersion
|string
|-
|

|===
