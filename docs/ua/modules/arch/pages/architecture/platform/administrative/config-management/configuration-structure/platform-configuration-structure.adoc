= Структура конфігурації Платформи

include::configuration-structure-general.adoc[]

[caption=]
.Налаштування Платформи
|===
|Рівень налаштувань|Репозиторій|Шлях|Призначення

.2+|_Платформа_
.2+|`cluster-mgmt`
|`/deploy-templates/values.yaml`
|Загальні налаштування Платформи. Налаштовується адміністратором через адмін-консоль.

|`/deploy-templates/values.gotmpl`
|Містить шаблони та значення за замовчуванням для системних параметрів. У більшості випадків не потребує коригувань.

|===

TIP: Детальніше про процеси розгортання конфігурації див. xref:architecture/platform/administrative/config-management/overview.adoc[] та
xref:architecture/platform/administrative/control-plane/overview.adoc[]

== Специфікація yaml конфігурації Платформи
У цьому розділі наведено список загальних параметрів налаштувань Платформи.

=== Параметри налаштувань адміністраторів Платформи

`administrators` визначає перелік адміністраторів Платформи.
[[parent-administrators]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.Параметри налаштувань адміністраторів Платформи
|===
|Поле| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`<<administrators,administrators>>`
|[]object
|&#10007;
|&#10007;
|Вказання переліку користувачів Платформи, що мають роль адміністратора Платформи (`cp-cluster-mgmt-admin`)

|===

[[administrators]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.administrators object | <<parent-administrators,Повернутись на батьківську таблицю>>
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`email`
|string
|&#10007;
|&#10003;
|Адреса електронної пошти, що ідентифікує користувача.

|`firstName`
|string
|&#10007;
|&#10003;
|Імʼя користувача

|`lastName`
|string
|&#10007;
|&#10003;
|Прізвище користувача

|`passwordVaultSecret`
|string
|&#10007;
|&#10003;
|Шлях до тимчасового пароля в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`passwordVaultSecretKey`
|string
|&#10007;
|&#10003;
|Ключ для пошуку тимчасового пароля в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`username`
|string
|&#10007;
|&#10003;
|Імʼя акаунту користувача. Дорівнює полю `email`.

|===

[source,yaml]
.Приклад специфікації налаштування адміністраторів
----
administrators:
    - email: user@company.com
      firstName: user
      lastName: user
      passwordVaultSecret: registry-kv/cluster/user@company.com
      passwordVaultSecretKey: password
      username: user@company.com
----


=== Параметри налаштувань сервісу управління користувачами та ролями

`keycloak` визначає налаштування сервісу управління користувачами та ролями Keycloak.

[[parent-keycloak]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.Параметри сервісу управління користувачами та ролями Keycloak
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<customHosts,keycloak>>`
|object
|&#10007;
|&#10007;
|Загальні налаштування компонента Keycloak.

|===

`keycloak.customHosts` визначає перелік альтернативних DNS-імен для Keycloak.

[[customHosts]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.Параметри альтернативних DNS-імен Keycloak | <<parent-keycloak,Повернутись на батьківську таблицю>>
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<child-customHosts,customHosts>>`
|[]object
|&#10007;
|&#10007;
|Перелік альтернативних DNS-імен для Keycloak.

|===

[[child-customHosts]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.Параметри альтернативних DNS-імен Keycloak | <<customHosts,Повернутись на батьківську таблицю>>
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`certificatePath`
|string
|&#10007;
|&#10004;
|Шлях до TLS/SSL сертифікату в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`host`
|string
|&#10007;
|&#10004;
|Назва альтернативного DNS-імені.

|===

[source,yaml]
.Приклад специфікації налаштувань сервісу управління користувачами та ролями
----
keycloak:
  customHosts:
    - certificatePath: registry-kv/cluster/domains/example-keycloak.openshift.company.com/20230505T085919Z
      host: example-keycloak.openshift.company.com
----

=== Параметри налаштувань сервісу резервного копіювання та відновлення

`velero` визначає налаштування сервісу резервного копіювання та відновлення.

[[parent-velero]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.Параметри сервісу резервного копіювання та відновлення Velero
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<backup,velero>>`
|object
|&#10007;
|&#10007;
|Налаштування сервісу резервного копіювання Платформи Velero.

|===

[[backup]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.Параметри резервного копіювання та відновлення Платформи | <<parent-velero,Повернутись на батьківську таблицю>>
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<backup-control-plane,backup>>`
|object
|&#10007;
|&#10007;
|Налаштування резервного копіювання Платформних компонентів.

|===

[[backup-control-plane]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.Параметри резервного копіювання та відновлення компонентів Платформи | <<backup,Повернутись на батьківську таблицю>>
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<backup-params,controlPlane>>`
|object
|&#10007;
|&#10007;
|Налаштування резервного копіювання компонентів підсистеми управління Платформою та Реєстрами.

|`<<backup-params,controlPlaneNexus>>`
|object
|&#10007;
|&#10007;
|Налаштування резервного копіювання сховища артефактів Платформи підсистеми розгортання змін налаштувань Платформи та реєстрів.

|`<<backup-params,monitoring>>`
|object
|&#10007;
|&#10007;
|Налаштування резервного копіювання компонентів підсистеми моніторингу та сповіщень Платформи.

|`<<backup-params,userManagement>>`
|object
|&#10007;
|&#10007;
|Налаштування резервного копіювання компонентів підсистеми управління користувачами та ролями Платформи.

|===

[[backup-params]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.Параметри резервного копіювання | <<backup-control-plane,Повернутись на батьківську таблицю>>
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`expires_in_days`
|string
|&#10007;
|&#10007;
|Кількість днів для зберігання резервної копії Платформного сервісу.

|`schedule`
|string
|&#10007;
|&#10007;
|Розклад резервного копіювання. Задається в UNIX cron форматі.

|===

[source,yaml]
.Приклад специфікації налаштувань сервісу резервного копіювання Платформи Velero.
----
velero:
    backup:
        controlPlane:
            expires_in_days: 7
            schedule: 15 9 * * *
        controlPlaneNexus:
            expires_in_days: 7
            schedule: 0 9 * * *
        monitoring:
            expires_in_days: 7
            schedule: 45 9 * * *
        userManagement:
            expires_in_days: 7
            schedule: 30 9 * * *
----

=== Загальні параметри Платформи

[[parent-global]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.Загальні параметри Платформи
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<global,global>>`
|object
|&#10007;
|&#10004;
|Глобальні налаштування Платформи

|`cdPipelineName`
|string
|platform
|&#10004;
|Назва Платформного CD пайплайну. Є сутністю xref:arch:architecture/platform-technologies.adoc#edp-codebase-operator[EDP] і частиною CI/CD процесу Платформи.

|`cdPipelineStageName`
|string
|main
|&#10004;
|Назва етапу Платформного CD пайплайну. Є сутністю xref:arch:architecture/platform-technologies.adoc#edp-codebase-operator[EDP] і частиною CI/CD процесу Платформи.

a|`source_catalog_version`
[WARNING]
====
Застарілий параметр. Буде видалений в наступних версіях Платформи.
====
|string
|4.6
|&#10004;
|Вказання версії для ресурсу `CatalogSource` OpenShift OLM оператора.

|`<<console-versions,consoleVersions>>`
|[]object
|&#10007;
|&#10004;
|Параметри кореляції версії реєстру та версії консолі

|===

[[global]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.Параметри резервного копіювання | <<parent-global,Повернутись на батьківську таблицю>>
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`deploymentMode`
|object
|development
|&#10004;
|Налаштування режиму розгортання Платформи. Визначає наявніть чи відсутність `external-integration-mocks`.

|`<<whitelistip,whiteListIP>>`
|object
|&#10007;
|&#10004;
|Налаштування доступів до Платформних сервісів.

|===

[[whitelistip]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.Параметри резервного копіювання | <<global,Повернутись на батьківську таблицю>>
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`adminRoutes`
|object
|0.0.0.0/0
|&#10004;
|Налаштування доступу до роутів адміністративних сервісів Платформи.

|===

[[console-versions]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.Параметри кореляції версії реєстру та версії консолі | <<parent-global,Повернутись на батьківську таблицю>>
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`consoleVersion`
|object
|&#10007;
|&#10004;
|Версія адмін-консолі

|`stream`
|object
|&#10007;
|&#10004;
|Гілка розгортання консолі

|`registryVersion`
|object
|&#10007;
|&#10004;
|Версія реєстру

|===

NOTE: `consoleVersion` — містить технічні значення та оновлються автоматично разом з Платформою реєстрів, тому змінювати їх немає необхідності.

[source,yaml]
.Приклад специфікації загальних налаштувань Платформи.
----
cdPipelineName: platform
cdPipelineStageName: main
source_catalog_version: 4.6
global:
    deploymentMode: development
    whiteListIP:
        adminRoutes: 0.0.0.0/0
----
