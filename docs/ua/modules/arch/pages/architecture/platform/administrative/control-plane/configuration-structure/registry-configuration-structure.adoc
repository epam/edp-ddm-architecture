= Структура конфігурації Реєстру

[NOTE]
--
Сторінка технічної документації у процесі розробки...
--

include::common/description.adoc[]

[caption=]
.Налаштування реєстру
|===
|Рівень налаштувань|Репозиторій|Шлях|Призначення

.2+|_Реєстр_
.2+|`<registry name>`
|`<<registry-yaml,/deploy-templates/values.yaml>>`
|Загальні налаштування реєстру. Налаштовується адміністратором через адмін-консоль.

|`<<registry-gotmpl,/deploy-templates/values.gotmpl>>`
|Містить шаблони та значення за замовчуванням для системних параметрів реєстру. У більшості випадків не потребує коригувань.

|===

TIP: Детальніше про процеси розгортання конфігурації див. xref:architecture/platform/administrative/config-management/overview.adoc[] та
xref:architecture/platform/administrative/control-plane/overview.adoc[]

== Специфікація yaml конфігурації реєстру (values.yaml)
[[registry-yaml]]
У цьому розділі наведено список загальних параметрів налаштувань реєстру, що задаються адміністраторами через
адмін-консоль або через коміт у відповідний репозиторій.

=== Загальні параметри реєстру
Наступна таблиця містить рутові параметри реєстру.

TIP: Для зручної навігації по ієрархії специфікації обʼєктів, в таблицях присутні посилання на відповідні таблиці.

[[root]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.Загальні параметри реєстру
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<administrators,administrators>>`
|[]object
|❌
|✅
|Вказання переліку користувачів реєстру, що мають роль адміністратора реєстру (`cp-registry-admin-<registry-name>`).

|`<<digital-signature,digitalSignature>>`
|object
|❌
|✅
|Налаштування _сервісу цифрового підпису_ Підсистеми цифрових підписів реєстру.

|`<<digital-documents,digitalDocuments>>`
|object
|❌
|✅
|Налаштування обмежень _сервісу цифрових документів_ на завантаження файлів цифрових документів до реєстру користувачами та бізнес-процесами.

|`<<dso,dso>>`
|object
|❌
|✅
|Налаштування реплік _сервісу цифрового підпису_ Підсистеми цифрових підписів реєстру.

|`<<external-systems,external-systems>>`
|[]object
|❌
|✅
|Налаштування взаємодії з іншими зовнішніми системами.

|`<<global,global>>`
|object
|❌
|✅
|Глобальні налаштування реєстру

|`<<griada,griada>>`
|object
|❌
|✅
|Налаштування програмно-апаратного криптомодуля "Гряда".

|`<<keycloak,keycloak>>`
|object
|❌
|✅
|Налаштування _сервісу управління користувачами та ролями_.

|`<<kongPluginsConfig,kongPluginsConfig>>`
|object
|❌
|✅
|Налаштування плагінів _зовнішнього API-шлюзу операційної зони реєстру_.

|`<<nontrembita-external-registration,nontrembita-external-registration>>`
|[]object
|❌
|✅
|Налаштування плагінів _зовнішнього API-шлюзу операційної зони реєстру_.

|`<<portals,portals>>`
|object
|❌
|✅
|Налаштування кабінетів користувача.

|`<<redash,redash>>`
|object
|❌
|✅
|Налаштування підсистеми аналітичної звітності реєстру.

|`registryVaultPath`
|string
|registry-kv/registry/<registry_name>
|✅
|Шлях до реєстрового Vault Engine в cервісі управління секретами та шифруванням Hashicorp Vault.

|`<<signWidget,signWidget>>`
|object
|❌
|✅
|Налаштування IIT-віджету автентифікації.

|`<<trembita,trembita>>`
|object
|❌
|✅
|Налаштування _шлюзу безпечного обміну "Трембіта"_.

|===

=== Параметри налаштувань сервісу цифрових документів
`digitalDocuments` містить налаштування сервісу цифрових документів.

[[digital-documents]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.digitalDocuments | <<root,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`maxFileSize`
|string
|100MB
|✅
|Максимальний розмір файлу для завантаження, MB

|`maxTotalFileSize`
|string
|100MB
|✅
|Макс. сумарний розмір групи файлів для завантаження, MB

|===

[source,yaml]
.Приклад специфікації налаштування digitalDocuments
----
digitalDocuments:
    maxFileSize: 100MB
    maxTotalFileSize: 100MB
----

=== Параметри налаштувань адміністраторів реєстру
`administrators` містить перелік адміністраторів реєстру.

[[administrators]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.administrators | <<root,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`email`
|string
|❌
|✅
|Адреса електронної пошти, що ідентифікує користувача.

|`firstName`
|string
|❌
|✅
|Імʼя користувача

|`lastName`
|string
|❌
|✅
|Прізвище користувача

|`passwordVaultSecret`
|string
|❌
|✅
|Шлях до тимчасового пароля в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`passwordVaultSecretKey`
|string
|❌
|✅
|Ключ для пошуку тимчасового пароля в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`username`
|string
|❌
|✅
|Імʼя акаунту користувача. Дорівнює полю `email`.

|===

[source,yaml]
.Приклад специфікації налаштування адміністраторів
----
administrators:
    - email: user@company.com
      firstName: user
      lastName: user
      passwordVaultSecret: registry-kv/cluster/user@company.com
      passwordVaultSecretKey: password
      username: user@company.com
----

=== Параметри налаштувань сервісу цифрового підпису реєстру

`digitalSignature` містить перелік налаштувань сервісу цифрового підпису реєстру

[[digital-signature]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.digitalSignature | <<root,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<digital-signature-data,data>>`
|object
|❌
|✅
|Налаштування ключів сервісу цифрового підпису реєстру.

|`<<digital-signature-env,env>>`
|object
|❌
|✅
|Налаштування оточення сервісу цифрового підпису реєстру.

|===

[[digital-signature-data]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.digitalSignature.data | <<digital-signature,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`Key-6-dat`
|string
|❌
|✅
|Шлях до приватного файлового ключа організації в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`allowed-keys-yml`
|string
|❌
|✅
|Шлях до файлу з переліком атрибутів дозволених (або раніше виданих) ключів в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`osplm.ini`
|string
|❌
|✅
|Шлях до конфігураційного файлу програмно-апаратного криптомодуля "Гряда" в _Сервісі управління секретами та шифруванням_ Hashicorp Vault. Використовується тільки з апаратним типом ключа.

|===

[[digital-signature-env]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.digitalSignature.env | <<digital-signature,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`sign.key.device-type`
|string
|❌
|✅
|Визначає тип ключа що використовується реєстром. Допустимі значення `file` або `hardware`.

|`sign.key.file.issuer`
|string
|❌
|✅
|Шлях до інформації про емітента приватного ключа організації. в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`sign.key.file.password`
|string
|❌
|✅
|Шлях до пароля приватного ключа організації. в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`sign.key.hardware.device`
|string
|❌
|✅
|Шлях до інформації про серійний номер, хост та порт апаратного екземпляра Гряди в _Сервісі управління секретами та шифруванням_ Hashicorp Vault. Використовується тільки з апаратним типом ключа.

|`sign.key.hardware.password`
|string
|❌
|✅
|Шлях до пароля апаратного екземпляра Гряди в _Сервісі управління секретами та шифруванням_ Hashicorp Vault. Використовується тільки з апаратним типом ключа.

|`sign.key.hardware.type`
|string
|❌
|✅
|Шлях до типу апаратного екземпляра Гряди в _Сервісі управління секретами та шифруванням_ Hashicorp Vault. Використовується тільки з апаратним типом ключа.

|===

[source,yaml]
.Приклад специфікації налаштування сервісу цифрового підпису реєстру
----
digital-signature:
    data:
        Key-6-dat: registry-kv/registry/<registry_name>/key-management-20231608T063220Z
        allowed-keys-yml: registry-kv/registry/<registry_name>/key-management-20231608T063220Z
        osplm.ini: ""
    env:
        sign.key.device-type: file
        sign.key.file.issuer: registry-kv/registry/<registry_name>/key-management-20231608T063220Z
        sign.key.file.password: registry-kv/registry/<registry_name>/key-management-20231608T063220Z
        sign.key.hardware.device: ""
        sign.key.hardware.password: ""
        sign.key.hardware.type: ""
----

`dso` містить перелік налаштувань кількості реплік сервісу цифрового підпису реєстру

[[dso]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.dso | <<root,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`maxReplicas`
|int
|3
|❌
|Назва для вказання максимальної кількості реплік компонента.

|`minReplicas`
|int
|1
|❌
|Назва для вказання мінімальної кількості реплік компонента.

|===

=== Глобальні параметри налаштувань реєстру

`global` мість глобальні параметри реєстру, що не були класифіковані в окремі розділи.

[[global]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global | <<root,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<computeResources,computeResources>>`
|object
|❌
|✅
|Налаштування віртуальних машин реєстру.

|`deploymentMode`
|string
|development
|✅
|Налаштування режиму розгортання реєстру. Детальніше див. xref:registry-develop:registry-admin/change-dev-prod-mode.adoc[Налаштування режиму розгортання реєстру].

|`<<whitelistip,whiteListIP>>`
|object
|❌
|✅
|Налаштування доступів до реєстрових сервісів.

|`excludePortals`
|[]object
|[""]
|✅
|Перелік користувацьких порталів, що не будуть розгортатись в реєстрі. Доступні значення в переліку `officer-portal`, `citizen-portal` або `admin-portal`.

|`<<bpAdminPortal,bpAdminPortal>>`
|object
|❌
|✅
|Налаштувань користувацького інтерфейсу для перегляду стану виконання та управління бізнес-процесами реєстру.

|`<<crunchyPostgres,crunchyPostgres>>`
|object
|❌
|✅
|Налаштувань підсистеми управління реляційними базами даних.

|`<<kafkaOperator,kafkaOperator>>`
|object
|❌
|✅
|Налаштування підсистеми асинхронного обміну повідомленнями.

|`<<notifications,notifications>>`
|object
|❌
|✅
|Налаштування сповіщень.

|`<<registry,registry>>`
|object
|❌
|✅
|Реєстрові налаштування

|`<<registryBackup,registryBackup>>`
|object
|❌
|✅
|Налаштування резервного копіювання компонентів реєстру.

|`<<regulationManagement,regulationManagement>>`
|object
|❌
|✅
|Налаштування registry regulation management сервісів.

|===

=== Параметри налаштувань реєстрових компонентів.
`registry` містить загальні налаштування реєстрових компонентів.

[[registry]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.registry | <<global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<geoServer,geoServer>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `bpms` реєстру.

|`<<component,bpms>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `bpms` реєстру.

|`<<component,digitalDocumentService>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `digital-document-service` реєстру.

|`<<component,digitalSignatureOps>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `digital-signature-ops` реєстру.

|`<<component-service-generation-utility,kafkaApi>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `registry-kafka-api` реєстру.

|`<<component,kong>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `kong-kong` реєстру.

|`<<component,redis>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `redis` реєстру.

|`<<component-service-generation-utility,restApi>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `registry-rest-api` реєстру.

|`<<component,sentinel>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `redis-sentinel` реєстру.

|`<<component-service-generation-utility,soapApi>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `registry-soap-api` реєстру.

|`<<component,userProcessManagement>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `user-process-management` реєстру.

|`<<component,userTaskManagement>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `user-task-management` реєстру.

|===

[[geoServer]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.registry.geoServer | <<registry,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`enabled`
|bool
|❌
|❌
|Визначає наявніть або відсутність підсистеми управління геоданими.

|===

[[component]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.registry.component | <<registry,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`replicas`
|int
|❌
|❌
|Назва для вказання кількості реплік.

|<<hpa,hpa>>
|object
|❌
|❌
|Назва для вказання налаштування Horizontal Pod Autoscaler для компонента реєстру.

|<<requestslimits,requestsLimits>>
|object
|❌
|❌
|Назва для вказання налаштувань Requests/Limits для компонента реєстру.

|<<istio,istio>>
|object
|❌
|❌
|Назва для вказання налаштування Istio Sidecar для компонента реєстру.

|<<container,container>>
|object
|❌
|❌
|Назва для вказання налаштування ресурсів контейнера компонента реєстру.

|===

[[component-service-generation-utility]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.registry.component | <<registry,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|<<hpa,hpa>>
|object
|❌
|❌
|Назва для вказання налаштування Horizontal Pod Autoscaler для компонента реєстру.

|<<requestslimits,requestsLimits>>
|object
|❌
|❌
|Назва для вказання налаштувань Requests/Limits для компонента реєстру.

|<<istio,istio>>
|object
|❌
|❌
|Назва для вказання налаштування Istio Sidecar для компонента реєстру.

|<<container,container>>
|object
|❌
|❌
|Назва для вказання налаштування ресурсів контейнера компонента реєстру.

|===

[[hpa]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.registry.component.hpa | <<registry,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`enabled`
|bool
|false
|❌
|Назва для вказання, чи має бути налаштоване автоматичне масштабування.

|`minReplicas`
|integer
|1
|❌
|Назва для вказання мінімальної кількості реплік компонента.

|`maxReplicas`
|integer
|3
|❌
|Назва для вказання максимальної кількості реплік компонента.

|===




=== Параметри налаштувань підсистеми резервного копіювання та відновлення.
`registryBackup` містить налаштування підсистеми резервного копіювання та відновлення.

[[registryBackup]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.registryBackup | <<global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`enabled`
|bool
|❌
|❌
|Вмикає або вимикає резервне копіювання реєстру.

|`expiresInDays`
|bool
|❌
|❌
|Визначає кількість днів для зберігання створеної резервної копії реєстру.

|`schedule`
|string
|❌
|❌
|Розклад резервного копіювання реєстру. Задається в UNIX cron форматі.

|`<<obc,obc>>`
|object
|❌
|❌
|Визначає налаштування резервного копіювання S3-бакетів.

|===

[[obc]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.registryBackup.obc | <<registryBackup,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`credentials`
|string
|❌
|❌
|Шлях до токена доступу в S3-бакети в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`cronExpression`
|string
|❌
|❌
|Розклад резервного копіювання S3-бакетів. Задається в UNIX cron форматі.

|===

=== Параметри налаштувань сповіщень.
`notifications` містить налаштування сповіщень реєстру.

[[notifications]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.notifications | <<global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<email,email>>`
|object
|❌
|✅
|Визначає налаштування сервісу поштових повідомлень реєстру

|===

[[email]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.notifications.email | <<notifications,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`type`
|string
|❌
|✅
|Визначає тип поштового сервера використовуємого для відправки повідомлень. Доступні значення `external` або `internal`.

|`address`
|string
|❌
|✅
|Визначає поштову адресу поштового сервера типу `external`.

|`host`
|string
|❌
|✅
|Визначає хост поштового сервера типу `external`.

|`port`
|string
|❌
|✅
|Визначає порт поштового сервера типу `external`.

|`password`
|string
|❌
|✅
|❌ Застарілий параметр. Буде видалений в наступних версіях Платформи.

|`vaultKey`
|string
|❌
|✅
|Ключ для пошуку пароля поштового сервера типу `external` в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`vaultPath`
|string
|❌
|✅
|Шлях до пароля поштового сервера типу `external` в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|===

=== Параметри налаштувань підсистеми асинхронного обміну повідомленнями.
`kafkaOperator` містить налаштування сервісів registry regulation management.

[[kafkaOperator]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.kafkaOperator | <<global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<storage,storage>>`
|object
|❌
|✅
|Налаштування сховища підсистеми асинхронного обміну повідомленнями.

|===

[[storage]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.kafkaOperator.storage | <<kafkaOperator,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<kafka,kafka>>`
|object
|❌
|✅
|Налаштування сховища підсистеми асинхронного обміну повідомленнями.

|===

[[kafka]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.kafkaOperator.storage.kafka | <<storage,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`size`
|string
|20Gi
|✅
|Визначає розмір сховища підсистеми асинхронного обміну повідомленнями.

|===

=== Параметри налаштувань registry regulation management сервісів.
`regulationManagement` містить налаштування сервісів registry regulation management.

[[regulationManagement]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.regulationManagement | <<global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`maxCandidateVersions`
|int
|10
|✅
|Визначає кількість активних версій кандидатів регламенту реєстру.

|===

=== Параметри налаштувань підсистеми управління реляційними базами даних.

`crunchyPostgres` містить налаштування сервісу управління виконанням бізнес-процесів.

[[crunchyPostgres]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.crunchyPostgres | <<global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<backups,backups>>`
|object
|❌
|✅
|Параметри налаштувань резервного копіювання підсистеми управління реляційними базами даних.

|`<<postgresql,postgresql>>`
|object
|❌
|✅
|Параметри налаштувань екземплярів СКБД підсистеми управління реляційними базами даних.

|`storageSize`
|string
|10Gi
|✅
|Визначає розмір сховища екземплярів СКБД підсистеми управління реляційними базами даних.

|===

[[backups]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.crunchyPostgres.backups.pgbackrest | <<crunchyPostgres,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<pgbackrest,pgbackrest>>`
|object
|❌
|✅
|Параметри налаштувань резервного копіювання підсистеми управління реляційними базами даних.

|===

[[pgbackrest]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.crunchyPostgres.backups.pgbackrest.repos | <<backups,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<repos,repos>>`
|object
|❌
|✅
|Параметри налаштувань резервного копіювання підсистеми управління реляційними базами даних.

|===

[[repos]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.crunchyPostgres.backups.pgbackrest.repos.schedules | <<pgbackrest,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<schedules,schedules>>`
|object
|❌
|✅
|Параметри налаштувань розкладу резервного копіювання підсистеми управління реляційними базами даних.

|===



[[schedules]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.crunchyPostgres.backups.pgbackrest.repos.schedules | <<repos,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`full`
|string
|❌
|✅
|Визначає розклад повного резервного копіювання екземплярів СКБД.

|===

[[postgresql]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.crunchyPostgres.postgresql.parameters | <<crunchyPostgres,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<parameters,parameters>>`
|object
|❌
|✅
|Параметри налаштувань резервного копіювання підсистеми управління реляційними базами даних.

|===

[[parameters]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.crunchyPostgres.postgresql.parameters | <<postgresql,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`max_connections`
|string
|200
|✅
|Визначає максимальну кількість одночасних з'єднань з екземпляром СКБД.

|===

=== Параметри налаштувань сервісу управління виконанням бізнес-процесів

`bpAdminPortal` містить налаштування сервісу управління виконанням бізнес-процесів.

[[bpAdminPortal]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.bpAdminPortal | <<global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<camunda,camunda>>`
|object
|❌
|✅
|Параметри налаштувань користувацького інтерфейсу для перегляду стану виконання та управління бізнес-процесами реєстру.

|===

[[camunda]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.bpAdminPortal.camunda | <<bpadmin-portal,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<bpm,bpm>>`
|object
|❌
|✅
|Параметри налаштувань користувацького інтерфейсу для перегляду стану виконання та управління бізнес-процесами реєстру.

|===

[[bpm]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.bpAdminPortal.camunda.bpm | <<camunda,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<metrics,metrics>>`
|object
|❌
|✅
|Параметри налаштувань метрик сервісу перегляду стану виконання та управління бізнес-процесами реєстру.

|===

[[metrics]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.bpAdminPortal.camunda.bpm.metrics | <<bpm,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`enabled`
|bool
|true
|✅
|Визначає чи доступний інтерфейс для збору метрик підсистемою моніторингу подій та сповіщення.

|`scrapeInterval`
|string
|60s
|✅
|Визначає часовий проміжок між зборами метрик підсистемою моніторингу подій та сповіщення.

|===

=== Параметри налаштувань доступів до реєстрових сервісів

`whiteListIP` містить параметри конфігурації доступів до реєстрових сервісів.

[[whitelistip]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.whiteListIP | <<global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`adminRoutes`
|string
|❌
|✅
|Налаштування доступу до роутів адміністративних сервісів реєстру.

|`citizenPortal`
|string
|❌
|✅
|Налаштування доступу до кабінету отримувача послуг.

|`officerPortal`
|string
|❌
|✅
|Налаштування доступу до кабінету надавача послуг.

|===

=== Параметри налаштувань IIT-віджету автентифікації

`signWidget` містить параметри конфігурації IIT-віджету автентифікації.

[[signWidget]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.signWidget | <<root,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`copyFromAuthWidget`
|bool
|false
|✅
|

|`height`
|int
|0
|✅
|Визначає висоту IIT-віджета, px.

|`url`
|string
|❌
|✅
|Визначає посилання на IIT-віджет.

|===

=== Параметри налаштувань віртуальних машин реєстру

`computeResources` містить параметри конфігурації віртуальних машин реєстру.

[[computeResources]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.computeResources | <<global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`instanceCount`
|int
|2
|✅
|Визначає кількість віртуальних машин для розгортання реєстру з типом інфраструктури `AWS` або `vSphere`.

|`awsInstanceType`
|string
|r5.2xlarge
|✅
|Визначає тип AWS EC2-інстансу для розгортання реєстру з типом інфраструктури `AWS`.

|`awsSpotInstance`
|bool
|false
|✅
|Визначає використання типу spot для AWS EC2-інстансу реєстру.

|`awsSpotInstanceMaxPrice`
|string
|❌
|❌
|Визначає максимальну ціну для AWS EC2 spot-інстансу.

|`awsInstanceVolumeType`
|string
|gp3
|✅
|Визначає тип системного диска AWS EC2-інстансу для розгортання реєстру з типом інфраструктури `AWS`.

|`instanceVolumeSize`
|int
|80
|✅
|Визначає розмір системного диска віртуальної машини реєстру з типом інфраструктури `AWS` або `vSphere`.

|`vSphereInstanceCPUCount`
|int
|8
|✅
|Визначає кількість vCPU віртуальної машини реєстру з типом інфраструктури `vSphere`.

|`vSphereInstanceCoresPerCPUCount`
|int
|1
|✅
|Визначає кількість ядер у кожного vCPU віртуальної машини реєстру з типом інфраструктури `vSphere`.

|`vSphereInstanceRAMSize`
|int
|32768
|✅
|Визначає кількість RAM віртуальної машини реєстру з типом інфраструктури `vSphere`.

|===

[source,yaml]
.Приклад конфігурації загальних параметрів реєстру.
----
global:
    bpAdminPortal:
         camunda:
            bpm:
                metrics:
                    enabled: true
                    scrapeInterval: 60s
    crunchyPostgres:
        backups:
            pgbackrest:
                repos:
                    schedules:
                        full: 0 1 * * *
        postgresql:
            parameters:
                max_connections: 200
        storageSize: 10Gi
    deploymentMode: production
    computeResources:
      instanceCount: 3
      awsInstanceType: "r5.2xlarge"
      awsSpotInstance: false
      awsInstanceVolumeType: "gp3"
      awsInstanceVolumeSize: 80
    excludePortals:
        - "admin-portal"
    kafkaOperator:
        storage:
            kafka:
                size: 20Gi
    notifications:
        email:
            type: internal
    registry:
        <component_name>:
            container:
                envVars:
                    JAVA_OPTS: -Xms1536m -Xmx1536m
                resources:
                    limits:
                        cpu: "1"
                        memory: 2Gi
                    requests:
                        cpu: "1"
                        memory: 2Gi
            istio:
                sidecar:
                    enabled: true
                    resources:
                        limits:
                            cpu: 350m
                            memory: 128Mi
                        requests:
                            cpu: 350m
                            memory: 128Mi
        ...
    regulationManagement:
        maxCandidateVersions: 10
    whiteListIP:
        adminRoutes: "192.168.1.64/26 172.16.0.192/27"
        citizenPortal: "0.0.0.0/0"
        officerPortal: "192.168.1.64/26 172.16.0.192/27"
----

=== Параметри налаштувань програмно-апаратного криптомодуля "Гряда"

`griada` містить налаштувань програмно-апаратного криптомодуля "Гряда".

[[griada]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.griada | <<root,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`enabled`
|bool
|true
|✅
|Визначає використання або відсутність апаратного ключа в реєстрі.

|`ip`
|string
|❌
|✅
|Визначає ip-адресу програмно-апаратного криптомодуля "Гряда".

|`port`
|int
|❌
|✅
|Визначає порт програмно-апаратного криптомодуля "Гряда".

|===

[source,yaml]
.Приклад налаштувань програмно-апаратного криптомодуля "Гряда"
----
griada:
  enabled: true
  ip: "10.0.0.23"
  port: 3080
----

=== Параметри реєстрових налаштувань сервісу управління користувачами та ролями

`keycloak` містить перелік налаштувань сервісу управління користувачами та ролями.

=== Параметри реєстрових налаштувань зовнішнього API-шлюзу операційної зони реєстру

`kongPluginsConfig` містить перелік налаштувань зовнішнього API-шлюзу операційної зони реєстру.

[[kongPluginsConfig]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.kongPluginsConfig | <<root,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`pluginsPrometheusBandwidthMetrics`
|bool
|true
|✅
|Налаштування

|`pluginsPrometheusLatencyMetrics`
|bool
|true
|✅
|Налаштування

|`pluginsPrometheusPerConsumerMetrics`
|bool
|true
|✅
|Налаштування

|`pluginsPrometheusStatusCodeMetrics`
|bool
|true
|✅
|Налаштування

|`pluginsProxyCacheTtl`
|int
|900
|✅
|Налаштування

|`pluginsRateLimitByHeaderFaultTolerant`
|bool
|true
|✅
|Налаштування

|`pluginsRateLimitByHeaderHeaderName`
|string
|token-claim
|✅
|Налаштування

|`pluginsRateLimitByHeaderHideClientHeaders`
|bool
|false
|✅
|Налаштування

|`pluginsRateLimitByHeaderPolicy`
|string
|local
|✅
|Налаштування

|`pluginsRateLimitByHeaderRequestsPerHour`
|int
|10000
|✅
|Налаштування

|`pluginsRateLimitByHeaderRequestsPerSecond`
|int
|10
|✅
|Налаштування

|`pluginsRateLimitByIpFaultTolerant`
|bool
|true
|✅
|Налаштування

|`pluginsRateLimitByIpHideClientHeaders`
|bool
|false
|✅
|Налаштування

|`pluginsRateLimitByIpPolicy`
|string
|local
|✅
|Налаштування

|`pluginsRateLimitByIpRequestsPerHour`
|int
|10000
|✅
|Налаштування

|`pluginsRateLimitByIpRequestsPerSecond`
|int
|10
|✅
|Налаштування

|`rateLimitingPluginEnable`
|bool
|false
|✅
|Налаштування

|===

[source,yaml]
.Приклад специфікації налаштуванm зовнішнього API-шлюзу операційної зони реєстру
----
kongPluginsConfig:
    pluginsPrometheusBandwidthMetrics: true
    pluginsPrometheusLatencyMetrics: true
    pluginsPrometheusPerConsumerMetrics: true
    pluginsPrometheusStatusCodeMetrics: true
    pluginsProxyCacheTtl: 900
    pluginsRateLimitByHeaderFaultTolerant: true
    pluginsRateLimitByHeaderHeaderName: token-claim
    pluginsRateLimitByHeaderHideClientHeaders: false
    pluginsRateLimitByHeaderPolicy: local
    pluginsRateLimitByHeaderRequestsPerHour: 10000
    pluginsRateLimitByHeaderRequestsPerSecond: 10
    pluginsRateLimitByIpFaultTolerant: true
    pluginsRateLimitByIpHideClientHeaders: false
    pluginsRateLimitByIpPolicy: local
    pluginsRateLimitByIpRequestsPerHour: 10000
    pluginsRateLimitByIpRequestsPerSecond: 10
    rateLimitingPluginEnable: false
----

=== Параметри налаштувань доступів для реєстрів Платформи та зовнішніх систем

`nontrembita-external-registration` містить перелік налаштувань доступів для реєстрів Платформи та зовнішніх систем.
[[nontrembita-external-registration]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.nontrembita-external-registration | <<root,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`enabled`
|bool
|❌
|❌
|Визначає ввімкнена або вимкнена зовнішня інтеграція.

|`external`
|bool
|❌
|❌
|Визначає тип зовнішньої інтеграції: інший реєстр на Платформі або за межами Платформи.

|`name`
|string
|❌
|❌
|Визначає імʼя зовнішньої системи.

|===

[source,yaml]
.Приклад специфікації налаштування доступів для реєстрів Платформи та зовнішніх систем
----
nontrembita-external-registration:
    - enabled: true
      external: false
      name: example-registry
----

=== Параметри налаштувань шлюзу безпечного обміну "Трембіта"

`trembita` містить перелік налаштувань шлюзу безпечного обміну "Трембіта".
[[trembita]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.trembita | <<root,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`ipList`
|[]object
|❌
|❌
|Визначає перелік IP-адрес ШБО Трембіта, з яких дозволен доступ до `bp-webservice-gateway` та `registry-soap-api`. Пусте значення поля дорівнює відсутності доступу до SOAP API.

|`<<registries,registries>>`
|object
|❌
|✅
|Містить налаштування взаємодію з реєстром через ШБО "Трембіта".

|===

[[registries]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.trembita.registries | <<trembita,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`<<trembita-integration,dracs-registry>>`
|object
|❌
|✅
|Налаштування системної інтеграції з ДРАЦС. Присутня за замовчуванням і недоступна для видалення.

|`<<trembita-integration,edr-registry>>`
|object
|❌
|✅
|Налаштування системної інтеграції з ЄДР. Присутня за замовчуванням і недоступна для видалення.

|`<<trembita-integration,idp-exchange-service-registry>>`
|object
|❌
|✅
|Налаштування системної інтеграції з ЄІБДВПО. Присутня за замовчуванням і недоступна для видалення.

|`<<trembita-integration,<system_name_placeholder> >>`
|object
|❌
|❌
|Параметри іншої зовнішньої системи для інтеграції з реєстром.

|===

[[trembita-integration]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.trembita.registries.<system_name_placeholder> | <<registries,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`<<trembita-auth,auth>>`
|object
|❌
|✅
|Параметри заголовку, що визначають налаштування авторизації.

|`<<trembita-client-service,client>>`
|object
|❌
|✅
|Параметри заголовку, що ідентифікують учасника сервісу.

|`<<trembita-client-service,service>>`
|object
|❌
|✅
|Параметри заголовку, що ідентифікують сервіс.

|`mock`
|bool
|❌
|✅
|Визначає зовнішню систему як реальну, або як заглушку точки інтеграції.

|`protocol`
|string
|SOAP
|✅
|Визначає протокол інтеграційної взаємодії. Дозволені значення `SOAP`.

|`protocol-version`
|string
|❌
|✅
|Визначає версію протоколу, за яким обмінюються повідомленням з ШБО "Трембіта".

|`type`
|string
|❌
|✅
|Визначає `platform` або `registry` тип взаємодії.

|`url`
|string
|❌
|✅
|Визначає хост ШБО "Трембіта"

|`user-id`
|string
|❌
|✅
|Ідентифікатор користувача, що ініціює запит.

|===

[[trembita-auth]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.trembita.registries.<system_name_placeholder>.auth | <<trembita-integration,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`type`
|string
|❌
|✅
|Визначає тип авторизації. Доступні значення `AUTH_TOKEN` або `NO_AUTH`

|`secret`
|string
|❌
|❌
|Шлях до токена авторизації в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|===

[[trembita-client-service]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.trembita.registries.<system_name_placeholder>.client (service) | <<trembita-integration,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`x-road-instance`
|string
|❌
|✅
|Код середовища, що ідентифікує екземпляр сервісу або учасника.

|`member-class`
|string
|❌
|✅
|Ідентифікатор класу сервісу або учасника.

|`member-code`
|string
|❌
|✅
|Ідентифікатор сервісу або учасника.

|`subsystem-code`
|string
|❌
|✅
|Код, що ідентифікує підсистему сервісу або учасника, якщо сервіс надається підсистемою.

|===

[source,yaml]
.Приклад специфікації налаштування шлюзу безпечного обміну "Трембіта".
----
trembita:
    ipList:
      - "192.168.1.34"
      - "192.168.1.152"
    registries:
        dracs-registry:
            auth:
                 type: NO_AUTH
            client:
                member-class: GOV
                member-code: Member_Class
                subsystem-code: IDGOV_EXAMPLE_01
                x-road-instance: SEVDEIR-EXAMPLE
            service:
            mock: false
            protocol: SOAP
            protocol-version: "4.1"
            type: platform
            url: https://trembita.example.com/trembita
            user-id: DDM
        edr-registry:
           ...
        idp-exchange-service-registry:
           ...
----

=== Параметри налаштувань інтеграції з зовнішніми системами

`external-systems` налаштовують інтеграції з зовнішніми системами.
[[external-systems]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.external-systems | <<root,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|<<external-systems-spec,diia>>
|object
|❌
|✅
|Налаштування системної інтеграції з ДіЯ. Присутня за замовчуванням і недоступна для видалення.

|<<external-systems-spec,<system_name_placeholder> >>
|object
|❌
|❌
|Параметри іншої зовнішньої системи для інтеграції з реєстром.

|===

[[external-systems-spec]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.<system_name_placeholder> | <<external-systems,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`protocol`
|string
|❌
|✅
|Визначає протокол інтеграції з зовнішньою системою. Доступне значення `REST`.

|`type`
|string
|❌
|✅
|Визначає `platform` або `registry` тип взаємодії.

|`url`
|string
|❌
|✅
|Визначає адресу зовнішньої системи.

|`mock`
|string
|❌
|✅
|Визначає зовнішню систему як реальну, або як заглушку точки інтеграції.

|`<<external-systems-auth-spec,auth>>`
|object
|❌
|✅
|Визначає налаштування автентифікації з зовнішньою системою.

|===

[[external-systems-auth-spec]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.external-systems.<system_name_placeholder>.auth | <<external-systems-spec,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`secret`
|string
|❌
|✅
|Шлях до токену зовнішньої системи в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`type`
|string
|❌
|✅
|Визначає метод автентифікації з зовнішньою системою. Доступні значення `NO_AUTH`, `AUTH_TOKEN`, `BEARER`, `BASIC`, `AUTH_TOKEN+BEARER`.

|===

=== Параметри налаштувань кабінетів користувачів

`portals` налаштування кабінетів користувачів.
[[portals]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.portals | <<root,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`<<portals-spec,citizen>>`
|object
|❌
|✅
|Налаштування кабінету отримувача послуг.

|`<<portals-spec,officer>>`
|object
|❌
|✅
|Налаштування кабінету надавача послуг.

|===

[[portals-spec]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.portals.<portal_name> | <<root,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`<<customdns-spec,customDns>>`
|object
|❌
|✅
|Налаштування власних DNS-імен для кабінетів користувачів.

|`<<signwidget-spec,signWidget>>`
|object
|❌
|✅
|Налаштування IIT-віджету авторизації для кабінетів користувачів.

|===

[[customdns-spec]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.portals.<portal_name>.customDns | <<portals-spec,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`enabled`
|bool
|❌
|✅
|Визначає наявніть або відсутність заданого власного DNS-імені для кабінету.

|`host`
|string
|❌
|❌
|Визначає хост власного DNS-імені для кабінету.

|===

[[signwidget-spec]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.portals.<portal_name>.signWidget | <<portals-spec,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`url`
|string
|❌
|✅
|Визначає посилання на віджет автентифікації.

|`height`
|object
|❌
|✅
|Визначає візуальну висоту віджету автентифікації.

|`copyFromAuthWidget`
|bool
|❌
|✅
|

|===

== Специфікація технічної yaml конфігурації реєстру (values.gotmpl)
[[registry-gotmpl]]

IMPORTANT: Власноруч вносити зміни в цей файл не рекомендується.
