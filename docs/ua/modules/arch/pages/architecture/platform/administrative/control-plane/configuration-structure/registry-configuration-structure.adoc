= Структура конфігурації Реєстру

include::common/description.adoc[]

[caption=]
.Налаштування реєстру
|===
|Рівень налаштувань|Репозиторій|Шлях|Призначення

.2+|_Реєстр_
.2+|`<registry name>`
|`<<registry-yaml,/deploy-templates/values.yaml>>`
|Загальні налаштування реєстру. Налаштовується адміністратором через адмін-консоль.

|`<<registry-gotmpl,/deploy-templates/values.gotmpl>>`
|Містить шаблони та значення за замовчуванням для системних параметрів реєстру. У більшості випадків не потребує коригувань.

|===

TIP: Детальніше про процеси розгортання конфігурації див. xref:architecture/platform/administrative/config-management/overview.adoc[] та
xref:architecture/platform/administrative/control-plane/overview.adoc[]

== Специфікація yaml конфігурації реєстру (values.yaml)
[[registry-yaml]]
У цьому розділі наведено список загальних параметрів налаштувань реєстру, що налаштовуються адміністраторами через адмін-консоль або через коміт в репозиторій.

=== Параметри налаштувань сервісу цифрових документів
`digitalDocuments` містить налаштування сервісу цифрових документів.
[[parent-digital-documents]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.Параметри налаштувань сервісу цифрових документів
|===
|Поле| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`<<digital-documents,digitalDocuments>>`
|object
|❌
|✅
|Налаштування обмежень _сервісу цифрових документів_ на завантаження файлів цифрових документів до реєстру користувачами та бізнес-процесами.

|===

[[digital-documents]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.digitalDocuments | <<parent-digital-documents,Повернутись на батьківську таблицю>>
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`maxFileSize`
|string
|100MB
|✅
|Максимальний розмір файлу для завантаження, MB

|`maxTotalFileSize`
|string
|100MB
|✅
|Макс. сумарний розмір групи файлів для завантаження, MB

|===

[source,yaml]
.Приклад специфікації налаштування digitalDocuments
----
digitalDocuments:
    maxFileSize: 100MB
    maxTotalFileSize: 100MB
----

=== Параметри налаштувань адміністраторів реєстру
`administrators` містить перелік адміністраторів реєстру.
[[parent-administrators]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.Параметри налаштувань адміністраторів реєстру
|===
|Поле| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`<<administrators,administrators>>`
|[]object
|❌
|✅
|Вказання переліку користувачів реєстру, що мають роль адміністратора Платформи (`cp-registry-admin-<registry-name>`).

|===

[[administrators]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.administrators | <<parent-administrators,Повернутись на батьківську таблицю>>
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`email`
|string
|❌
|✅
|Адреса електронної пошти, що ідентифікує користувача.

|`firstName`
|string
|❌
|✅
|Імʼя користувача

|`lastName`
|string
|❌
|✅
|Прізвище користувача

|`passwordVaultSecret`
|string
|❌
|✅
|Шлях до тимчасового пароля в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`passwordVaultSecretKey`
|string
|❌
|✅
|Ключ для пошуку тимчасового пароля в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`username`
|string
|❌
|✅
|Імʼя акаунту користувача. Дорівнює полю `email`.

|===

[source,yaml]
.Приклад специфікації налаштування адміністраторів
----
administrators:
    - email: user@company.com
      firstName: user
      lastName: user
      passwordVaultSecret: registry-kv/cluster/user@company.com
      passwordVaultSecretKey: password
      username: user@company.com
----

=== Параметри налаштувань сервісу цифрового підпису реєстру

`digitalSignature` містить перелік налаштувань сервісу цифрового підпису реєстру
[[parent-digital-signature]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.Параметри налаштувань сервісу цифрового підпису реєстру
|===
|Поле| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`<<digital-signature,digitalSignature>>`
|object
|❌
|✅
|Налаштування _сервісу цифрового підпису_ Підсистеми цифрових підписів реєстру.

|===

[[digital-signature]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.digitalSignature | <<parent-digital-signature,Повернутись на батьківську таблицю>>
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<digital-signature-data,data>>`
|object
|❌
|✅
|Налаштування ключів сервісу цифрового підпису реєстру.

|`<<digital-signature-env,env>>`
|object
|❌
|✅
|Налаштування оточення сервісу цифрового підпису реєстру.

|===

[[digital-signature-data]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.data | <<digital-signature,Повернутись на батьківську таблицю>>
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`Key-6-dat`
|string
|❌
|✅
|Шлях до приватного файлового ключа організації в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`allowed-keys-yml`
|string
|❌
|✅
|Шлях до файлу з переліком атрибутів дозволених (або раніше виданих) ключів в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`osplm.ini`
|string
|❌
|✅
|Шлях до конфігураційного файлу програмно-апаратного криптомодуля "Гряда" в _Сервісі управління секретами та шифруванням_ Hashicorp Vault. Використовується тільки з апаратним типом ключа.

|===

[[digital-signature-env]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.env | <<digital-signature,Повернутись на батьківську таблицю>>
|===
|Поле|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`sign.key.device-type`
|string
|❌
|✅
|Визначає тип ключа що використовується реєстром. Допустимі значення `file` або `hardware`.

|`sign.key.file.issuer`
|string
|❌
|✅
|Шлях до інформації про емітента приватного ключа організації. в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`sign.key.file.password`
|string
|❌
|✅
|Шлях до пароля приватного ключа організації. в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`sign.key.hardware.device`
|string
|❌
|✅
|Шлях до інформації про серійний номер, хост та порт апаратного екземпляра Гряди в _Сервісі управління секретами та шифруванням_ Hashicorp Vault. Використовується тільки з апаратним типом ключа.

|`sign.key.hardware.password`
|string
|❌
|✅
|Шлях до пароля апаратного екземпляра Гряди в _Сервісі управління секретами та шифруванням_ Hashicorp Vault. Використовується тільки з апаратним типом ключа.

|`sign.key.hardware.type`
|string
|❌
|✅
|Шлях до типу апаратного екземпляра Гряди в _Сервісі управління секретами та шифруванням_ Hashicorp Vault. Використовується тільки з апаратним типом ключа.

|===

[source,yaml]
.Приклад специфікації налаштування сервісу цифрового підпису реєстру
----
digital-signature:
    data:
        Key-6-dat: registry-kv/registry/<registry_name>/key-management-20231608T063220Z
        allowed-keys-yml: registry-kv/registry/<registry_name>/key-management-20231608T063220Z
        osplm.ini: ""
    env:
        sign.key.device-type: file
        sign.key.file.issuer: registry-kv/registry/<registry_name>/key-management-20231608T063220Z
        sign.key.file.password: registry-kv/registry/<registry_name>/key-management-20231608T063220Z
        sign.key.hardware.device: ""
        sign.key.hardware.password: ""
        sign.key.hardware.type: ""
----

== Специфікація технічної yaml конфігурації реєстру (values.gotmpl)
[[registry-gotmpl]]

IMPORTANT: Власноруч вносити зміни в цей файл не рекомендується.
