= Структура конфігурації Реєстру

include::common/description.adoc[]

[caption=]
.Налаштування реєстру
|===
|Рівень налаштувань|Репозиторій|Шлях|Призначення

.2+|_Реєстр_
.2+|`<registry name>`
|`<<registry-yaml,/deploy-templates/values.yaml>>`
|Загальні налаштування реєстру. Налаштовується адміністратором через адмін-консоль.

|`<<registry-gotmpl,/deploy-templates/values.gotmpl>>`
|Містить шаблони та значення за замовчуванням для системних параметрів реєстру. У більшості випадків не потребує коригувань.

|===

TIP: Детальніше про процеси розгортання конфігурації див. xref:architecture/platform/administrative/config-management/overview.adoc[] та
xref:architecture/platform/administrative/control-plane/overview.adoc[]

== Специфікація yaml конфігурації реєстру (values.yaml)
[[registry-yaml]]
У цьому розділі наведено список загальних параметрів налаштувань реєстру, що задаються адміністраторами через
адмін-консоль або через коміт у відповідний репозиторій.

=== Загальні параметри реєстру
Наступна таблиця містить рутові параметри реєстру.

TIP: Для зручної навігації по ієрархії специфікації обʼєктів, в таблицях присутні посилання на відповідні дочерні таблиці.

[[root]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.Загальні параметри реєстру
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<administrators,administrators>>`
|[]object
|❌
|✅
|Вказання переліку користувачів реєстру, що мають роль адміністратора реєстру (`cp-registry-admin-<registry-name>`).

|`<<digital-signature,digitalSignature>>`
|object
|❌
|✅
|Налаштування _сервісу цифрового підпису_ Підсистеми цифрових підписів реєстру.

|`<<digital-documents,digitalDocuments>>`
|object
|❌
|✅
|Налаштування обмежень _сервісу цифрових документів_ на завантаження файлів цифрових документів до реєстру користувачами та бізнес-процесами.

|`<<dso,dso>>`
|object
|❌
|✅
|Налаштування реплік _сервісу цифрового підпису_ Підсистеми цифрових підписів реєстру.

|`<<external-systems,external-systems>>`
|[]object
|❌
|✅
|Налаштування взаємодії з іншими зовнішніми системами.

|`<<global,global>>`
|object
|❌
|✅
|Глобальні налаштування реєстру

|`<<griada,griada>>`
|object
|❌
|✅
|Налаштування програмно-апаратного криптомодуля "Гряда".

|`<<keycloak,keycloak>>`
|object
|❌
|✅
|Налаштування _сервісу управління користувачами та ролями_.

|`<<kongPluginsConfig,kongPluginsConfig>>`
|object
|❌
|✅
|Налаштування плагінів _зовнішнього API-шлюзу операційної зони реєстру_.

|`<<nontrembita-external-registration,nontrembita-external-registration>>`
|[]object
|❌
|✅
|Налаштування плагінів _зовнішнього API-шлюзу операційної зони реєстру_.

|`<<portals,portals>>`
|object
|❌
|✅
|Налаштування кабінетів користувача.

|`<<redash,redash>>`
|object
|❌
|✅
|Налаштування підсистеми аналітичної звітності реєстру.

|`registryVaultPath`
|string
|registry-kv/registry/<registry_name>
|✅
|Шлях до реєстрового Vault Engine в cервісі управління секретами та шифруванням Hashicorp Vault.

|`<<signWidget,signWidget>>`
|object
|❌
|✅
|Налаштування IIT-віджету автентифікації.

|`<<trembita,trembita>>`
|object
|❌
|❌
|Налаштування _шлюзу безпечного обміну "Трембіта"_.

|===

=== Параметри налаштувань сервісу цифрових документів
`digitalDocuments` містить налаштування сервісу цифрових документів.

[[digital-documents]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.digitalDocuments | <<root,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`maxFileSize`
|string
|100MB
|✅
|Максимальний розмір файлу для завантаження, MB

|`maxTotalFileSize`
|string
|100MB
|✅
|Макс. сумарний розмір групи файлів для завантаження, MB

|===

[source,yaml]
.Приклад специфікації налаштування digitalDocuments
----
digitalDocuments:
    maxFileSize: 100MB
    maxTotalFileSize: 100MB
----

=== Параметри налаштувань адміністраторів реєстру
`administrators` містить перелік адміністраторів реєстру.

[[administrators]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.administrators | <<root,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`email`
|string
|❌
|✅
|Адреса електронної пошти, що ідентифікує користувача.

|`firstName`
|string
|❌
|✅
|Імʼя користувача

|`lastName`
|string
|❌
|✅
|Прізвище користувача

|`passwordVaultSecret`
|string
|❌
|✅
|Шлях до тимчасового пароля в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`passwordVaultSecretKey`
|string
|❌
|✅
|Ключ для пошуку тимчасового пароля в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`username`
|string
|❌
|✅
|Імʼя акаунту користувача. Дорівнює полю `email`.

|===

[source,yaml]
.Приклад специфікації налаштування адміністраторів
----
administrators:
    - email: user@company.com
      firstName: user
      lastName: user
      passwordVaultSecret: registry-kv/cluster/user@company.com
      passwordVaultSecretKey: password
      username: user@company.com
----

=== Параметри налаштувань сервісу управління користувачами та ролями

`keycloak` містить перелік налаштувань сервісу управління користувачами та ролями.

[[keycloak]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.keycloak | <<root,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<authFlows,authFlows>>`
|object
|❌
|✅
|Налаштування сутності `AuthFlow` в Keycloak.

|`<<citizenAuthFlow,citizenAuthFlow>>`
|object
|❌
|✅
|Налаштування сутності `AuthFlow` в Keycloak для кабінету отримувача послуг.

|`customHost`
|string
|❌
|❌
|Визначає keycloak хост з попередньо доданих на рівні Платформи для використання при автентифікації.

|`<<identityProviders,identityProviders>>`
|object
|❌
|✅
|Налаштування ідентифікаційних провайдерів в Keycloak.

|`<<realms,realms>>`
|object
|❌
|✅
|Налаштування сутності `Realm` в Keycloak.

|===

[[authFlows]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.keycloak.authFlows | <<keycloak,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<authFlows-spec,officerAuthFlow>>`
|object
|❌
|✅
|Налаштування сутності `AuthFlow` в Keycloak для кабінету надавача послуг.

|===

[[citizenAuthFlow]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.keycloak.citizenAuthFlow | <<keycloak,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`authType`
|string
|❌
|✅
|Визначає можливість використовувати власний віджет автентифікації або налаштувати інтеграцію з id.gov.ua.

|`edrCheck`
|bool
|❌
|✅
|Визначає ввімкнена або вимкнена перевірка наявності активного запису в ЄДР для бізнес-користувачів.

|`<<idGovUa,registryIdGovUa>>`
|bool
|❌
|✅
|Налаштування ідентифікаційного провайдера id.gov.ua

|`<<widget,widget>>`
|bool
|❌
|✅
|Налаштування виджету авторизації.

|===

[[widget]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.keycloak.citizenAuthFlow.widget | <<keycloak,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`height`
|string
|❌
|✅
|Визначає висоту віджету автентифікації.

|`url`
|string
|❌
|✅
|Визначає посилання на віджет автентифікації.

|===

[[identityProviders]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.keycloak.identityProviders | <<keycloak,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<idGovUa,idGovUa>>`
|object
|❌
|✅
|Налаштування ідентифікаційного провайдера id.gov.ua

|===

[[idGovUa]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.keycloak.identityProviders.idGovUa | <<identityProviders,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`clientId`
|string
|❌
|✅
|Визначає клієнтський ідентифікатор.

|`secretKey`
|string
|❌
|✅
|Визначає шлях в _Сервісі управління секретами та шифруванням_ Hashicorp Vault до секрету клієнта що був зареєстрований в id.gov.ua.

|`url`
|string
|❌
|✅
|Визначає посилання для id.gov.ua

|===

[[authFlows-spec]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.keycloak.authFlows.officerAuthFlow | <<authFlows,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`widgetHeight`
|string
|720
|✅
|Визначає висоту віджету автентифікації.

|===

[[realms]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.keycloak.realms | <<keycloak,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<officerPortal,officerPortal>>`
|object
|❌
|✅
|Визначає налаштування рілму автентифікації кабінету надавача послуг.

|===

[[officerPortal]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.keycloak.realms.officerPortal | <<realms,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`browserFlow`
|string
|dso-officer-auth-flow
|✅
|Визначає назву використовуємого AuthFlow.

|`selfRegistration`
|bool
|❌
|✅
|Визначає можливість автоматичного створення облікового запису при першому логіні користувача.

|===

[source,yaml]
----
keycloak:
    authFlows:
        officerAuthFlow:
            widgetHeight: 720
    citizenAuthFlow:
        authType: widget
        edrCheck: true
        registryIdGovUa: {}
        widget:
            height: 720
            url: https://example.com/sign-widget
    customHost: "dns-keycloak.openshift.example.com"
    identityProviders:
        idGovUa:
            clientId: ""
            secretKey: ""
            url: ""
    realms:
        officerPortal:
            browserFlow: dso-officer-auth-flow
            selfRegistration: false
----

=== Параметри налаштувань сервісу цифрового підпису реєстру

`digitalSignature` містить перелік налаштувань сервісу цифрового підпису реєстру

[[digital-signature]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.digitalSignature | <<root,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<digital-signature-data,data>>`
|object
|❌
|✅
|Налаштування ключів сервісу цифрового підпису реєстру.

|`<<digital-signature-env,env>>`
|object
|❌
|✅
|Налаштування оточення сервісу цифрового підпису реєстру.

|===

[[digital-signature-data]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.digitalSignature.data | <<digital-signature,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`Key-6-dat`
|string
|❌
|✅
|Шлях до приватного файлового ключа організації в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`allowed-keys-yml`
|string
|❌
|✅
|Шлях до файлу з переліком атрибутів дозволених (або раніше виданих) ключів в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`osplm.ini`
|string
|❌
|✅
|Шлях до конфігураційного файлу програмно-апаратного криптомодуля "Гряда" в _Сервісі управління секретами та шифруванням_ Hashicorp Vault. Використовується тільки з апаратним типом ключа.

|===

[[digital-signature-env]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.digitalSignature.env | <<digital-signature,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`sign.key.device-type`
|string
|❌
|✅
|Визначає тип ключа що використовується реєстром. Допустимі значення `file` або `hardware`.

|`sign.key.file.issuer`
|string
|❌
|✅
|Шлях до інформації про емітента приватного ключа організації. в _Сервісі управління секретами та шифруванням_ Hashicorp Vault. Використовується, коли `sign.key.device-type` = `file`

|`sign.key.file.password`
|string
|❌
|✅
|Шлях до пароля приватного ключа організації. в _Сервісі управління секретами та шифруванням_ Hashicorp Vault. Використовується, коли `sign.key.device-type` = `file`

|`sign.key.hardware.device`
|string
|❌
|✅
|Опис носія ключової інформації (НКІ) згідно з описами ІІТ в _Сервісі управління секретами та шифруванням_ Hashicorp Vault. Використовується, коли `sign.key.device-type` = `hardware`

|`sign.key.hardware.password`
|string
|❌
|✅
|Шлях до пароля апаратного екземпляра Гряди в _Сервісі управління секретами та шифруванням_ Hashicorp Vault. Використовується, коли `sign.key.device-type` = `hardware`

|`sign.key.hardware.type`
|string
|❌
|✅
|Шлях до типу апаратного екземпляра Гряди в _Сервісі управління секретами та шифруванням_ Hashicorp Vault. Використовується, коли `sign.key.device-type` = `hardware`

|===

[source,yaml]
.Приклад специфікації налаштування сервісу цифрового підпису реєстру
----
digital-signature:
    data:
        Key-6-dat: registry-kv/registry/<registry_name>/key-management-20231608T063220Z
        allowed-keys-yml: registry-kv/registry/<registry_name>/key-management-20231608T063220Z
        osplm.ini: ""
    env:
        sign.key.device-type: file
        sign.key.file.issuer: registry-kv/registry/<registry_name>/key-management-20231608T063220Z
        sign.key.file.password: registry-kv/registry/<registry_name>/key-management-20231608T063220Z
        sign.key.hardware.device: ""
        sign.key.hardware.password: ""
        sign.key.hardware.type: ""
----

`dso` містить перелік налаштувань кількості реплік сервісу цифрового підпису реєстру

[[dso]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.dso | <<root,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`maxReplicas`
|int
|3
|❌
|Максимальна кількість реплік компонента.

|`minReplicas`
|int
|1
|❌
|Мінімальна кількість реплік компонента.

|===

[source,yaml]
.Приклад специфікації налаштування сервісу цифрового підпису реєстру
----
dso:
  maxReplicas: 3
  minReplicas: 1
----

=== Глобальні параметри налаштувань реєстру

`global` мість глобальні параметри реєстру, що не були класифіковані в окремі розділи.

[[global]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global | <<root,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<computeResources,computeResources>>`
|object
|❌
|✅
|Налаштування віртуальних машин реєстру.

|`deploymentMode`
|string
|development
|✅
|Налаштування режиму розгортання реєстру. Детальніше див. xref:registry-develop:registry-admin/change-dev-prod-mode.adoc[Налаштування режиму розгортання реєстру].

|`<<whitelistip,whiteListIP>>`
|object
|❌
|❌
|Налаштування доступів до реєстрових сервісів.

|`excludePortals`
|[]object
|[""]
|❌
|Перелік користувацьких порталів, що не будуть розгортатись в реєстрі. Доступні значення в переліку `officer-portal`, `citizen-portal` або `admin-portal`.

|`<<bpAdminPortal,bpAdminPortal>>`
|object
|❌
|✅
|Налаштувань користувацького інтерфейсу для перегляду стану виконання та управління бізнес-процесами реєстру.

|`<<crunchyPostgres,crunchyPostgres>>`
|object
|❌
|✅
|Налаштувань підсистеми управління реляційними базами даних.

|`<<kafkaOperator,kafkaOperator>>`
|object
|❌
|✅
|Налаштування підсистеми асинхронного обміну повідомленнями.

|`<<notifications,notifications>>`
|object
|❌
|✅
|Налаштування сповіщень.

|`<<registry,registry>>`
|object
|❌
|✅
|Реєстрові налаштування.

|`<<registryBackup,registryBackup>>`
|object
|❌
|❌
|Налаштування резервного копіювання компонентів реєстру.

|`<<regulationManagement,regulationManagement>>`
|object
|❌
|✅
|Налаштування registry regulation management сервісів.

|===

=== Параметри налаштувань реєстрових компонентів.
`registry` містить загальні налаштування реєстрових компонентів.

[[registry]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.registry | <<global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<geoServer,geoServer>>`
|object
|❌
|✅
|Визначає загальні налаштування компонента `bpms` реєстру.

|`<<component,bpms>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `bpms` реєстру.

|`<<component,digitalDocumentService>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `digital-document-service` реєстру.

|`<<component,digitalSignatureOps>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `digital-signature-ops` реєстру.

|`<<component,kafkaApi>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `registry-kafka-api` реєстру.

|`<<component,kong>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `kong-kong` реєстру.

|`<<component,redis>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `redis` реєстру.

|`<<component,restApi>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `registry-rest-api` реєстру.

|`<<component,sentinel>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `redis-sentinel` реєстру.

|`<<component,soapApi>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `registry-soap-api` реєстру.

|`<<component,userProcessManagement>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `user-process-management` реєстру.

|`<<component,userTaskManagement>>`
|object
|❌
|❌
|Визначає загальні налаштування компонента `user-task-management` реєстру.

|===

[[geoServer]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.registry.geoServer | <<registry,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`enabled`
|bool
|❌
|✅
|Визначає наявніть або відсутність підсистеми управління геоданими.

|===

[[component]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.registry.component | <<registry,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`replicas`
|int
|❌
|❌
|Налаштування кількості реплік.

|<<hpa,hpa>>
|object
|❌
|❌
|Налаштування Horizontal Pod Autoscaler для компонента реєстру.

|<<requestslimits,requestsLimits>>
|object
|❌
|❌
|Налаштування Requests/Limits для компонента реєстру.

|<<istio,istio>>
|object
|❌
|❌
|Налаштування Istio Sidecar для компонента реєстру.

|<<container,container>>
|object
|❌
|❌
|Налаштування ресурсів контейнера компонента реєстру.

|===

[[hpa]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.registry.component.hpa | <<registry,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`enabled`
|bool
|false
|❌
|Визначає ввімкнене чи вимкнене автоматичне масштабування.

|`minReplicas`
|integer
|1
|❌
|Визначає мінімальну кількість реплік компонента.

|`maxReplicas`
|integer
|3
|❌
|Визначає максимальну кількість реплік компонента.

|===

=== Параметри налаштувань підсистеми резервного копіювання та відновлення.
`registryBackup` містить налаштування підсистеми резервного копіювання та відновлення.

[[registryBackup]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.registryBackup | <<global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`enabled`
|bool
|❌
|❌
|Вмикає або вимикає резервне копіювання реєстру.

|`expiresInDays`
|int
|❌
|❌
|Визначає кількість днів для зберігання створеної резервної копії реєстру.

|`schedule`
|string
|❌
|❌
|Розклад резервного копіювання реєстру. Задається в UNIX cron форматі.

|`<<obc,obc>>`
|object
|❌
|❌
|Визначає налаштування резервного копіювання S3-бакетів.

|===

[[obc]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.registryBackup.obc | <<registryBackup,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`credentials`
|string
|❌
|❌
|Шлях до токена доступу в S3-бакети в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`cronExpression`
|string
|❌
|❌
|Розклад резервного копіювання S3-бакетів. Задається в UNIX cron форматі.

|`endpoint`
|string
|❌
|❌
|Визначає хост до S3-бакета.

|`backupBucket`
|string
|❌
|❌
|Визначає назву S3-бакету для резервної копії.

|===

=== Параметри налаштувань сповіщень.
`notifications` містить налаштування сповіщень реєстру.

[[notifications]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.notifications | <<global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<email,email>>`
|object
|❌
|✅
|Визначає налаштування сервісу поштових повідомлень реєстру

|===

[[email]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.notifications.email | <<notifications,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`type`
|string
|❌
|✅
|Визначає тип поштового сервера використовуємого для відправки повідомлень. Доступні значення `external` або `internal`.

|`address`
|string
|❌
|✅
|Визначає поштову адресу поштового сервера типу `external`.

|`host`
|string
|❌
|✅
|Визначає хост поштового сервера типу `external`.

|`port`
|string
|❌
|✅
|Визначає порт поштового сервера типу `external`.

|`password`
|string
|❌
|✅
|❌ Застарілий параметр. Буде видалений в наступних версіях Платформи.

|`vaultKey`
|string
|❌
|✅
|Ключ для пошуку пароля поштового сервера типу `external` в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|`vaultPath`
|string
|❌
|✅
|Шлях до пароля поштового сервера типу `external` в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|===

=== Параметри налаштувань підсистеми асинхронного обміну повідомленнями.
`kafkaOperator` містить налаштування сервісів registry regulation management.

[[kafkaOperator]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.kafkaOperator | <<global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<storage,storage>>`
|object
|❌
|✅
|Налаштування сховища підсистеми асинхронного обміну повідомленнями.

|===

[[storage]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.kafkaOperator.storage | <<kafkaOperator,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<kafka,kafka>>`
|object
|❌
|✅
|Налаштування сховища підсистеми асинхронного обміну повідомленнями.

|===

[[kafka]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.kafkaOperator.storage.kafka | <<storage,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`size`
|string
|20Gi
|✅
|Визначає розмір сховища підсистеми асинхронного обміну повідомленнями.

|===

=== Параметри налаштувань registry regulation management сервісів.
`regulationManagement` містить налаштування сервісів registry regulation management.

[[regulationManagement]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.regulationManagement | <<global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`maxCandidateVersions`
|int
|10
|✅
|Визначає максимальну кількість активних версій кандидатів регламенту реєстру.

|===

=== Параметри налаштувань підсистеми управління реляційними базами даних.

`crunchyPostgres` містить налаштування сервісу управління виконанням бізнес-процесів.

[[crunchyPostgres]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.crunchyPostgres | <<global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<schedules,backups.pgbackrest.repos.schedules>>`
|object
|❌
|✅
|Параметри налаштувань резервного копіювання підсистеми управління реляційними базами даних.

|`<<postgresql,postgresql>>`
|object
|❌
|✅
|Параметри налаштувань екземплярів СКБД підсистеми управління реляційними базами даних.

|`storageSize`
|string
|10Gi
|✅
|Визначає розмір сховища екземплярів СКБД підсистеми управління реляційними базами даних.

|===

[[schedules]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.crunchyPostgres.backups.pgbackrest.repos.schedules | <<crunchyPostgres,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`full`
|string
|❌
|✅
|Визначає розклад повного резервного копіювання екземплярів СКБД.

|===

[[postgresql]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.crunchyPostgres.postgresql.parameters | <<crunchyPostgres,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<parameters,parameters>>`
|object
|❌
|✅
|Параметри налаштувань резервного копіювання підсистеми управління реляційними базами даних.

|===

[[parameters]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.crunchyPostgres.postgresql.parameters | <<postgresql,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`max_connections`
|string
|200
|✅
|Визначає максимальну кількість одночасних з'єднань з екземпляром СКБД.

|===

=== Параметри налаштувань сервісу управління виконанням бізнес-процесів

`bpAdminPortal` містить налаштування сервісу управління виконанням бізнес-процесів.

[[bpAdminPortal]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.bpAdminPortal | <<global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<metrics,camunda.bpm.metrics>>`
|object
|❌
|✅
|Параметри налаштувань користувацького інтерфейсу для перегляду стану виконання та управління бізнес-процесами реєстру.

|===

[[metrics]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.bpAdminPortal.camunda.bpm.metrics | <<bpAdminPortal,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`enabled`
|bool
|true
|✅
|Визначає чи доступний інтерфейс для збору метрик підсистемою моніторингу подій та сповіщення.

|`scrapeInterval`
|string
|60s
|✅
|Визначає часовий проміжок між зборами метрик підсистемою моніторингу подій та сповіщення.

|===

=== Параметри налаштувань доступів до реєстрових сервісів

`whiteListIP` містить параметри конфігурації доступів до реєстрових сервісів.

[[whitelistip]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.whiteListIP | <<global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`adminRoutes`
|string
|❌
|✅
|Налаштування доступу до роутів адміністративних сервісів реєстру.

|`citizenPortal`
|string
|❌
|✅
|Налаштування доступу до кабінету отримувача послуг.

|`officerPortal`
|string
|❌
|✅
|Налаштування доступу до кабінету надавача послуг.

|===

=== Параметри налаштувань IIT-віджету автентифікації

`signWidget` містить параметри конфігурації IIT-віджету автентифікації.

[[signWidget]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.signWidget | <<root,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`copyFromAuthWidget`
|bool
|false
|✅
|

|`height`
|int
|0
|✅
|Визначає висоту IIT-віджета, px.

|`url`
|string
|❌
|✅
|Визначає посилання на IIT-віджет.

|===

=== Параметри налаштувань віртуальних машин реєстру

`computeResources` містить параметри конфігурації віртуальних машин реєстру.

[[computeResources]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.global.computeResources | <<global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`instanceCount`
|int
|2
|✅
|Визначає кількість віртуальних машин для розгортання реєстру з типом інфраструктури `AWS` або `vSphere`.

|`awsInstanceType`
|string
|r5.2xlarge
|✅
|Визначає тип AWS EC2-інстансу для розгортання реєстру з типом інфраструктури `AWS`.

|`awsSpotInstance`
|bool
|false
|✅
|Визначає використання типу spot для AWS EC2-інстансу реєстру.

|`awsSpotInstanceMaxPrice`
|string
|❌
|❌
|Визначає максимальну ціну для AWS EC2 spot-інстансу.

|`awsInstanceVolumeType`
|string
|gp3
|✅
|Визначає тип системного диска AWS EC2-інстансу для розгортання реєстру з типом інфраструктури `AWS`.

|`instanceVolumeSize`
|int
|80
|✅
|Визначає розмір системного диска віртуальної машини реєстру з типом інфраструктури `AWS` або `vSphere`.

|`vSphereInstanceCPUCount`
|int
|8
|✅
|Визначає кількість vCPU віртуальної машини реєстру з типом інфраструктури `vSphere`.

|`vSphereInstanceCoresPerCPUCount`
|int
|1
|✅
|Визначає кількість ядер у кожного vCPU віртуальної машини реєстру з типом інфраструктури `vSphere`.

|`vSphereInstanceRAMSize`
|int
|32768
|✅
|Визначає кількість RAM віртуальної машини реєстру з типом інфраструктури `vSphere`.

|===

[source,yaml]
.Приклади конфігурації загальних параметрів реєстру — bpAdminPortal.
----
global:
    bpAdminPortal:
         camunda:
            bpm:
                metrics:
                    enabled: true
                    scrapeInterval: 60s
----

[source,yaml]
.Приклади конфігурації загальних параметрів реєстру — crunchyPostgres.
----
global:
    crunchyPostgres:
        backups:
            pgbackrest:
                repos:
                    schedules:
                        full: 0 1 * * *
        postgresql:
            parameters:
                max_connections: 200
        storageSize: 10Gi
----

[source,yaml]
.Приклади конфігурації загальних параметрів реєстру — computeResources.
----
global:
    computeResources:
      instanceCount: 3
      awsInstanceType: "r5.2xlarge"
      awsSpotInstance: false
      awsInstanceVolumeType: "gp3"
      awsInstanceVolumeSize: 80
----

[source,yaml]
.Приклади конфігурації загальних параметрів реєстру — kafkaOperator.
----
global:
    kafkaOperator:
        storage:
            kafka:
                size: 20Gi
----

[source,yaml]
.Приклади конфігурації загальних параметрів реєстру — notifications.
----
global:
    notifications:
        email:
            type: internal
----

[source,yaml]
.Приклади конфігурації загальних параметрів реєстру — registry.
----
global:
    registry:
        <component_name>:
            container:
                envVars:
                    JAVA_OPTS: -Xms1536m -Xmx1536m
                resources:
                    limits:
                        cpu: "1"
                        memory: 2Gi
                    requests:
                        cpu: "1"
                        memory: 2Gi
            istio:
                sidecar:
                    enabled: true
                    resources:
                        limits:
                            cpu: 350m
                            memory: 128Mi
                        requests:
                            cpu: 350m
                            memory: 128Mi
----

[source,yaml]
.Приклади конфігурації загальних параметрів реєстру.
----
global:
    deploymentMode: production
    excludePortals:
        - "admin-portal"
    regulationManagement:
        maxCandidateVersions: 10
    whiteListIP:
        adminRoutes: "192.168.1.64/26 172.16.0.192/27"
        citizenPortal: "0.0.0.0/0"
        officerPortal: "192.168.1.64/26 172.16.0.192/27"
----

=== Параметри налаштувань програмно-апаратного криптомодуля "Гряда"

`griada` містить налаштувань програмно-апаратного криптомодуля "Гряда".

[[griada]]
[cols="20%,10%,5%,5%,60%",options="header",caption=]
.griada | <<root,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`enabled`
|bool
|true
|✅
|Визначає використання або відсутність апаратного ключа в реєстрі.

|`ip`
|string
|❌
|✅
|Визначає ip-адресу програмно-апаратного криптомодуля "Гряда".

|`port`
|int
|❌
|✅
|Визначає порт програмно-апаратного криптомодуля "Гряда".

|===

[source,yaml]
.Приклад налаштувань програмно-апаратного криптомодуля "Гряда"
----
griada:
  enabled: true
  ip: "10.0.0.23"
  port: 3080
----

=== Параметри реєстрових налаштувань сервісу управління користувачами та ролями

`keycloak` містить перелік налаштувань сервісу управління користувачами та ролями.

=== Параметри реєстрових налаштувань зовнішнього API-шлюзу операційної зони реєстру

`kongPluginsConfig` містить перелік налаштувань зовнішнього API-шлюзу операційної зони реєстру.

[[kongPluginsConfig]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.kongPluginsConfig | <<root,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`pluginsPrometheusBandwidthMetrics`
|bool
|true
|✅
|Налаштування

|`pluginsPrometheusLatencyMetrics`
|bool
|true
|✅
|Налаштування

|`pluginsPrometheusPerConsumerMetrics`
|bool
|true
|✅
|Налаштування

|`pluginsPrometheusStatusCodeMetrics`
|bool
|true
|✅
|Налаштування

|`pluginsProxyCacheTtl`
|int
|900
|✅
|Налаштування

|`pluginsRateLimitByHeaderFaultTolerant`
|bool
|true
|✅
|Налаштування

|`pluginsRateLimitByHeaderHeaderName`
|string
|token-claim
|✅
|Налаштування

|`pluginsRateLimitByHeaderHideClientHeaders`
|bool
|false
|✅
|Налаштування

|`pluginsRateLimitByHeaderPolicy`
|string
|local
|✅
|Налаштування

|`pluginsRateLimitByHeaderRequestsPerHour`
|int
|10000
|✅
|Налаштування

|`pluginsRateLimitByHeaderRequestsPerSecond`
|int
|10
|✅
|Налаштування

|`pluginsRateLimitByIpFaultTolerant`
|bool
|true
|✅
|Налаштування

|`pluginsRateLimitByIpHideClientHeaders`
|bool
|false
|✅
|Налаштування

|`pluginsRateLimitByIpPolicy`
|string
|local
|✅
|Налаштування

|`pluginsRateLimitByIpRequestsPerHour`
|int
|10000
|✅
|Налаштування

|`pluginsRateLimitByIpRequestsPerSecond`
|int
|10
|✅
|Налаштування

|`rateLimitingPluginEnable`
|bool
|false
|✅
|Налаштування

|===

[source,yaml]
.Приклад специфікації налаштуванm зовнішнього API-шлюзу операційної зони реєстру
----
kongPluginsConfig:
    pluginsPrometheusBandwidthMetrics: true
    pluginsPrometheusLatencyMetrics: true
    pluginsPrometheusPerConsumerMetrics: true
    pluginsPrometheusStatusCodeMetrics: true
    pluginsProxyCacheTtl: 900
    pluginsRateLimitByHeaderFaultTolerant: true
    pluginsRateLimitByHeaderHeaderName: token-claim
    pluginsRateLimitByHeaderHideClientHeaders: false
    pluginsRateLimitByHeaderPolicy: local
    pluginsRateLimitByHeaderRequestsPerHour: 10000
    pluginsRateLimitByHeaderRequestsPerSecond: 10
    pluginsRateLimitByIpFaultTolerant: true
    pluginsRateLimitByIpHideClientHeaders: false
    pluginsRateLimitByIpPolicy: local
    pluginsRateLimitByIpRequestsPerHour: 10000
    pluginsRateLimitByIpRequestsPerSecond: 10
    rateLimitingPluginEnable: false
----

=== Параметри налаштувань доступів для реєстрів Платформи та зовнішніх систем

`nontrembita-external-registration` містить перелік налаштувань доступів для реєстрів Платформи та зовнішніх систем.
[[nontrembita-external-registration]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.nontrembita-external-registration | <<root,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`enabled`
|bool
|❌
|❌
|Визначає ввімкнена або вимкнена зовнішня інтеграція.

|`external`
|bool
|❌
|❌
|Визначає тип зовнішньої інтеграції: інший реєстр на Платформі або за межами Платформи.

|`name`
|string
|❌
|❌
|Визначає імʼя зовнішньої системи.

|===

[source,yaml]
.Приклад специфікації налаштування доступів для реєстрів Платформи та зовнішніх систем
----
nontrembita-external-registration:
    - enabled: true
      external: false
      name: example-registry
----

=== Параметри налаштувань шлюзу безпечного обміну "Трембіта"

`trembita` містить перелік налаштувань шлюзу безпечного обміну "Трембіта".
[[trembita]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.trembita | <<root,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`ipList`
|[]object
|❌
|❌
|Визначає перелік IP-адрес ШБО Трембіта, з яких дозволен доступ до `bp-webservice-gateway` та `registry-soap-api`. Пусте значення поля дорівнює відсутності доступу до SOAP API.

|`<<registries,registries>>`
|object
|❌
|✅
|Містить налаштування взаємодію з реєстром через ШБО "Трембіта".

|===

[[registries]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.trembita.registries | <<trembita,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`<<trembita-integration,dracs-registry>>`
|object
|❌
|✅
|Налаштування системної інтеграції з ДРАЦС. Присутня за замовчуванням і недоступна для видалення.

|`<<trembita-integration,edr-registry>>`
|object
|❌
|✅
|Налаштування системної інтеграції з ЄДР. Присутня за замовчуванням і недоступна для видалення.

|`<<trembita-integration,idp-exchange-service-registry>>`
|object
|❌
|✅
|Налаштування системної інтеграції з ЄІБДВПО. Присутня за замовчуванням і недоступна для видалення.

|`<<trembita-integration,<system_name_placeholder> >>`
|object
|❌
|❌
|Параметри іншої зовнішньої системи для інтеграції з реєстром.

|===

[[trembita-integration]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.trembita.registries.<system_name_placeholder> | <<registries,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`<<trembita-auth,auth>>`
|object
|❌
|✅
|Параметри заголовку, що визначають налаштування авторизації.

|`<<trembita-client,client>>`
|object
|❌
|✅
|Параметри заголовку, що ідентифікують учасника сервісу.

|`<<trembita-service,service>>`
|object
|❌
|✅
|Параметри заголовку, що ідентифікують сервіс.

|`mock`
|bool
|❌
|✅
|Визначає зовнішню систему як реальну, або як заглушку точки інтеграції.

|`protocol`
|string
|SOAP
|✅
|Визначає протокол інтеграційної взаємодії. Дозволені значення `SOAP`.

|`protocol-version`
|string
|❌
|✅
|Визначає версію протоколу, за яким обмінюються повідомленням з ШБО "Трембіта".

|`type`
|string
|❌
|✅
|Визначає `platform` або `registry` тип взаємодії.

|`url`
|string
|❌
|✅
|Визначає хост ШБО "Трембіта"

|`user-id`
|string
|❌
|✅
|Ідентифікатор користувача, що ініціює запит.

|===

[[trembita-auth]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.trembita.registries.<system_name_placeholder>.auth | <<trembita-integration,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`type`
|string
|❌
|✅
|Визначає тип авторизації. Доступні значення `AUTH_TOKEN` або `NO_AUTH`

|`secret`
|string
|❌
|❌
|Шлях до токена авторизації в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.

|===

[[trembita-client]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.trembita.registries.<system_name_placeholder>.client | <<trembita-integration,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`x-road-instance`
|string
|❌
|✅
|Код середовища, що ідентифікує екземпляр сервісу або учасника.

|`member-class`
|string
|❌
|✅
|Ідентифікатор класу сервісу або учасника.

|`member-code`
|string
|❌
|✅
|Ідентифікатор сервісу або учасника.

|`subsystem-code`
|string
|❌
|✅
|Код, що ідентифікує підсистему сервісу або учасника, якщо сервіс надається підсистемою.

|===

[[trembita-service]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.trembita.registries.<system_name_placeholder>.service | <<trembita-integration,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`x-road-instance`
|string
|❌
|✅
|Код середовища, що ідентифікує екземпляр сервісу або учасника.

|`member-class`
|string
|❌
|✅
|Ідентифікатор класу сервісу або учасника.

|`member-code`
|string
|❌
|✅
|Ідентифікатор сервісу або учасника.

|`subsystem-code`
|string
|❌
|✅
|Код, що ідентифікує підсистему сервісу або учасника, якщо сервіс надається підсистемою.

|`service-code`
|string
|❌
|❌
|Код, що ідентифікує підсистему сервісу або учасника, якщо сервіс надається підсистемою.

|`service-version`
|string
|❌
|❌
|Код, що ідентифікує підсистему сервісу або учасника, якщо сервіс надається підсистемою.

|===

[source,yaml]
.Приклад специфікації налаштування шлюзу безпечного обміну "Трембіта".
----
trembita:
    ipList:
      - "192.168.1.34"
      - "192.168.1.152"
    registries:
        dracs-registry:
            auth:
                 type: NO_AUTH
            client:
                member-class: GOV
                member-code: Member_Class
                subsystem-code: IDGOV_EXAMPLE_01
                x-road-instance: SEVDEIR-EXAMPLE
            service:
            mock: false
            protocol: SOAP
            protocol-version: "4.1"
            type: platform
            url: https://trembita.example.com/trembita
            user-id: DDM
        edr-registry:
           ...
        idp-exchange-service-registry:
           ...
----

=== Параметри налаштувань інтеграції з зовнішніми системами

`external-systems` налаштовують інтеграції з зовнішніми системами.
[[external-systems]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.external-systems | <<root,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|<<external-systems-spec,diia>>
|object
|❌
|✅
|Налаштування системної інтеграції з ДіЯ. Присутня за замовчуванням і недоступна для видалення.

|<<external-systems-spec,<system_name_placeholder> >>
|object
|❌
|❌
|Параметри іншої зовнішньої системи для інтеграції з реєстром.

|===

TIP: `<system_name_placeholder>` — буде замінений на назву зовнішньої системи задану через адмін-консоль.

[[external-systems-spec]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.<system_name_placeholder> | <<external-systems,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`protocol`
|string
|❌
|✅
|Визначає протокол інтеграції з зовнішньою системою. Доступне значення `REST`.

|`type`
|string
|❌
|✅
|Визначає `platform` або `registry` тип взаємодії.

|`url`
|string
|❌
|✅
|Визначає адресу зовнішньої системи.

|`mock`
|string
|❌
|✅
|Визначає зовнішню систему як реальну, або як заглушку точки інтеграції.

|`<<external-systems-auth-spec,auth>>`
|object
|❌
|✅
|Визначає налаштування автентифікації з зовнішньою системою.

|===

[[external-systems-auth-spec]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.external-systems.<system_name_placeholder>.auth | <<external-systems-spec,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`secret`
|string
|❌
|❌
|Шлях до токену зовнішньої системи в _Сервісі управління секретами та шифруванням_ Hashicorp Vault.


|`type`
|string
|❌
|✅
|Визначає метод автентифікації з зовнішньою системою. Доступні значення `NO_AUTH`, `AUTH_TOKEN`, `BEARER`, `BASIC`, `AUTH_TOKEN+BEARER`.

|===

[source,yaml]
.Приклад специфікації налаштування сервісу цифрового підпису реєстру
----
external-systems:
    example-system-1:
        auth:
            secret: vault:registry-kv/registry/<registry_name>/external-systems
            type: BASIC
        protocol: REST
        type: registry
        url: https://example.com.ua
    example-system-N:
        auth:
            secret: vault:registry-kv/registry/<registry_name>/external-systems
            type: BASIC
        protocol: REST
        type: registry
        url: https://example.com.ua
    diia:
        protocol: REST
        type: platform
----

=== Параметри налаштувань кабінетів користувачів

`portals` налаштування кабінетів користувачів.
[[portals]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.portals | <<root,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`<<portals-spec,citizen>>`
|object
|❌
|✅
|Налаштування кабінету отримувача послуг.

|`<<portals-spec,officer>>`
|object
|❌
|✅
|Налаштування кабінету надавача послуг.

|===

[[portals-spec]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.portals.<portal_name> | <<root,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`<<customdns-spec,customDns>>`
|object
|❌
|❌
|Налаштування власних DNS-імен для кабінетів користувачів.

|`<<signwidget-spec,signWidget>>`
|object
|❌
|✅
|Налаштування IIT-віджету авторизації для кабінетів користувачів.

|===

[[customdns-spec]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.portals.<portal_name>.customDns | <<portals-spec,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`enabled`
|bool
|❌
|✅
|Визначає наявніть або відсутність заданого власного DNS-імені для кабінету.

|`host`
|string
|❌
|❌
|Визначає хост власного DNS-імені для кабінету.

|===

[[signwidget-spec]]
[cols="20%,15%,7%,7%,60%",options="header",caption=]
.portals.<portal_name>.signWidget | <<portals-spec,Повернутись на батьківську таблицю>>
|===
|Назва| **Тип** | **Значення за замовчуванням** | **Обовʼязкове** | **Призначення**

|`url`
|string
|❌
|✅
|Визначає посилання на віджет автентифікації.

|`height`
|object
|❌
|✅
|Визначає візуальну висоту віджету автентифікації.

|`copyFromAuthWidget`
|bool
|❌
|✅
|

|===

== Специфікація технічної yaml конфігурації реєстру (values.gotmpl)
[[registry-gotmpl]]

У цьому розділі наведено список технічних параметрів реєстру. Їх значення встановлюються з використанням шаблонів для
параметризації, що може мати вигляд `{{ env "<variable_name>" }}` — для визначення значення зі змінних оточення або виду
`{{ $cluster_version := exec ... }}` — для виконання команди під час запуску пайплайну.

IMPORTANT: Власноруч вносити зміни в цей файл не рекомендується.

[[parent-tech-params]]
[cols="20%,15%,10%,10%,60%",options="header",caption=]
.Технічні параметри реєстру
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<tech-global,global>>`
|object
|❌
|✅
|Глобальні налаштування реєстру

|`<<vault,vault>>`
|object
|❌
|✅
|Містить налаштування центрального сервісу управління секретами реєстру.

|`<<s3,s3>>`
|object
|❌
|✅
|Містить налаштування S3-клієнту для взаємодії з S3 сховищем.

|`<<platform,platform>>`
|object
|❌
|✅
|Містить налаштування реєстру.

|`namespace`
|string
|❌
|✅
|Визначає зі специфікації `codebase` назву OKD namespace для розгортання компонентів підсистем та налаштувань в залежності від приналежності до реєстру.

|`baseDomain`
|string
|❌
|✅
|Отримує та встановлює базовий домен кластера OKD. Усі керовані записи DNS в кластері будуть піддоменами цього базового домену.
Після розгортання кластера OKD, це значення не можна змінювати. Наприклад, `openshift.example.com`.

|`dnsWildcard`
|string
|❌
|✅
|Піддомен базового домена кластера OKD для маршрутизації трафіку до застосунків Платформи та реєстрів. Наприклад, `apps.openshift.example.com`

|`cdPipelineName`
|string
|❌
|✅
|Назва Платформного CD пайплайну. Є сутністю xref:arch:architecture/platform-technologies.adoc#edp-codebase-operator[EDP] і частиною обслуговуючого пайплайну процесів розгортання реєстру.

|`dockerRegistry`
|string
|❌
|✅
|Містить URL до `control-plane-nexus` — сховища артефактів Платформи.

|`dockerProxyRegistry`
|string
|❌
|✅
|Містить URL до `control-plane-nexus` — сховища артефактів Платформи.

|`edpProject`
|string
|❌
|✅
|Визначає з параметрів технічного пайплайну назву OKD namespace для розгортання компонентів підсистем та налаштувань в
залежності від приналежності до Платформи або реєстру.

|`stageName`
|string
|❌
|✅
|Назва етапу реєстрового CD пайплайну. Є сутністю EDP і частиною обслуговуючого пайплайну процесів розгортання реєстру.

|`stageName`
|string
|❌
|✅
|Назва етапу реєстрового CD пайплайну. Є сутністю EDP і частиною обслуговуючого пайплайну процесів розгортання реєстру.

|===

[[tech-global]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.global | <<parent-tech-params,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`clusterVersion`
|string
|❌
|✅
|Автоматично визначає поточну версію OKD кластеру.

|`storageClass`
|string
|ocs-storagecluster-ceph-rbd
|✅
|Містить назву `StorageClass` що використовується в кластерів OKD за замовчуванням.

|`imageRegistry`
|string
|❌
|✅
|Містить URL до `control-plane-nexus` — сховища артефактів Платформи.

|`<<nexus,nexus>>`
|object
|❌
|✅
|❌ Застарілий параметр. Буде видалений в наступних версіях Платформи.

|`<<jenkins,jenkins>>`
|object
|❌
|✅
|❌ Застарілий параметр. Буде видалений в наступних версіях Платформи.

|`<<gerrit,gerrit>>`
|object
|❌
|✅
|❌ Застарілий параметр. Буде видалений в наступних версіях Платформи.

|`<<tech-kafka,kafkaOperator>>`
|object
|❌
|✅
|Налаштування підсистеми асинхронного обміну повідомленнями.

|`<<crunchyPostgresOperator,crunchyPostgresOperator>>`
|object
|❌
|✅
|Параметри налаштувань підсистеми управління реляційними базами даних.

|`<<tech-registry,registry>>`
|object
|❌
|✅
|Містить реєстрові налаштування.

|`<<tech-notifications,notifications>>`
|object
|❌
|✅
|Містить загальні налаштування підсистеми поштових повідомлень.

|`disableRequestsLimits`
|bool
|false
|✅
|❌ Застарілий параметр. Буде видалений в наступних версіях Платформи.

|===

[[tech-registry]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.global.registry | <<tech-global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<tech-registry-redis,redis>>`
|object
|❌
|✅
|Налаштування Redis.

|`<<tech-registry-sentinel,sentinel>>`
|object
|❌
|✅
|Налаштування Redis Sentinel.

|===

[[tech-registry-redis]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.global.registry.redis | <<tech-registry,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`replicas`
|string
|❌
|✅
|Визначає кількість екземплярів Redis.

|`<<tech-registry-redis-container,container>>`
|string
|❌
|✅
|Визначає налаштування контейнерів екземплярів Redis.

|===

[[tech-registry-redis-container]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.global.registry.redis.container | <<tech-registry-redis,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`customConfig`
|[]object
|["maxmemory 500m"]
|✅
|Визначає додаткові налаштування для Redis контейнера.

|===

[[tech-registry-sentinel]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.global.registry.sentinel | <<tech-registry,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`replicas`
|string
|❌
|✅
|Визначає кількість екземплярів Sentinel.

|===

[[tech-notifications]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.global.notifications | <<tech-global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<tech-notifications-email,email>>`
|object
|❌
|✅
|Містить налаштування підсистеми поштових повідомлень.

|===

[[tech-notifications-email]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.global.notifications.email | <<tech-notifications,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`password`
|string
|❌
|✅
|Визначає SMTP-пароль до підсистеми поштових повідомлень.

|===

[[crunchyPostgresOperator]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.global.crunchyPostgresOperator | <<tech-global,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<instances,instances>>`
|object
|❌
|✅
|Містить налаштування екземплярів підсистеми управління реляційними базами даних.

|`<<minioConf,minioConf>>`
|object
|❌
|✅
|Містить налаштування сховища резервних копій підсистеми управління реляційними базами даних.

|===

[[instances]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.global.crunchyPostgresOperator.instances | <<crunchyPostgresOperator,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<replicas,operational>>`
|object
|❌
|✅
|Містить налаштування операційних екземплярів БД підсистеми управління реляційними базами даних.

|`<<replicas,analytical>>`
|object
|❌
|✅
|Містить налаштування аналітичних екземплярів БД підсистеми управління реляційними базами даних.

|===

[[replicas]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.global.crunchyPostgresOperator.instances.operational (analytical) | <<instances,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`replicas`
|int
|❌
|✅
|Визначає кількість екземплярів відповідних БД підсистеми управління реляційними базами даних.

|===

[[minioConf]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.global.crunchyPostgresOperator.minioConf | <<crunchyPostgresOperator,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`endpoint`
|string
|❌
|✅
|Містить налаштування сховища сервісу асинхронного обміну повідомленнями.

|`bucketName`
|string
|❌
|✅
|Містить налаштування сховища сервісу асинхронного обміну повідомленнями.

|===

[[tech-kafka]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.global.kafkaOperator | <<parent-tech-params,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<kafka-storage,storage>>`
|object
|❌
|✅
|Містить налаштування сховища сервісу асинхронного обміну повідомленнями.

|`kafkaBrokers`
|int
|3
|✅
|Визначає кількість екземплярів Kafka брокерів.

|`zookeepers`
|int
|3
|✅
|Визначає кількість екземплярів Zookeepers.

|`replicationFactor`
|int
|3
|✅
|Налаштовує фактор реплікації Kafka що визначає кількість копій даних, які зберігаються в кількох брокерах Kafka.

|`kafkaCentralNamespace`
|string
|❌
|✅
|Визначає namespace компонента Kafka.

|===

[[kafka-storage]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.kafkaOperator.storage | <<tech-kafka,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<kafka-storage-zookeper,zookeeper>>`
|object
|❌
|✅
|Містить налаштування Kafka Zookeeper.

|===

[[kafka-storage-zookeper]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.kafkaOperator.storage.zookeeper | <<kafka-storage,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`size`
|string
|5Gi
|✅
|Визначає розмір сховища Kafka Zookeeper.

|===

[[platform]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.platform | <<parent-tech-params,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<security,security>>`
|object
|❌
|✅
|Містить налаштування безпеки реєстру.

|===

[[security]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.platform.security | <<platform,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<csrf,csrf>>`
|object
|❌
|✅
|Містить налаштування захисту від підробки запитів Cross-Site Request Forgery (CSRF).

|===

[[csrf]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.platform.security.csrf | <<security,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`enabled`
|bool
|true
|✅
|Визначає чи ввімкнений або вимкнений захист від підробки запитів Cross-Site Request Forgery (CSRF).

|===

[[s3]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.s3 | <<parent-tech-params,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<s3-config,config>>`
|object
|❌
|✅
|Містить налаштування S3-клієнту реєстрових компонентів для коректної взаємодії з S3 сховищем.

|===

[[s3-config]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.s3.config | <<s3,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<s3-client,client>>`
|object
|❌
|✅
|Містить налаштування S3-клієнту реєстрових компонентів для коректної взаємодії з S3 сховищем.

|`<<s3-options,options>>`
|object
|❌
|✅
|Містить налаштування S3-клієнту реєстрових компонентів для коректної взаємодії з S3 сховищем.

|===

[[s3-client]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.s3.config.client | <<s3-config,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`protocol`
|object
|http
|✅
|Визначає протокол взаємодії S3-клієнта та сервера.

|===

[[s3-options]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.s3.config.options | <<s3-config,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`pathStyleAccess`
|object
|true
|✅
|Вмикає доступ типу `path-style` до сегментів S3-бакетів.

|===

[[vault]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.vault | <<parent-tech-params,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`platformVaultToken`
|string
|❌
|✅
|Містить токен доступу до центрального сервісу управління секретами Платформи.

|`openshiftApiUrl`
|string
|❌
|✅
|Містить URL до OKD API-сервера.

|`centralVaultUrl`
|string
|❌
|✅
|Містить URL до центрального сервісу управління секретами Платформи.

|`<<vault-server,server>>`
|object
|❌
|✅
|Налаштування розгортання реєстрового Vault.

|===

[[vault-server]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.vault.server | <<vault,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`<<vault-storage,dataStorage>>`
|string
|❌
|✅
|Налаштування сховища для реєстрового Vault.

|`<<vault-storage,auditStorage>>`
|string
|❌
|✅
|Налаштування аудит-сховища для реєстрового Vault.

|===

[[vault-storage]]
[cols="20%,15%,5%,5%,60%",options="header",caption=]
.vault.server.dataStorage (auditStorage) | <<vault-server,Повернутись на батьківську таблицю>>
|===
|Назва|Тип|Значення за замовчуванням|Обовʼязкове|Призначення

|`storageClass`
|string
|ocs-storagecluster-ceph-rbd
|✅
|Містить назву `StorageClass` що використовується для розгортання Vault за замовчуванням.

|===
