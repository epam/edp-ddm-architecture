= Підсистема моніторингу подій та сповіщення

== Загальний опис

Підсистема, що забезпечує збирання моніторингових даних додатків та інфраструктури, зберігає інформацію як часовий ряд
(`time series)`, надає можливість побудови пошукових запитів і дозволяє створювати інформаційні оповіщення на їх підставі.

== Функції підсистеми

* Збирання та збереження моніторингових даних Платформних та реєстрових компонентів.
* Побудова інформаційних оповіщень на підставі даних моніторингу.
* Побудова візуальних представлень на підставі даних моніторингу.
* Надання уніфікованого інтерфейсу для збирання метрик.

== Технічний дизайн підсистеми

На даній діаграмі зображено компоненти, які входять в _Підсистему моніторингу подій та сповіщення_ та їх взаємодію з іншими підсистемами.

image::architecture/platform/operational/monitoring/monitoring-subsystem.drawio.svg[width=800,float="center",align="center"]

== Складові підсистеми

|===
|Назва компоненти|Namespace|Deployment|Походження|Репозиторій|Призначення

|_Веб-інтерфейс моніторингу Платформи_
|`grafana-monitoring`
|`grafana`
|3rd-party
.11+|https://github.com/epam/edp-ddm-monitoring[github:/epam/edp-ddm-monitoring]
|Візуалізація та надання доступу до даних моніторингу

|_Розширення для рендерінгу зображень_
|`grafana-monitoring`
|`grafana-image-renderer`
|3rd-party
|Розширення для Grafana призначене для генерування PNG зображень при експорті графіків та чартів

|_Сервіс сповіщень_
|`openshift-monitoring`
|`alertmanager-main`
|3rd-party
|Система сповіщення адміністраторів при аномаліях або нештатних ситуаціях з компонентами Платформи або реєстрів

|_Оператор Prometheus_
|`openshift-monitoring`
|`prometheus-operator`
|3rd-party
|Компонент моніторингу, що забезпечує налаштування, розгортання та обслуговування компонентів Prometheus
підсистеми моніторингу Платформи

|_OpenShift оператор моніторингу_
|`openshift-monitoring`
|cluster-monitoring-operator`
|3rd-party
|Забезпечення налаштування, розгортання та обслуговування підсистеми моніторингу Платформи в OKD

|_Сервіс виконання запитів до Prometheus_
|`openshift-monitoring`
|`thanos-querier`
|3rd-party
|Сервіс запитів до Prometheus. Використовується сервісом Grafana для візуалізації метрик.

|_Експортери метрик віртуальних машин_
|`openshift-monitoring`
|`node-exporter`
|3rd-party
|Збирання метрик з віртуальних машин Платформи та реєстрів

|_Сервіс моніторингу_
|`openshift-monitoring`
|`prometheus-k8s`
|3rd-party
|Збирання та зберігання метрик компонентів Платформи та реєстрів

|_Служба моніторингу k8s обʼєктів_
|`openshift-monitoring`
|`kube-state-metrics`
|3rd-party
|Збирає метрики, що стосуються стану ресурсів та об'єктів kubernetes API-сервера в Платформі оркестрації контейнерів

|_Служба моніторингу openshift обʼєктів_
|`openshift-monitoring`
|`openshift-state-metrics`
|3rd-party
|Збирає метрики, що стосуються стану ресурсів та об'єктів OpenShift API-сервера в Платформі оркестрації контейнерів

|_Компонент інтеграції метрик з механізмами масштабування кластера OKD_
|`openshift-monitoring`
|`prometheus-adapter`
|3rd-party
|Передача метрик між Prometheus та компонентами автомасштабування Платформи оркестрації контейнерів.

|_Служба валідації конфігурації ресурсів_
|`openshift-monitoring`
|`prometheus-operator-admission-webhook`
|3rd-party
|Взаємодіє з API сервером Платформи оркестрації контейнерів для перевірки та модифікації конфігурацій ресурсів підсистеми моніторингу
перед їхнім застосуванням.

|===

== Технологічний стек
* xref:arch:architecture/platform-technologies.adoc#okd[OKD]
* xref:arch:architecture/platform-technologies.adoc#prometheus[Prometheus]
* xref:arch:architecture/platform-technologies.adoc#prometheus-operator[Prometheus Operator]
* xref:arch:architecture/platform-technologies.adoc#thanosquerier[Thanos Querier]
* xref:arch:architecture/platform-technologies.adoc#grafana[Grafana]

== Доступні Grafana дашборди



== Атрибути якості підсистеми

=== _Scalability_
Підсистема моніторингу подій та сповіщення розроблена з урахуванням горизонтального масштабування для підтримки великих
кластерів та високого обсягу метрик з Платформи та реєстрів.

=== _Reliability_
Підсистема моніторингу подій та сповіщення використовує стабільні та надійні компоненти, такі як Prometheus, Grafana та
Alertmanager, для надання точних та стабільних рішень щодо моніторингу Платформи та реєстрів та аналізу вже зібраних метрик.
