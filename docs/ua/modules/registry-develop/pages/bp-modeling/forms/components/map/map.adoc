:toc-title: ЗМІСТ
:toc: auto
:toclevels: 5
:experimental:
:important-caption:     ВАЖЛИВО
:note-caption:          ПРИМІТКА
:tip-caption:           ПІДКАЗКА
:warning-caption:       ПОПЕРЕДЖЕННЯ
:caution-caption:       УВАГА
:example-caption:           Приклад
:figure-caption:            Зображення
:table-caption:             Таблиця
:appendix-caption:          Додаток
:sectnums:
:sectnumlevels: 5
:sectanchors:
:sectlinks:
:partnums:

= Компонент Map

== Опис компонента

Компонент *Map* (Мапа) дозволяє використовувати картографічні дані з різних картографічних сервісів, наприклад, OpenStreetMap та інших, а також додавати власні шари та дані геопросторових об'єктів.

Налаштувати компонент *Map* можна у [.underline]#Кабінеті адміністратора регламентів#, у розділі [.underline]#UI-форми#.

. Створіть нову форму.
. Перейдіть на вкладку [.underline]#Конструктор#.
. Відкрийте [.underline]#Компоненти# > [.underline]#Оновлені#, оберіть компонент `*Map*` та перетягніть його до панелі моделювання.
+
image:bp-modeling/forms/components/map/map-01.png[]

. У налаштуваннях компонента відкрийте вкладку *Display* та у полі `*Label*` вкажіть бізнес-назву поля для вашої мапи. Наприклад, `Map`.
+
image:bp-modeling/forms/components/map/map-1.png[]

. Перейдіть на вкладку *Data* та виконайте наступні налаштування:

* У секції *`Base Layers`* вкажіть URL-адресу картографічного сервісу, наприклад, `OpenStreetMap`, та додаткову інформацію про цей сервіс. Зокрема, ви вказуєте назву шару (`Name`), максимальний масштаб (`Max Zoom`), на якому будуть відображені дані, а також URL-адресу для завантаження зображень плиток (`tiles`) із сервера OpenStreetMap (`https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png`).

* Параметри *`Overlay Search Field`* та `*Search Zoom*` використовуються для пошуку геоданих на карті. Ви можете вказати назву поля для пошуку введеного користувачем значення та масштаб, на якому будуть показані результати пошуку.

* У секції `*Overlay Layers*` ви можете вказати свої власні шари, які будуть накладатися на базовий шар OpenStreetMap. Наприклад, ви можете використовувати дані із власної бази даних, щоб показати місця розташування певних об'єктів на карті. У цьому випадку ви вказуєте URL-адресу GeoServer, де зберігаються ваші геодані, а також назви таблиці та представлення у БД для відображення геоданих на карті.
+
[NOTE]
====
URL-адресу геосервера можна вказати як відносну, так і повну:

* Відносна адреса -- *`/geoserver/registry/ows`*.

* Повна адреса -- `https://geo-server-<назва-реєстру>.apps.envone.dev.registry.eua.gov.ua/geoserver/registry/ows`.

Якщо вказати повну адресу геосервера, то ви зможете переглядати точки та шукати об'єкти на мапі прямо у конструкторі UI-форм.
====
+
image:bp-modeling/forms/components/map/map-2.png[]
+
Поле `*Details Title Path*` використовується для відображення детальної інформації про геопросторові об'єкти, які ви показуєте на карті. Ви можете вказати шлях до поля у вашій базі даних, яке містить назву об'єкта (`Name`), щоб відобразити цю інформацію в детальному вікні при натисканні на об'єкт на карті. Параметр `Address` використовується для відображення адреси геопросторового об'єкта.
+
image:bp-modeling/forms/components/map/map-2-1.png[]

. На вкладці *Data* налаштуйте геокодування:
+

[TIP]
====
[%collapsible]
.Що таке геокодування?
=====
Геокодування -- це процес конвертації адреси або інших описів місць у географічні координати (широта та довгота). У нашому випадку, функціональність геокодування використовує сервіс Nominatim, який базується на даних OpenStreetMap.
=====
====

* *`Enable Geocode`* -- активація геокодування та підключення Nominatim. Ця опція дозволяє увімкнути чи вимкнути функцію геокодування у додатку.

* *`Geocode Search Placeholder`* -- це текст, який відображається у полі пошуку геокодування за замовчуванням. У цьому випадку користувачів просять ввести адресу або місце для пошуку, використовуючи плейсхолдер `Search`.

* *`Geocode Search Url`* -- це URL-адреса, яка використовується для відправлення запитів на сервер Nominatim для геокодування: +
https://nominatim.openstreetmap.org/search?format=json&q={s}
+
Змінна `{s}` замінюється на текст, введений користувачем у полі пошуку.
+
[NOTE]
====
Ви можете використати будь-який інший сервіс.
====

* *`Geocode Search Zoom`* -- це значення масштабування карти після успішного геокодування. Значення `12`, наприклад, означає, що карта буде збільшена на середній рівень деталізації, забезпечуючи користувачам загальний огляд області.

* *`Geocode Marker Radius`* -- це радіус маркера на карті, який відображає результати геокодування. Значення `10`, наприклад, вказує на середній розмір маркера, що допомагає користувачам легко його розгледіти на карті.

+
image:bp-modeling/forms/components/map/map-4.png[]

. Перейдіть на вкладку *API* та у полі `Property Name` вкажіть назву властивості, яка буде використовуватися в API-запитах. Наприклад, `entityLocation`.
+
image:bp-modeling/forms/components/map/map-3.png[]

. Натисніть kbd:[Save], щоб зберегти зміни, та вийдіть із налаштувань компонента.

. Перевірте, чи працює мапа належним чином. Ви можете знайти певний об'єкт на карті вручну, а також скористатися опціями пошуку та геокодування.
+
image:bp-modeling/forms/components/map/map-5.png[]
+
image:bp-modeling/forms/components/map/map-6.png[]
+
image:bp-modeling/forms/components/map/map-7.png[]

== Пов'язані сторінки

* xref:registry-admin/geoserver.adoc[]