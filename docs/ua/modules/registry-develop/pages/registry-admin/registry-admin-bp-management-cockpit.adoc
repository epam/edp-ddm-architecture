:toc-title: ЗМІСТ
:toc: auto
:toclevels: 5
:experimental:
:important-caption:     ВАЖЛИВО
:note-caption:          ПРИМІТКА
:tip-caption:           ПІДКАЗКА
:warning-caption:       ПОПЕРЕДЖЕННЯ
:caution-caption:       УВАГА
:example-caption:           Приклад
:figure-caption:            Зображення
:table-caption:             Таблиця
:appendix-caption:          Додаток
:sectnums:
:sectnumlevels: 5
:sectanchors:
:sectlinks:
:partnums:

= Адміністрування бізнес-процесів у Camunda Cockpit

Для адміністрування бізнес-процесів адміністратор реєстру використовує сервіс **Camunda Cockpit**.

За допомогою *Camunda Cockpit* адміністратор може здійснювати моніторинг бізнес-процесів, що працюють, і бізнес-правил для виявлення, аналізу та розв'язання технічних проблем.

[NOTE]
====
Детальніше ознайомитися з загальним описом сервісу ви можете на офіційному ресурсі за посиланням:

* https://docs.camunda.org/manual/latest/webapps/cockpit/
====

== Права доступу до сервісу

Для надання доступу до сервісу Camunda Cockpit виконайте наступні дії:

. Перейдіть до сервісу Keycloak, наприклад, через посилання в OpenShift.
+
image:registry-admin/camunda-cockpit/cockpit-21.png[]

. Виберіть відповідний -admin realm. Перейдіть до меню `Users`, натисніть кнопку `View all users` та оберіть користувача, якому необхідно надати доступ.
+
image:registry-admin/camunda-cockpit/cockpit-22.png[]

. Перейдіть до розділу `Groups`, виберіть роль `camunda-admin` та настисніть `Join`.
+
image:registry-admin/camunda-cockpit/cockpit-23.png[]
+
Після успішного надання ролі буде показано сповіщення: _"Success! Added group membership"_.

[NOTE]
====
Детальніше ознайомитися з процедурою надання прав доступу ви можете за посиланням:

* xref:platform:admin:user-management-auth/keycloak-create-users.adoc[]
====

== Авторизація в системі

Посилання до сервісу Camunda Cockpit можна знайти в OpenShift консолі, або Control Plane.

* Для авторизації з OpenShift:

. Перейдіть до розділу `Networking` -> `Routes`.
+
. Оберіть необхідний проєкт.
+
. Знайдіть відповідний route `business-process-administration-portal` і натисніть на посилання у колонці `Location`.
+
image:registry-admin/camunda-cockpit/cockpit-25.png[]

* Для авторизації через Control Plane:
+
. Увійдіть до адміністративної панелі реєстрами Control Plane, використовуючи попередньо отримані логін та пароль.
+
image:platform:admin:infrastructure/cluster-mgmt/update-cluster-mgmt-01.png[]

. Перейдіть до розділу `Реєстри` та оберіть відповідний реєстр.
+
image:platform:admin:infrastructure/cluster-mgmt/change-key/change-key-01.png[]

. Відкрийте вкладку +++<b style="font-weight: 600">Швидкі посилання<b>+++ та перейдіть до +++<b style="font-weight: 600">Вебінтерфейсу управління виконанням бізнес-процесів (Business Proc Adm)<b>+++.
+
image:registry-admin/camunda-cockpit/cockpit-20.png[]


== Головна сторінка

Після авторизації у вебінтерфейсі сервісу адміністрування бізнес-процесів **Camunda Cockpit**, на екрані зображується **Головна сторінка** (**Camunda Welcome**) -- інформаційна панель (дашборд), яка містить три основні секції: **Cockpit**, **Tasklist** та **Admin**.

Перейдіть до розділу **Cockpit**.

image:registry-admin/camunda-cockpit/cockpit-1.png[]

В результаті відкривається дошка (борд) з чартами, де вказана загальна інформація про бізнес-процеси та їх статус на цей час.

== Управління бізнес-процесами у Camunda Cockpit

=== Дашборд Camunda Cockpit

image:registry-admin/camunda-cockpit/cockpit-2.png[]

Секція **Right Now** показує бізнес-процеси, які виконуються в цей момент:

[#running-process-instances]
* **Running Process Instances** -- в середині кола зліва показано кількість бізнес-процесів, які запущені одним або декількома користувачами в цей момент і є не завершеними.
* **Open Incidents** -- в середині кола по центру показно кількість інцидентів, що виникли при виконанні бізнес-процесів.
* **Open Human Tasks** -- в середині кола справа показано кількість користувацьких задач, що відкриті в цей момент і очікують виконання. Ці задачі були змодельовані у моделері Camunda (Camunda Modeler)  і опубліковані сервісом виконання бізнес-процесів, та є доступними користувачеві в Кабінетах отримувача послуг або посадової особи (сервіси `citizen-portal` та `officer-portal`).

Секція **Deployed** показує бізнес-процеси, які розгорнуто на цей момент:

* Поле `Process Definitions` -- показує загальну кількість розгорнутих бізнес-процесів в Camunda.
//* Поле `Decision Definitions` -- застосовані бізнес-правила (розгорнуті описи по DMN).
//* Поле `Case Definitions` – не використовується.
* Поле `Deployments` -- кількість розгортань/оновлень (версій) регламенту.

image:registry-admin/camunda-cockpit/cockpit-3.png[]

=== Бізнес-процеси у виконанні (Processes)

При натисканні на чарт **xref:running-process-instances[Running Process Instances]** буде виконано перехід на сторінку **Processes**, де подано список усіх бізнес-процесів, які розгорнуті в цей момент.

image:registry-admin/camunda-cockpit/cockpit-6.0.png[]

|===
5+|_Опис колонок_
|`State`|`Incidents`|`Running Instances`|`Name`|`Tenant ID`
|Поточний статус виконання бізнес-процесу|Кількість інцидентів з помилками|Кількість запусків цього бізнес-процесу|Назва бізнес-процесу та посилання на нього|ID тенанту
|===

==== Перегляд деталей екземплярів бізнес-процесу

Після переходу за посиланням бізнес-процесу (у колонці `Name`) відкривається таблиця з усіма екземплярами цього бізнес-процесу.

image:registry-admin/camunda-cockpit/cockpit-7.0.png[]

Розширена інформація про цей бізнес-процес зображена у полі зліва. У рядку `Definition Version` вказано версію бізнес-процесу. Якщо версій декілька, то з’являється випадний список із можливістю перемикання між ними -- таким чином будуть зображені елементи **Process Instances** для кожної версії бізнес-процесу для відстеження змін.

image:registry-admin/camunda-cockpit/cockpit-16.png[]

==== Робота з помилковими інцидентами

У разі, якщо виконання бізнес-процесу відбулося з помилкою, цей інцидент буде показано у загальному переліку бізнес-процесів з позначкою у вигляді символу "хрестик" -- ❌.

[NOTE]
====
* Якщо помилка пов'язана з налаштуваннями самого бізнес-процесу або некоректним скриптом і т.ін., перезапуск процесу не допоможе, і необхідно вносити відповідні зміни в сам бізнес-процес.
* Якщо помилка пов'язана з некоректним відпрацюванням інших систем або відсутністю з'єднання в певний проміжок часу і т.ін., необхідно виконати перезапуск процесу.
====

Для повторного запуску процесу, з метою усунення помилки, виконайте наступні дії:

[NOTE]
====
Процес запускається не з початку, а з місця падіння (з урахуванням _wait state_).
====

. Перейдіть за посиланням бізнес-процесу у колонці `Name`.
+
image:registry-admin/camunda-cockpit/cockpit-26.png[]

. Перейдіть до розділу `Incidents`.
+
image:registry-admin/camunda-cockpit/cockpit-27.png[]

. Щоб подивитися вміст помилки натисніть на повідомлення в полі `Message`. У новому вікні буде показано вміст помилки.
+
image:registry-admin/camunda-cockpit/cockpit-28.png[]

. Для перезапуску натисніть піктограму ↻ `Increment Number of Retriers of Failed Jobs` у правому верхньому куті або навпроти екземпляру процесу.
+
image:registry-admin/camunda-cockpit/cockpit-29.png[]

Після натискання запуститься повторне виконання процесу, результат виконання якого можна буде подивитися на головному дашборді через деякий час.

==== Призупинення бізнес-процесів і їх екземплярів

Натиснувши іконку `Suspend Process Instance`, можливо призупинити виконання певного екземпляра бізнес-процесу, після чого користувач (чи система) не зможе його завершити -> далі натисніть `Suspend` для підтвердження.

image:registry-admin/camunda-cockpit/cockpit-12.0.png[]

За аналогією, можливо призупинити виконання бізнес-процесу в цілому, натиснувши іконку `Suspend Process Definition`, користувачі не зможуть завершити розпочаті бізнес-процеси, в тому числі всі елементи бізнес-процесів, а також розпочати нові. Згодом цей бізнес-процес можна буде активувати знову.

==== Активація виконання бізнес-процесів і їх екземплярів

При натисканні на іконку `Activate Process Instance`, екземпляр бізнес-процесу запускається знову.

image:registry-admin/camunda-cockpit/cockpit-13.png[]

За аналогією, активується бізнес-процес при натисканні на іконку `Activate Process Definition`.

==== Видалення екземплярів бізнес-процесів

Також є можливість видалити певний екземпляр бізнес-процес, натиснувши у правому верхньому куті позначку `x` (хрестик) далі натисніть `Delete Process Instance` для підтвердження.

image:registry-admin/camunda-cockpit/cockpit-9.0.png[]

==== Редагування параметрів

Кожну задачу можна відкрити за посиланням і перевірити змінні цього бізнес-процесу, які доступні моделювальнику бізнес-процесу і зображені на вкладці **Variables**.

image:registry-admin/camunda-cockpit/cockpit-8.0.png[]

Натиснувши на іконку редагування у колонці `Actions` (або натиснувши на відповідний параметр), є можливість редагувати дані у колонці `Value` для безпеки «sensitive»-інформації.

image:registry-admin/camunda-cockpit/cockpit-8.1.png[]

==== Фільтрування параметрів пошуку

Також є можливість вказати додаткові фільтри для швидкого пошуку необхідних бізнес-процесів.

image:registry-admin/camunda-cockpit/cockpit-14.png[]


=== Перевірчі правила (Decisions)

На вкладці **Decisions** показані перевірчі правила у вигляді таблиці для кожного бізнес-процесу.

image:registry-admin/camunda-cockpit/cockpit-17.png[]

=== Призначені задачі (Human Tasks)

На вкладці **Human Tasks** показано кількість запущених задач, які призначені відповідальним за них користувачам.

image:registry-admin/camunda-cockpit/cockpit-18.png[]

=== Перегляд розгорнутих бізнес-процесів (Deployments)

При виборі іконки `Deployments`, відкривається вкладка з наступними полями:

- у колонці `Deployment Time` показано дату та час кожного розгорнутого файлу;
- у колонці посередині – список розгорнутих файлів в рамках вказаного процесу розгортання;
- при натисканні лівою кнопкою миші на назву файлу -- у колонці справа зображується схема (модель) бізнес-процесу.

При натисканні лівою кнопкою миші на іконку `Download`, завантажується бізнес-процес, створений у моделері.

image:registry-admin/camunda-cockpit/cockpit-4.png[]

Розширена інформація про цей бізнес-процес міститься у полі `Definitions`. Можливо перейти за посиланням на сторінку цього бізнес-процесу, на якій у вкладці **Process Instances** показано екземпляр бізнес-процесу, який виконується в цей момент (кількість вказано на інформаційній панелі, в колі `Running Activity Instances` (в нашому прикладі -- 26).

image:registry-admin/camunda-cockpit/cockpit-5.png[]

////
== Навігація

Для переміщення між компонентами Camunda, використовується іконка ⌂ `Home` у правому верхньому куті екрану.

На головному екрані з Camunda Cockpit можливо перейти до секцій:

* **Admin** (сторінка **Camunda Admin**), де є можливість адміністрування:

-	користувачів -- `Users`,
-	груп користувачів -- `Groups`,
-	тенантів (екземплярів) `Tenants`,
-	функцій управління авторизацією `Authorizations`, системними налаштуваннями `System`.

+
image:registry-admin/camunda-cockpit/cockpit-19.png[]

* **Tasklist** (сторінка **Camunda Tasklist**), де є можливість управління списком задач.
+
image:registry-admin/camunda-cockpit/cockpit-30.png[]
////
