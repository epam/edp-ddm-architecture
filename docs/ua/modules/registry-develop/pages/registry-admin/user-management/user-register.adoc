= Реєстрація користувачів реєстру
include::platform:ROOT:partial$templates/document-attributes/default-set-ua.adoc[]

Ця інструкція допоможе налаштувати реєстрацію користувачів у сервісі
include::platform:ROOT:partial$templates/links/platform/operational/keycloak.adoc[]
вашого реєстру. Платформа реєстрів підтримує роботу в різних регіонах та країнах, забезпечуючи автентифікацію через логін і пароль у Кабінетах користувачів.

== Налаштування реєстрації користувачів

Платформа реєстрів пропонує налаштування глобального регіону для реєстрів. Специфічна конфігурація кожного реєстру зберігається у файлі *_deploy-templates/values.yml_*. Якщо параметр `region` встановлено як `global`, це означає, що адміністратор реєстру має можливість налаштовувати реєстрацію користувачів для двох реалмів -- `officer` та `citizen`.

=== Реалм officer-portal

. Відкрийте *Realm Settings* (налаштування реалму) та перейдіть на вкладку *Login*.
. Увімкніть опцію *User registration*, перевівши її в положення `ON`. Це дозволяє увімкнути доступ до самостійної реєстрації у Кабінеті користувача (`officer-portal`).
+
[NOTE]
====
За замовчуванням опція *User registration* вимкнена, що виключає можливість самостійної реєстрації користувачів.

Для реалму `officer`, при вимкненому параметрі *User registration*, на сторінці автентифікації не з'являється посилання для реєстрації нових користувачів, а отже адміністратор має створювати акаунти вручну. В іншому випадку, коли *User registration* включено, користувачі можуть самостійно реєструватися.
====

+
image:registry-admin/user-management/user-register-01.png[]

=== Реалм citizen-portal

. Відкрийте *Realm Settings* (налаштування реалму) та перейдіть на вкладку *Login*.
. Увімкніть опцію *User registration*, перевівши її в положення `ON`. Це дозволяє увімкнути доступ до самостійної реєстрації у Кабінеті отримувача послуг (`citizen-portal`).
+
[NOTE]
====
За замовчуванням опція *User registration* вимкнена, що виключає можливість самостійної реєстрації користувачів.

Для реалму `citizen`, при вимкненому параметрі *User registration*, на сторінці автентифікації не з'являється посилання для реєстрації нових користувачів. В іншому випадку, коли *User registration* включено, користувачі можуть самостійно реєструватися.
====
+
CAUTION: Для реалму `citizen` необхідно _завжди_ включати *User registration*, щоб користувачі могли самостійно реєструватися.

+
image:registry-admin/user-management/user-register-02.png[]

== Налаштування ролей за замовчуванням

=== Реалм officer-portal

. Відкрийте розділ *Roles* та перейдіть до налаштування ролей.
. Перейдіть на вкладку *Default Roles*.
. Виберіть роль `officer` зі списку *Available roles* та натисніть *`Add selected`*. Додана роль з'явиться у списку *Realm Default Roles* і буде призначена за замовчуванням.

+
image:registry-admin/user-management/user-register-03.png[]

=== Реалм citizen-portal

. Відкрийте розділ *Roles* та перейдіть до налаштування ролей.
. Перейдіть на вкладку *Default Roles*.
. Виберіть роль `citizen` зі списку *Available roles* та натисніть *`Add selected`*. Додана роль з'явиться у списку *Realm Default Roles* і буде призначена за замовчуванням.

+
image:registry-admin/user-management/user-register-04.png[]

== Налаштування тимчасового пароля користувачу

. Відкрийте розділ *Authentication* та перейдіть до налаштувань автентифікатора.
. Перейдіть на вкладку *Required Actions*.
. Активуйте параметр *Default Action* для запису `Update Password`.

+
image:registry-admin/user-management/user-register-05.png[]

== Створення користувачів вручну (_для надавачів послуг_)

CAUTION: Для реалму `citizen` необхідно _завжди_ включати *User registration*, щоб отримувачі послуг могли самостійно реєструватися.

Щоб вручну створити обліковий запис надавача послуг (реалм `officer`), виконайте наступні кроки:

. Відкрийте реалм `officer` та перейдіть до розділу *Users*.
. Натисніть *`Add user`*, щоб створити нового користувача.
. Вкажіть наступні атрибути реєстрації користувача:
+
[cols="2,2,2,2", options="header"]
|===
| Поле | Опис | Тестове значення | Значення за замовчуванням

| *Username*
| Ім'я користувача, яке використовується для входу в систему.
| `john.doe@mail.com`
|-

| *Email*
| Електронна пошта користувача, яка може використовуватись для сповіщень та відновлення пароля.
| `john.doe@mail.com`
|-

| *First Name*
| Ім'я користувача.
| `John`
|-

| *Last Name*
| Прізвище користувача.
| `Doe`
|-

| *User Enabled*
| Визначає, чи активний користувач. Якщо встановлено у `True`, користувач може входити в систему.
| `ON`
| `ON`

| *Email Verified*
| Вказує, чи була перевірена електронна пошта користувача. Якщо `True`, користувачу не потрібно підтверджувати електронну пошту при вході.
| `OFF`
| `OFF`

|===
+
image:registry-admin/user-management/user-register-06.png[]

. Перейдіть до секції *Role Mappings*. У параметрі *Effective Roles* можна перевірити, що створена вище роль (_за замовчуванням_) `officer` призначається автоматично.
+
image:registry-admin/user-management/user-register-07.png[]

. Перейдіть на вкладку *Credentials* та встановіть тимчасовий пароль. Користувач має змінити його при першому вході в систему.
+
image:registry-admin/user-management/user-register-08.png[]

== Перевірка реєстрації та входу до Кабінетів

Користувачі, які успішно пройшли процес реєстрації самостійно або були зареєстровані через адміністратора, отримують доступ до системи. Вони можуть переглядати доступні послуги, що відповідають їхнім ролям, та активно брати участь у бізнес-процесах.

. Нові користувачі спочатку потрапляють на форму реєстрації, де вони повинні ввести свої персональні дані для створення облікового запису в системі:

* *First name* -- Ім'я
* *Last name* -- Прізвище
* *Email* -- Адреса електронної пошти
* *Username* -- Ім'я користувача
* *Password* -- Пароль
* *Confirm password* -- Підтвердження пароля

. Після заповнення форми користувачі натискають кнопку *`Register`* для завершення процесу реєстрації.

+
.Кабінет надавача послуг. Форма реєстрації користувача
image::registry-admin/user-management/user-register-09.png[]

. Зареєстровані користувачі можуть увійти до системи, використовуючи свої облікові дані через форму входу.

+
.Кабінет надавача послуг. Форма входу до Кабінету
image::registry-admin/user-management/user-register-10.png[]

. Першочергово рекомендується змінити тимчасовий пароль за допомогою відповідної форми, натиснувши *`Submit`* для підтвердження зміни.

+
.Кабінет надавача послуг. Форма зміни тимчасового пароля
image::registry-admin/user-management/user-register-11.png[]

. Після завершення процедур реєстрації та автентифікації адміністратори мають змогу переглядати та оновлювати налаштування профілів користувачів через панель управління Keycloak. Доступ до списку користувачів здійснюється через вкладку *Users*, вибравши опцію *`View all users`*.

+
.Сервіс Keycloak. Реалм `officer-portal`. Перелік користувачів
image::registry-admin/user-management/user-register-12.png[]
