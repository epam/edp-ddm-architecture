= –û–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—è –ë–î —Ç–∞ —Ä—É—á–Ω–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —ñ—Å—Ç–æ—Ä—ñ—î—é –∑–º—ñ–Ω
include::platform:ROOT:partial$templates/document-attributes/default-set-ua.adoc[]

== –û–≥–ª—è–¥

–ó —á–∞—Å–æ–º –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –±–∞–∑–∏ –¥–∞–Ω–∏—Ö –º–æ–∂–µ –∑–Ω–∏–∂—É–≤–∞—Ç–∏—Å—è —á–µ—Ä–µ–∑ –Ω–∞–∫–æ–ø–∏—á–µ–Ω–Ω—è –∑–º—ñ–Ω–µ–Ω–∏—Ö –∞–±–æ –≤–∏–¥–∞–ª–µ–Ω–∏—Ö –∑–∞–ø–∏—Å—ñ–≤, —Ñ—Ä–∞–≥–º–µ–Ω—Ç–∞—Ü—ñ—é —ñ–Ω–¥–µ–∫—Å—ñ–≤ —Ç–∞ –∑–∞—Å—Ç–∞—Ä—ñ–ª—É —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É. –¶–µ –≤–ø–ª–∏–≤–∞—î –Ω–∞ —à–≤–∏–¥–∫—ñ—Å—Ç—å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤, –≤–∏–∫–æ—Ä–∏—Å—Ç–∞–Ω–Ω—è –¥–∏—Å–∫–æ–≤–æ–≥–æ –ø—Ä–æ—Å—Ç–æ—Ä—É —Ç–∞ –∑–∞–≥–∞–ª—å–Ω—É –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —Ä–æ–±–æ—Ç–∏ —Å–∏—Å—Ç–µ–º–∏.

–©–æ–± –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Å—Ç–∞–±—ñ–ª—å–Ω—É –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å, —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –ø–µ—Ä—ñ–æ–¥–∏—á–Ω–æ –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—é –±–∞–∑–∏ –¥–∞–Ω–∏—Ö. PostgreSQL –Ω–∞–¥–∞—î –≤–±—É–¥–æ–≤–∞–Ω—ñ –º–µ—Ö–∞–Ω—ñ–∑–º–∏, —Ç–∞–∫—ñ —è–∫ `VACUUM`, `ANALYZE` —Ç–∞ `REINDEX`, —è–∫—ñ –¥–æ–ø–æ–º–∞–≥–∞—é—Ç—å –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—É —Ä–æ–±–æ—Ç—É —Å–∏—Å—Ç–µ–º–∏, –∑–º–µ–Ω—à—É—é—á–∏ –∑–∞–π–Ω—è—Ç–∏–π –¥–∏—Å–∫–æ–≤–∏–π –ø—Ä–æ—Å—Ç—ñ—Ä —Ç–∞ –ø–æ–∫—Ä–∞—â—É—é—á–∏ —à–≤–∏–¥–∫—ñ—Å—Ç—å –≤–∏–∫–æ–Ω–∞–Ω–Ω—è –∑–∞–ø–∏—Ç—ñ–≤.

== –û—Å–Ω–æ–≤–Ω—ñ –∫–æ–º–∞–Ω–¥–∏ –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó

–£ —Ü—å–æ–º—É –¥–æ–∫—É–º–µ–Ω—Ç—ñ –º–∏ –±—É–¥–µ–º–æ –ø—Ä–∞—Ü—é–≤–∞—Ç–∏ –∑ —Ç–∞–±–ª–∏—Ü–µ—é `protocols` —è–∫ –ø—Ä–∏–∫–ª–∞–¥–æ–º –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó.

–©–æ–± –∑–º–µ–Ω—à–∏—Ç–∏ —Ä–æ–∑–º—ñ—Ä —Ç–∞–±–ª–∏—Ü—å, –æ–Ω–æ–≤–∏—Ç–∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ç–æ—Ä–∞ –∑–∞–ø–∏—Ç—ñ–≤ —ñ –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å —ñ–Ω–¥–µ–∫—Å—ñ–≤, —Ä–µ–∫–æ–º–µ–Ω–¥—É—î—Ç—å—Å—è –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏ —Ç–∞–∫—ñ –æ–ø–µ—Ä–∞—Ü—ñ—ó:

* **`VACUUM`** ‚Äì –∑–≤—ñ–ª—å–Ω—è—î –¥–∏—Å–∫–æ–≤–∏–π –ø—Ä–æ—Å—Ç—ñ—Ä, –∑–∞–π–Ω—è—Ç–∏–π –≤–∏–¥–∞–ª–µ–Ω–∏–º–∏ –∞–±–æ –æ–Ω–æ–≤–ª–µ–Ω–∏–º–∏ —Ä—è–¥–∫–∞–º–∏, —è–∫—ñ –±—ñ–ª—å—à–µ –Ω–µ –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—é—Ç—å—Å—è.
* **`ANALYZE`** ‚Äì –æ–Ω–æ–≤–ª—é—î —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –¥–ª—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ç–æ—Ä–∞ –∑–∞–ø–∏—Ç—ñ–≤ PostgreSQL, –¥–æ–ø–æ–º–∞–≥–∞—é—á–∏ –≤–∏–±–∏—Ä–∞—Ç–∏ –Ω–∞–π–µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à—ñ –ø–ª–∞–Ω–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è.
* **`REINDEX`** ‚Äì –ø–µ—Ä–µ–≤–∏–∑–Ω–∞—á–∞—î —ñ–Ω–¥–µ–∫—Å–∏, —â–æ –ø–æ–∫—Ä–∞—â—É—î –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å –∑–∞–ø–∏—Ç—ñ–≤ –ø—ñ—Å–ª—è –∑–Ω–∞—á–Ω–∏—Ö –∑–º—ñ–Ω —É —Ç–∞–±–ª–∏—Ü—è—Ö.

== –í–∏–∫–æ–Ω–∞–Ω–Ω—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ–π–Ω–∏—Ö –∫–æ–º–∞–Ω–¥ –≤—Ä—É—á–Ω—É

–Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–æ –æ–ø—Ç–∏–º—ñ–∑—É–≤–∞—Ç–∏ –∫–æ–Ω–∫—Ä–µ—Ç–Ω—É —Ç–∞–±–ª–∏—Ü—é –≤—Ä—É—á–Ω—É, –º–æ–∂–Ω–∞ –≤–∏–∫–æ–Ω–∞—Ç–∏ —Ç–∞–∫—ñ –∫–æ–º–∞–Ω–¥–∏:

[source,sql]
----
VACUUM ANALYZE protocols;
REINDEX TABLE protocols;
----

–¶—ñ –∫–æ–º–∞–Ω–¥–∏ –¥–æ–ø–æ–º–æ–∂—É—Ç—å –ø—ñ–¥—Ç—Ä–∏–º—É–≤–∞—Ç–∏ –µ—Ñ–µ–∫—Ç–∏–≤–Ω—É —Ä–æ–±–æ—Ç—É —Ç–∞–±–ª–∏—Ü—ñ `protocols`, –æ—Å–æ–±–ª–∏–≤–æ –ø—ñ—Å–ª—è –º–∞—Å–æ–≤–æ–≥–æ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∞–±–æ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∑–∞–ø–∏—Å—ñ–≤.

== –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó

–£ –±–∞–∑—ñ –¥–∞–Ω–∏—Ö —Ä–µ—î—Å—Ç—Ä—ñ–≤ –Ω–∞–ª–∞—à—Ç–æ–≤–∞–Ω–æ *–∞–≤—Ç–æ–≤–∞–∫—É—É–º*, —è–∫–∏–π –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∫–æ–Ω—É—î `VACUUM` —ñ `ANALYZE`, –Ω–µ –ø–æ—Ç—Ä–µ–±—É—é—á–∏ –¥–æ–¥–∞—Ç–∫–æ–≤–∏—Ö –¥—ñ–π –∑ –±–æ–∫—É –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞. –û–¥–Ω–∞–∫ —É –¥–µ—è–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö –º–æ–∂–µ –∑–Ω–∞–¥–æ–±–∏—Ç–∏—Å—è –ø—Ä–∏–º—É—Å–æ–≤–µ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è —Ü–∏—Ö –∫–æ–º–∞–Ω–¥, –∑–æ–∫—Ä–µ–º–∞, —è–∫—â–æ:

- –í—ñ–¥–±—É–ª–æ—Å—è –º–∞—Å–æ–≤–µ –≤–∏–¥–∞–ª–µ–Ω–Ω—è –∑–∞–ø–∏—Å—ñ–≤.
- –°–ø–æ—Å—Ç–µ—Ä—ñ–≥–∞—î—Ç—å—Å—è –∑–Ω–∞—á–Ω–µ –∑–Ω–∏–∂–µ–Ω–Ω—è –ø—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –ø—Ä–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—ñ –∑–∞–ø–∏—Ç—ñ–≤.
- –¢–∞–±–ª–∏—Ü—è –º—ñ—Å—Ç–∏—Ç—å –≤–µ–ª–∏–∫—É –∫—ñ–ª—å–∫—ñ—Å—Ç—å –æ–Ω–æ–≤–ª–µ–Ω—å (`UPDATE`) –∞–±–æ –≤–∏–¥–∞–ª–µ–Ω—å (`DELETE`).

== –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è –æ–ø—Ç–∏–º—ñ–∑–∞—Ü—ñ—ó —á–µ—Ä–µ–∑ `cron`

–î–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü—ñ—ó –ø—Ä–æ—Ü–µ—Å—É –º–æ–∂–Ω–∞ –Ω–∞–ª–∞—à—Ç—É–≤–∞—Ç–∏ –≤–∏–∫–æ–Ω–∞–Ω–Ω—è `VACUUM` —Ç–∞ `ANALYZE` —á–µ—Ä–µ–∑ `cron`. –¶–µ –ø–æ—Ç—Ä–µ–±—É—î –¥–æ—Å—Ç—É–ø—É –∞–¥–º—ñ–Ω—ñ—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –±–∞–∑–∏ –¥–∞–Ω–∏—Ö. –ù–∞–ø—Ä–∏–∫–ª–∞–¥, —É `crontab` –º–æ–∂–Ω–∞ –¥–æ–¥–∞—Ç–∏ –∑–∞–ø–∏—Å:

[source,shell]
----
0 3 * * * psql -d database_name -c 'VACUUM ANALYZE protocols;'
----

–¶–µ–π –∑–∞–ø–∏—Å –æ–∑–Ω–∞—á–∞—î, —â–æ `VACUUM ANALYZE` –¥–ª—è —Ç–∞–±–ª–∏—Ü—ñ `protocols` –≤–∏–∫–æ–Ω—É–≤–∞—Ç–∏–º–µ—Ç—å—Å—è —â–æ–Ω–æ—á—ñ –æ 03:00.

TIP: üîó –î–µ—Ç–∞–ª—å–Ω–∏–π –º–µ—Ö–∞–Ω—ñ–∑–º —Ä–æ–±–æ—Ç–∏ –∞–≤—Ç–æ–≤–∞–∫—É—É–º—É –æ–ø–∏—Å–∞–Ω–æ –≤ https://www.postgresql.org/docs/14/routine-vacuuming.html#AUTOVACUUM[–æ—Ñ—ñ—Ü—ñ–π–Ω—ñ–π –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü—ñ—ó PostgreSQL].

== –†—É—á–Ω–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —ñ—Å—Ç–æ—Ä—ñ—î—é –∑–º—ñ–Ω

–ó–∞ –∑–∞–º–æ–≤—á—É–≤–∞–Ω–Ω—è–º —Å–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—î –≤—Å—ñ –∑–º—ñ–Ω–∏ –≤ —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö —Ç–∞–±–ª–∏—Ü—è—Ö `_hst`.
–û–¥–Ω–∞–∫ —É –¥–µ—è–∫–∏—Ö –≤–∏–ø–∞–¥–∫–∞—Ö –º–æ–∂–µ –∑–Ω–∞–¥–æ–±–∏—Ç–∏—Å—è –≥–Ω—É—á–∫—ñ—à–µ —É–ø—Ä–∞–≤–ª—ñ–Ω–Ω—è —ñ—Å—Ç–æ—Ä—ñ—î—é –∑–º—ñ–Ω, —è–∫–µ –≤–∏—Ö–æ–¥–∏—Ç—å –∑–∞ –º–µ–∂—ñ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –º–µ—Ö–∞–Ω—ñ–∑–º—É.

–ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–∏–π –ø—ñ–¥—Ö—ñ–¥ –ø–µ—Ä–µ–¥–±–∞—á–∞—î —Å—Ç–≤–æ—Ä–µ–Ω–Ω—è –æ–∫—Ä–µ–º–æ—ó —Ç–∞–±–ª–∏—Ü—ñ –¥–ª—è —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö –∑–∞–ø–∏—Å—ñ–≤ —Ç–∞ —ó—Ö–Ω—î –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è –∑–∞ –¥–æ–ø–æ–º–æ–≥–æ—é –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫–∏.

–û—Å–Ω–æ–≤–Ω—ñ –∫—Ä–æ–∫–∏: ::

. –°—Ç–≤–æ—Ä—ñ—Ç—å *–æ–∫—Ä–µ–º—É —Ç–∞–±–ª–∏—Ü—é* –¥–ª—è —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö –∑–∞–ø–∏—Å—ñ–≤.
–ù–∞–ø—Ä–∏–∫–ª–∞–¥, `protocols_history`, —è–∫–∞ –º—ñ—Å—Ç–∏—Ç–∏–º–µ —Å—Ç–∞—Ä—ñ –≤–µ—Ä—Å—ñ—ó –∑–∞–ø–∏—Å—ñ–≤.

. –ü–µ—Ä–µ–¥ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è–º –∞–±–æ –≤–∏–¥–∞–ª–µ–Ω–Ω—è–º –∑–∞–ø–∏—Å—É –≤ `protocols` *–ø–µ—Ä–µ–º—ñ—â—É–π—Ç–µ –π–æ–≥–æ –∫–æ–ø—ñ—é* –≤ `protocols_history`.
–¶–µ –º–æ–∂–Ω–∞ —Ä–µ–∞–ª—ñ–∑—É–≤–∞—Ç–∏ —á–µ—Ä–µ–∑ —Å–ø–µ—Ü—ñ–∞–ª—å–Ω—É –±—ñ–∑–Ω–µ—Å-–ª–æ–≥—ñ–∫—É.

. *–í–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É–π—Ç–µ –æ–∫—Ä–µ–º–∏–π –±—ñ–∑–Ω–µ—Å-–ø—Ä–æ—Ü–µ—Å* –¥–ª—è –∫–µ—Ä—É–≤–∞–Ω–Ω—è –ª–æ–≥—ñ–∫–æ—é –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏—Ö –¥–∞–Ω–∏—Ö.
–¶–µ –¥–∞—î –∑–º–æ–≥—É –≤–∏–∑–Ω–∞—á–∞—Ç–∏, —è–∫—ñ —Å–∞–º–µ –∑–º—ñ–Ω–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –∑–±–µ—Ä—ñ–≥–∞—Ç–∏, —è–∫ –¥–æ–≤–≥–æ —ó—Ö —É—Ç—Ä–∏–º—É–≤–∞—Ç–∏ —Ç–∞ —á–∏ –ø–æ—Ç—Ä—ñ–±–Ω–æ –¥–æ–¥–∞–≤–∞—Ç–∏ –¥–æ–¥–∞—Ç–∫–æ–≤—ñ –º–µ—Ç–∞–¥–∞–Ω—ñ.

–¢–∞–∫–∏–π –ø—ñ–¥—Ö—ñ–¥ –¥–æ–∑–≤–æ–ª—è—î –µ—Ñ–µ–∫—Ç–∏–≤–Ω—ñ—à–µ –∫–µ—Ä—É–≤–∞—Ç–∏ —ñ—Å—Ç–æ—Ä–∏—á–Ω–∏–º–∏ –¥–∞–Ω–∏–º–∏, –∫–æ–ª–∏ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ –º–µ—Ö–∞–Ω—ñ–∑–º—É `_hst` –Ω–µ–¥–æ—Å—Ç–∞—Ç–Ω—å–æ, —ñ –ø–æ—Ç—Ä—ñ–±–Ω–æ –±—ñ–ª—å—à–µ –∫–æ–Ω—Ç—Ä–æ–ª—é –Ω–∞–¥ –ø—Ä–æ—Ü–µ—Å–æ–º –∑–±–µ—Ä–µ–∂–µ–Ω–Ω—è —ñ—Å—Ç–æ—Ä—ñ—ó –∑–º—ñ–Ω.

== –ü–æ–≤'—è–∑–∞–Ω—ñ —Å—Ç–æ—Ä—ñ–Ω–∫–∏

* xref:arch:architecture/registry/operational/registry-management/historical-tables-mechanism.adoc[]