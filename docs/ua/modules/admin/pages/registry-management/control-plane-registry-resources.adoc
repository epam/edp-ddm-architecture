:toc-title: ЗМІСТ
:toc: auto
:toclevels: 5
:experimental:
:important-caption:     ВАЖЛИВО
:note-caption:          ПРИМІТКА
:tip-caption:           ПІДКАЗКА
:warning-caption:       ПОПЕРЕДЖЕННЯ
:caution-caption:       УВАГА
:example-caption:           Приклад
:figure-caption:            Зображення
:table-caption:             Таблиця
:appendix-caption:          Додаток
:sectnums:
:sectnumlevels: 5
:sectanchors:
:sectlinks:
:partnums:

= Керування ресурсами реєстру

Адміністративна панель *Control Plane* надає вам гнучке управління параметрами, використовуючи потужність Платформи. Це ефективний інструмент для керування ресурсами, що використовуються контейнерами в рамках вашого екземпляра реєстру, забезпечуючи оптимальну працездатність та ефективність.

TIP: Керування ресурсами доступне як при розгортанні, так і при оновленні реєстру. Кожний реєстр має розгорнуту конфігурацію сервісів за замовчуванням, яку надалі можна змінити.

== Перелік доступних сервісів

.Перелік доступних сервісів для конфігурації ресурсів
[options="header"]
|===
| +++<b style="font-weight: 600">Сервіс</b>+++ | +++<b style="font-weight: 600">Опис</b>+++
| `bpms` | Сервіс, що керує моделюванням і виконанням бізнес-процесів на Платформі.
| `digitalDocumentService` | Сервіс керує операціями, пов'язаними з цифровими документами, такими як створення, зберігання та управління цифровими документами.
| `digitalSignatureOps` | Сервіс керує операціями, пов'язаними з цифровими підписами, наприклад, створення, перевірка та накладання цифрових підписів та печаток на документи.
| `formManagementProvider` | Сервіс відповідає за управління формами, включаючи створення, редагування та обробку форм даних.
| `kafkaApi` | Сервіс для обробки потокових даних у реальному часі.
| `kong` | Сервіс для авторизації та контролю доступу до внутрішніх API-роутів реєстру. Відповідає за управління роутами, запитами та відповідями API. Також контролює пропускну здатність кількості запитів за одиницю часу від клієнтів до кінцевих сервісів (rate-ліміти).
| `redis` | Сервіс для зберігання даних у пам'яті, що часто використовується як кеш або брокер повідомлень. Наприклад, redis зберігає частину даних бізнес-процесів.
| `restApi` | Сервіс надає інтерфейси REST (Representational State Transfer), які дозволяють взаємодіяти із системою через HTTP-запити.
| `soapApi` | Сервіс надає SOAP (Simple Object Access Protocol) інтерфейси для обміну структурованою інформацією у рамках вебсервісів.
| `sentinel` | Сервіс відповідає за моніторинг та сповіщення безпеки на Платформі.
| `userProcessManagement` | Сервіс відповідає за управління процесами, пов'язаними з користувачами, включаючи створення, відстеження та управління процесами користувачів.
| `userTaskManagement` | Сервіс відповідає за управління задачами користувачів, включаючи створення, відстеження та управління задачами користувачів.
| `Crunchy Postgres` | Це дистрибутив PostgreSQL, оптимізований для високої доступності та безпеки. Цей сервіс забезпечує зберігання даних у базі даних PostgreSQL.
|===

== Налаштування ресурсів

[NOTE]
====
Принцип налаштування ресурсів для усіх сервісів є однаковим, за виключенням `Crunchy Postgres`, для якого передбачені специфічні параметри:

*Max Connections*: вказує на максимальну кількість одночасних з'єднань, які Crunchy Postgres може підтримувати. Тобто, якщо ви вкажете значення `200`, то не більше 200 користувачів або процесів можуть мати відкрите з'єднання із базою даних одночасно.

*Storage Size*: вказує на розмір сховища даних, виділеного для Crunchy Postgres. Тобто якщо ви вкажете значення 10Gi, Crunchy Postgres матиме 10 гігабайтів місця для зберігання даних.
====

. Оберіть зі списку сервіс для конфігурації ресурсів і натисніть *`+`* (`Додати`).
+
[CAUTION]
====
Під час розгортання реєстру усі наявні сервіси налаштовані та передзаповнені відповідними значеннями запитів, лімітів та змінних оточення за замовчуванням.

Навіть у випадку видалення сервісів зі списку, під час розгортання реєстру Платформа застосує стандартну конфігурацію.
====
+
image:admin:registry-management/registry-create/cp-create-registry-7.png[]

. Встановіть власні значення для ресурсів.

Istio sidecar ::
*Sidecar* -- це додатковий контейнер, який запускається поряд з основним контейнером у поді OpenShift. *Istio* використовує підхід *sidecar* для внесення змін у мережеві налаштування без необхідності зміни самого додатку.

* Активуйте параметр *Enabled*. +
Цей параметр вказує, чи включено використання sidecar Istio для цього конкретного сервісу.

* Налаштуйте параметри *Requests* i *Limits*.
+
Ці параметри вказують на оптимальні (*Requests*) та максимальні (*Limits*) ресурси, які мають бути виділені для Istio sidecar.
+
*Requests* -- це мінімум ресурсів, які OpenShift гарантує для контейнера. У нашому прикладі -- це `350m` CPU і `128Mi` пам'яті для Istio sidecar. Якщо контейнер потребує більше ресурсів, і якщо ці додаткові ресурси доступні, OpenShift зможе їх надати.
+
*Limits* -- це максимум ресурсів, які OpenShift дозволить контейнеру використовувати. У нашому прикладі -- це `350m` CPU, `128Mi` пам'яті для Istio sidecar. Якщо контейнер спробує використати більше ресурсів, він може бути примусово зупинений або переведений на нижчий пріоритет у черзі розкладу розгортання подів на нодах.

Container ::
*Container* -- основний контейнер із додатком.

* Налаштуйте параметри *Requests* i *Limits*.
+
Ці параметри вказують на оптимальні (*Requests*) та максимальні (*Limits*) ресурси, які мають бути виділені для основного контейнера.
+
*Requests* -- це мінімум ресурсів, які OpenShift гарантує для контейнера. У нашому прикладі -- це `1` CPU, `2Gi` пам'яті для основного контейнера. Якщо контейнер потребує більше ресурсів, і якщо ці додаткові ресурси доступні, OpenShift може їх надати.
+
*Limits* -- це максимум ресурсів, які OpenShift дозволить контейнеру використовувати. У нашому прикладі -- це `1` CPU, `2Gi` пам'яті для основного контейнера. Якщо контейнер спробує використати більше ресурсів, він може бути примусово зупинений або переведений на нижчий пріоритет у черзі розкладу розгортання подів на нодах.

* +++<b style="font-weight: 600">Змінні оточення</b>+++ (або *environment variables*) -- це динамічні назви значень, що зберігаються в системі й можуть використовуватися різними програмами. Вони особливо корисні в контейнеризованих та розподілених середовищах, таких як Платформа реєстрів, де кожен контейнер або под може мати свої власні змінні оточення. Це дає змогу керувати конфігурацією та поведінкою кожного контейнера або пода індивідуально.
+
Змінна `JAVA_OPTS` використовується для налаштування параметрів JVM (Java Virtual Machine).
+
У цьому випадку, вказані параметри `-Xms1536m` і `-Xmx1536m` встановлюють мінімальний (`-Xms`) та максимальний (`-Xmx`) розмір пам'яті, який JVM може використовувати.
+
TIP: Ви можете прибрати змінні оточення з налаштувань, натиснувши на кнопку *`-`*.

. Натисніть `+++<b style="font-weight: 600">Далі</b>+++`, якщо це крок розгортання реєстру, або `+++<b style="font-weight: 600">Підтвердити</b>+++`, якщо це оновлення конфігурації.
+
image:admin:registry-management/registry-create/cp-create-registry-7-2.png[]
+
При редагуванні реєстру буде сформовано запит на оновлення зі статусом `Новий`.

[start=4]
. Поверніться до розділу +++<b style="font-weight: 600">Реєстри</b>+++, прокрутіть бігунок униз сторінки та знайдіть секцію +++<b style="font-weight: 600">Запити на оновлення</b>+++.
+
image:registry-management/cp-submit-mr/cp-submit-mr-1.png[]

. Відкрийте сформований запит, натиснувши іконку перегляду -- 👁.
+
NOTE: Запропоновані зміни вносяться до конфігурації файлу _deploy-templates/values.yaml_ у разі підтвердження.

. У новому вікні зіставте 2 версії змін, переконайтеся, що внесені вами дані вірні, та натисніть `+++<b style="font-weight: 600">Підтвердити</b>+++`.
+
image:admin:registry-management/registry-create/cp-create-registry-7-3.png[]