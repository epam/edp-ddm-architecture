= Налаштування сертифікатів для перевірки ключів цифрового підпису реєстру
include::platform:ROOT:partial$templates/document-attributes/default-set-ua.adoc[]

include::platform:ROOT:partial$admonitions/language-ua.adoc[]

Внесені сертифікати АЦСК у секції +++<b style="font-weight: 600">Дані для перевірки підписів</b>+++ застосовуються для перевірки ключів системного підпису та КЕП користувачів для налаштувань реєстру.

== Додавання сертифікатів

Для додавання сертифікатів АЦСК необхідно виконати наступні кроки:

. Увійдіть до адміністративної панелі управління реєстрами *Control Plane*, використовуючи попередньо отримані логін та пароль.
+
image:admin:infrastructure/cluster-mgmt/update-cluster-mgmt-01.png[]

. Перейдіть до розділу `Реєстри` та оберіть відповідний реєстр, в якому необхідно завантажити сертифікати для перевірки підпису.
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-01.png[]

. Натисніть кнопку `Редагувати`, що розташована у правому верхньому куті.
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-02.png[]

. Перейдіть до секції +++<b style="font-weight: 600">Дані для перевірки підписів</b>+++

. Додайте публічні сертифікати АЦСК (CACertificates.p7b)

.. Додайте список сертифікатів сумісних ЦСК (_.p7b_). Файл можна отримати на сайті АТ "ІІТ" за посиланням https://iit.com.ua/downloads.
+
[NOTE]
====
При розгортанні та роботі з тестовим реєстром, використовуйте сертифікати тестового АЦСК, інакше пайплайн розгортання реєстру не пройде, а ви отримаєте помилку ініціалізації криптосервісу `digital-signature-ops`. Це станеться через те, що файли сертифікатів для виробничого середовища просто не містять даних про тестові АЦСК.

Для промислового середовища використовуйте відповідні prod-сертифікати.

* Сертифікати АЦСК тестового середовища: https://iit.com.ua/download/productfiles/CACertificates.Test.All.p7b[].
* Сертифікати АЦСК промислового середовища: https://iit.com.ua/download/productfiles/CACertificates.p7b[].
====
+
.. Додайте файл сертифіката, натиснувши кнопку kbd:[Вибрати файл] у полі `Публічні сертифікати АЦСК (розширення .p7b)`. У новому вікні перейдіть до теки, де зберігається файл сертифіката, оберіть його і натисніть kbd:[Відкрити].
+
image:admin:infrastructure/cluster-mgmt/cp-registry-certificates/01-registry-certificates.png[]

. Додайте перелік АЦСК (_.json_).

.. Додайте параметри взаємодії із сумісними ЦСК (_.json_). Файл можна отримати на сайті АТ "ІІТ" за посиланням https://iit.com.ua/downloads.
+
[NOTE]
====
При розгортанні та роботі з тестовим реєстром, використовуйте сертифікати тестового АЦСК, інакше пайплайн розгортання реєстру не пройде, а ви отримаєте помилку ініціалізації криптосервісу `digital-signature-ops`. Це станеться через те, що файли сертифікатів для виробничого середовища просто не містять даних про тестові АЦСК.

Для промислового середовища використовуйте відповідні prod-сертифікати.

* Сертифікати АЦСК тестового середовища: https://iit.com.ua/download/productfiles/CAs.Test.All.json[].
* Сертифікати АЦСК промислового середовища: https://iit.com.ua/download/productfiles/CAs.json[].
====
+
.. Додайте файл сертифіката, натиснувши кнопку kbd:[Вибрати файл] у полі `Перелік АЦСК (розширення .json)`. У новому вікні перейдіть до теки, де зберігається файл з параметрами, оберіть його і натисніть kbd:[Відкрити].
+
image:admin:infrastructure/cluster-mgmt/cp-registry-certificates/02-registry-certificates.png[]

. Натисніть кнопку +++<b style="font-weight: 600">Підтвердити</b>+++
+
[NOTE]
У результаті оновлення даних про ключ на інтерфейсі Control Plane, створюється новий запит на оновлення конфігурації реєстру, який необхідно підтвердити.

. В інтерфейсі адмін-панелі Control Plane поверніться до розділу [.underline]#Реєстри#, прокрутіть бігунок униз сторінки та знайдіть секцію `Запити на оновлення`. Знайдіть потрібний запит та натисніть на перегляд &#128065;
+
image:admin:infrastructure/cluster-mgmt/cp-registry-certificates/03-registry-certificates.png[]

. Прокрутіть донизу та натисніть кнопку +++<b style="font-weight: 600">Підтвердити</b>+++
+
image:admin:infrastructure/cluster-mgmt/cp-registry-certificates/04-registry-certificates.png[]
+
Далі відбувається автоматичний запуск пайплайну *`MASTER-Build-<назва-реєстру>`*, який застосовує параметри заданої конфігурації та створює секрети для ключів цифрового підпису.

. Зачекайте, доки виконається збірка коду. Це може зайняти приблизно 15 хвилин, але все залежатиме від конфігурації певного реєстру.
+
Ви можете перевірити поточний статус та результат виконання за посиланням *`CI`* на інтерфейсі.
+
image:registry-develop:registry-admin/cp-auth-setup-officers/cp-id-gov-ua-iit-setup-6.png[]
+
image:registry-develop:registry-admin/cp-auth-setup-officers/cp-id-gov-ua-iit-setup-7.png[]
+
image:registry-develop:registry-admin/cp-auth-setup-officers/cp-id-gov-ua-iit-setup-8.png[]




