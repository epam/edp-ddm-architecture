= Налаштування сертифікатів для перевірки ключів цифрового підпису реєстру
include::platform:ROOT:partial$templates/document-attributes/default-set-ua.adoc[]

include::platform:ROOT:partial$admonitions/language-ua.adoc[]

== Загальний опис

[.underline]#_Сертифікати для перевірки ключів цифрового підпису_# слугують для підтвердження автентичності публічного ключа, який використовується в процесі цифрового підписання. Їх випускає довірена організація, відома як _Акредитований Центр Сертифікації Ключів (АЦСК)_, і вони відіграють важливу роль у створенні довіри до електронних документів та транзакцій.

[.underline]#_Ключі системного підпису_# призначені для підписання та перевірки даних системами або програмами. Іншими словами, вони допомагають гарантувати, що відповідний пакет даних чи програмне забезпечення походить від відомого джерела і не було змінено.

[.underline]#_КЕП (Кваліфікований електронний підпис)_# -- це покращена версія ЕЦП (Електронний цифровий підпис). Він забезпечує вищий рівень безпеки та довіри, адже для його створення використовуються більш надійні криптографічні алгоритми та процедури. КЕП часто має правову силу і дозволяє підтверджувати автентичність електронних документів в юридичних ситуаціях.

*_CACertificates.p7b_* та *_CA.json_*: ::

* *_CACertificates.p7b_*: цей файл містить один або декілька сертифікатів у форматі `PKCS#7`. Формат `PKCS#7` широко використовується для обміну та зберігання сертифікатів або цілого ланцюжка сертифікатів.

* *_CA.json_*: це файл у форматі JSON, який може містити деталі про сертифікати. Формат JSON інформацію про сертифікати у форматі JSON, який легко читається людиною та машиною.

+
Платформа надає широкі можливості для управління сертифікатами: забезпечує їх безпечне _завантаження_, _зберігання_, _використання_ та _оновлення_.

== Додавання сертифікатів

NOTE: Сертифікати АЦСК для перевірки ключів системного підпису та КЕП користувачів, внесені у секції +++<b style="font-weight: 600">Дані для перевірки підписів</b>+++, будуть застосовані до налаштувань реєстру.

Щоб додати сертифікати АЦСК, виконайте наступні кроки:

. Увійдіть до адміністративної панелі керування реєстрами *Control Plane*, використовуючи попередньо отримані логін та пароль.
+
image:admin:infrastructure/cluster-mgmt/update-cluster-mgmt-01.png[]

. Перейдіть до розділу +++<b style="font-weight: 600">Реєстри</b>+++ та оберіть відповідний реєстр, в якому необхідно завантажити сертифікати для перевірки підпису.
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-01.png[]

. Натисніть кнопку `+++<b style="font-weight: 600">Редагувати</b>+++`, що розташована у правому верхньому куті.
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-02.png[]

. Перейдіть до секції +++<b style="font-weight: 600">Дані для перевірки підписів</b>+++.

. Додайте публічні сертифікати АЦСК (*_CACertificates.p7b_*).

.. Додайте список сертифікатів сумісних ЦСК (_.p7b_). Файл можна отримати на сайті АТ "ІІТ" за посиланням https://iit.com.ua/downloads.
+
[NOTE]
====
При розгортанні та роботі з тестовим реєстром, використовуйте сертифікати тестового АЦСК, інакше пайплайн розгортання реєстру не пройде, а ви отримаєте помилку ініціалізації криптосервісу `digital-signature-ops`. Це станеться через те, що файли сертифікатів для виробничого середовища просто не містять даних про тестові АЦСК.

Для промислового середовища використовуйте відповідні prod-сертифікати.

* Сертифікати АЦСК тестового середовища: https://iit.com.ua/download/productfiles/CACertificates.Test.All.p7b[].
* Сертифікати АЦСК промислового середовища: https://iit.com.ua/download/productfiles/CACertificates.p7b[].
====
+
.. Додайте файл сертифіката, натиснувши кнопку `+++<b style="font-weight: 600">Обрати файл</b>+++` у полі +++<b style="font-weight: 600">Публічні сертифікати АЦСК (розширення .p7b)</b>+++. У новому вікні перейдіть до теки, де зберігається файл сертифіката, оберіть його і натисніть kbd:[Відкрити].
+
image:admin:infrastructure/cluster-mgmt/cp-registry-certificates/01-registry-certificates.png[]

. Додайте перелік АЦСК (*_CA.json_*).

.. Додайте параметри взаємодії із сумісними ЦСК (_.json_). Файл можна отримати на сайті АТ "ІІТ" за посиланням https://iit.com.ua/downloads.
+
[NOTE]
====
При розгортанні та роботі з тестовим реєстром, використовуйте сертифікати тестового АЦСК, інакше пайплайн розгортання реєстру не пройде, а ви отримаєте помилку ініціалізації криптосервісу `digital-signature-ops`. Це станеться через те, що файли сертифікатів для виробничого середовища просто не містять даних про тестові АЦСК.

Для промислового середовища використовуйте відповідні prod-сертифікати.

* Сертифікати АЦСК тестового середовища: https://iit.com.ua/download/productfiles/CAs.Test.All.json[].
* Сертифікати АЦСК промислового середовища: https://iit.com.ua/download/productfiles/CAs.json[].
====
+
.. Додайте файл сертифіката, натиснувши кнопку `+++<b style="font-weight: 600">Обрати файл</b>+++` у полі +++<b style="font-weight: 600">Перелік АЦСК (розширення .json)</b>+++. У новому вікні перейдіть до теки, де зберігається файл з параметрами, оберіть його і натисніть kbd:[Відкрити].
+
image:admin:infrastructure/cluster-mgmt/cp-registry-certificates/02-registry-certificates.png[]

. На завершення перевірте внесену інформацію і натисніть кнопку `+++<b style="font-weight: 600">Підтвердити</b>+++`.
+
[NOTE]
У результаті оновлення даних про ключ на інтерфейсі Control Plane, створюється новий запит на оновлення конфігурації реєстру, який необхідно підтвердити.

. В інтерфейсі адмін-панелі Control Plane поверніться до розділу +++<b style="font-weight: 600">Реєстри</b>+++, прокрутіть бігунок униз сторінки та знайдіть секцію +++<b style="font-weight: 600">Запити на оновлення</b>+++. Знайдіть потрібний запит та натисніть іконку перегляду &#128065;.
+
image:admin:infrastructure/cluster-mgmt/cp-registry-certificates/03-registry-certificates.png[]

. Прокрутіть донизу та натисніть кнопку `+++<b style="font-weight: 600">Підтвердити</b>+++`.
+
image:admin:infrastructure/cluster-mgmt/cp-registry-certificates/04-registry-certificates.png[]
+
Далі відбувається автоматичний запуск пайплайну *MASTER-Build-`<registry-name>`*, який застосовує параметри заданої конфігурації та створює секрети для ключів цифрового підпису.

. Зачекайте, доки виконається збірка коду. Це може зайняти приблизно 15 хвилин, але все залежатиме від конфігурації певного реєстру.
+
Ви можете перевірити поточний статус та результат виконання за посиланням *`CI`* на інтерфейсі.
+
image:registry-develop:registry-admin/cp-auth-setup-officers/cp-id-gov-ua-iit-setup-6.png[]
+
image:registry-develop:registry-admin/cp-auth-setup-officers/cp-id-gov-ua-iit-setup-7.png[]
+
image:registry-develop:registry-admin/cp-auth-setup-officers/cp-id-gov-ua-iit-setup-8.png[]




