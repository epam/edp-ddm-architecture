= Інструкція з налаштування та експлуатації платформи та реєстру у Global регіоні
include::platform:ROOT:partial$templates/document-attributes/default-set-ua.adoc[]

==  Загальний опис

В цій інструкції наведені кроки для налаштування платформи та реєстрів, а також деталі експлуатації платформного та реєстрового функціоналу у Global регіоні.

==  Налаштування

=== Створення платформи та реєстру у UA регіоні

Для початку слід встановити платформу у UA регіоні, використовуючи останню версію інсталеру 1.9.8.
Після успішної інсталяції платформи створіть необхідну кількість реєстрів також у UA регіоні.

=== Налаштування платформи та реєстрів у UA регіоні (optional)

У разі потреби налаштуйте додаткові конфігурації платформи/реєстрів, котрі не є ua-specific.
Наприклад, додайте усіх адміністраторів платформи/реєстрів, зовнішні інтеграції для реєстру, публічний доступ до файлів, поштовий сервер тощо.

=== Перемикання платформи та реєстрів з UA у GLOBAL регіон

Для перемикання платформи у GLOBAL регіон необхідно оновити значення параметру `region` у файлі `deploy-templates/values.yaml` репозиторію `cluster-mgmt`. Відповідно, для перемикання реєстру у GLOBAL регіон необхідно виконати ті ж самі дії для репозиторію `registryName` відповідного реєстру.

Алгоритм дій:

1. Створіть новий change request для репозиторію `cluster-mgmt` в гілці *master*.
2. Додайте на редагування файл `deploy-templates/values.yaml`.
3. Знайдіть у файлі параметр `region`.
4. Змініть значення параметру `region` з `ua` на `global`.
5. Збережіть та підтвердьте зміни.
6. Дочекайтесь успішного завершення автоматично запущеного *MasterBuild* пайплайна.
7. Повторіть кроки 1-6 для репозиторію *registryName*.

[NOTE]
====
Приклади змін зображено на рисунках нижче.
====

.Зміни у файлі deploy-templates/values.yaml для cluster-mgmt
image::registry-management/global-region/2.3.1-values-yaml-change.png[]

.Зміни у файлі deploy-templates/values.yaml для реєстру
image::registry-management/global-region/2.3.2-values-yaml-registry.png[]


== Деталі використання платформного та реєстрового функціоналу у GLOBAL регіоні

=== Адміністративна панель керування платформою та реєстрами (Control plane)

Control plane консоль працює у режиме *Read-Only* у Global регіоні (реліз 1.9.8). Відповідно, наступні функції є неактивними:

* редагування налаштувань платформи
* створення/редагування/видалення реєстру

.Control Plane консоль у Read-Only режимі: секція ‘Керування платформою’
image::registry-management/global-region/3.1.1-control-plane-readonly.png[]

.Control Plane консоль у Read-Only режимі: секція ‘Реєстри’
image::registry-management/global-region/3.1.2-control-plane-readonly-registries.png[]

=== Кабінет адміністратора регламентів

У кабінеті адміністратора регламентів у GLOBAL регіоні відсутні наступні елементи:

==== Секція «Моделі процесів»

Делегати з каталогу типових розширень БП:

* `Get Certificate By Birthdate`
* `Get Certificate By Name`
* `Search Subjects Edr Registry`
* `Get Subject Detail Edr Registry`
* `Idp Exchange Service Registry Connector`
* `Trembita SOAP connector`
* `Signature validation by DSO service` (валідація підписів від 3rd party систем)
* `Digital signature by DSO service` (доступно тільки `System signature by DSO service`)
* `Officer Sign task`
* `Citizen Sign task`
* `Create Keycloak officer user`
* `Save officer user attributes to Keycloak`
* `[deprecated]` делегати

JUEL-функції з переліку функцій для використання в скриптах бізнес-процесів:

* `get_trembita_auth_token`
* `signature_content`
* `signature_details`

==== Секція «Управління користувачами»

Дана секція відсутня у GLOBAL регіоні.

.Кабінет адміністратора регламенту у GLOBAL регіоні
image::registry-management/global-region/3.2.2.1-regulations-admin-cabinet-global.png[]

=== Кабінети користувача та отримувача послуг

У кабінетах користувача та отримувача послуг у GLOBAL регіоні відсутні наступні елементи:

* Атрибути DRFO та EDRPOU для кабінетів користувача та отримувача послуг
* Налаштування *DIIA* каналу звʼязку для кабінету отримувача послуг

==== Профіль користувача
.Сторінка профілю у кабінеті користувача у GLOBAL регіоні
image::registry-management/global-region/3.3.1-officer-profile-global.png[]

==== Профіль отримувача
.Сторінка профілю у кабінеті отримувача послуг у GLOBAL регіоні
image::registry-management/global-region/3.3.2-citizen-profile-global.png[]

[NOTE]
====
Для коректної роботи делегату `sendUserNotificationDelegate` (Send User Notification v2) необхідно мати налаштований поштовий сервер для реєстру та атрибут `fullName` у Keycloak записі користувача.
====
