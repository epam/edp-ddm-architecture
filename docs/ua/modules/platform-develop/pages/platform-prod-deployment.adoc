:toc-title: ЗМІСТ
:toc: auto
:toclevels: 5
:experimental:
:important-caption:     ВАЖЛИВО
:note-caption:          ПРИМІТКА
:tip-caption:           ПІДКАЗКА
:warning-caption:       ПОПЕРЕДЖЕННЯ
:caution-caption:       УВАГА
:example-caption:           Приклад
:figure-caption:            Зображення
:table-caption:             Таблиця
:appendix-caption:          Додаток
:sectnums:
:sectnumlevels: 5
:sectanchors:
:sectlinks:
:partnums:

= Виведення Платформи та реєстрів у промислову експлуатацію

CAUTION: Сторінка у процесі формування.

== Підготовчі дії на рівні Платформи

=== Базові передумови

Для виведення платформи реєстрів в промислову експлуатацію обов'язково слід використовувати віртуальні інфраструктури, що отримують офіційну підтримку (наразі це https://aws.amazon.com/[AWS] та https://www.vmware.com/products/vsphere.html[VSphere]).

На таких інфраструктурах має бути встановлений OKD-кластер, версія якого відповідає вимогам Платформи, згідно з рекомендаціями, викладеними в офіційній документації Платформи (xref:admin:installation/okd-requirements.adoc[]).

Встановлення та налаштування Платформи має виконуватися відповідно до вказівок, наданих в офіційній документації, і проводитися на середовищах, які підтримуються офіційно:

//TODO: check
* xref:admin:installation/platform-aws-deployment.adoc[]
//TODO: TO UPDATE
* xref:admin:installation/platform-admin-deployment.adoc[]

=== Навчання технічного адміністратора реєстру

//TODO: IN PROGRESS

#TBD# ::

* Робота у Control Plane
* Робота з Keycloak
* Чого ще не вистачає?
* xref:registry-develop:study-project/index.adoc[]

TIP: xref:registry-develop:registry-admin-study/reg-admin-study-overview.adoc[]

=== Планування резервного сховища бекапів Платформи та реєстрів

//TODO: Action item on Tolya

Резервні копії (бекапи) зберігаються в окремому сховищі бекапів, яке є S3-сумісним (https://min.io/[]). Параметри цього сховища з погляду доступного місця у сховищі та обчислювальних ресурсів повинні бути враховані, залежно від розміру бекапів.

Основні параметри які враховуються: ::

* Кількість бекапів центральних компонент Платформи (зазвичай розмір одного бекапу приблизно #???100GB ??# (Перевірити з Віталієм та уточнити). #В UA Minio не показує чітко розмірів бекапів. Потрібен можливо аналіз папок бакетів, для цього пропоную залучити Столярова А.#
* Кількість та розмір бекапів реєстру (залежить від реєстру, платформа рекомендує закладати мінімум 20GB на кожен бекап кожного реєстру)
* Реплікація файлів, що підвантажуються до реєстрів (сукупний розмір файлів повинен розраховуватися окремо).

#Рекомендації щодо розміру віртуальний для дефолтного бекап сховища на базі Minio (визначити з Vitalii_Mospan та Roman Kovtun -- може у вас є розуміння?) Мінімал 1/1. Рекомендовано 2/4#.

=== Зберігання цифрових печаток адміністратора для платформи та реєстрів

//TODO: Pasha, Liana or Emil or Zhenya Zvarych

У промисловій експлуатації рекомендованим сховищем зберігання ключів є програмно-апаратний комплекс #*Гряда*#, деталі щодо налаштування знаходяться тут (#*додати посилання*#). Це означає, що технічний адміністратор платформи повинен мати змогу генерувати та сертифікувати ключі для Платформи та реєстрів, що будуть на ній розгорнуті.

#*Нерекомендованим шляхом*#, _який не пройде КСЗІ згідно з законом_, є використання файлових ключів для підпису. Якщо інстанс знаходиться в AWS, потрібно забезпечити #*whitelisting*# зв'язку між дата-центром AWS та відповідними АЦСК (#*додати або створити посилання разом Федоренко*#).

Посилання на документацію: xref:admin:installation/griada-301-deployment.adoc[] #???#

=== Налаштування взаємодії з Трембітою та встановлення Шлюзу Безпечного Обміну (ШБО)

//TODO: Саша Лазебний, Женя Зварич або Еміль

#TBD# ::

Перевірити наявну документацію та дописати (за потреби):

* xref:registry-develop:registry-admin/external-integration/registration-subsystem-trembita/registration-subsystem-trembita.adoc[]

=== Первісна перевірка після розгортання Платформи

#TBD#::

// TODO: Liana

Розгортання Платформи з нуля на цільовому середовищі та первинне тестування (Smoke-тестування: перші кроки після встановлення, які покажуть, що все встановлено правильно).

Наявна документація (перевірити):

* xref:admin:installation/platform-aws-deployment.adoc[]
* xref:admin:installation/platform-admin-deployment.adoc[]

=== Налаштування відправлення повідомлень моніторингу

#TBD#:: Взяти матеріал із сесій по КТ-L2

* Monitoring Alerts

//TODO: Віталій Моспан

=== Налаштування базових бордів в Kibana

* xref:registry-develop:registry-admin/openshift-logging/openshift-logging-overview.adoc[]

=== Налаштування бекапів центральних компонент

* xref:admin:backup-restore/control-plane-components-backup-restore.adoc[]
* xref:admin:backup-restore/backup-schedule-cluster-mgmt.adoc[]

=== Інтеграція з id.gov.ua на рівні Платформи та використання стилізованого віджета

//TODO: Clarify

* xref:registry-develop:registry-admin/cp-auth-setup/cp-auth-setup-officers.adoc[] ?????????
* xref:user:citizen-officer-portal-auth.adoc[]??????

=== Налаштування ключів цифрового підпису Платформи

. Створення ключів та сертифікатів цифрового підпису відбувається під час розгортання платформи (xref:admin:installation/platform-aws-deployment.adoc#preconditions-first-stage[Необхідні елементи для розгортання Платформи]).
* Загальний опис ключів на Платформі: xref:admin:registry-management/system-keys/system-keys-overview.adoc[]

. Оновлення: xref:admin:registry-management/system-keys/control-plane-platform-keys.adoc[]

=== Отримання дозволу для поштового сервера в AWS-середовищі

* xref:admin:installation/internal-smtp-server-setup.adoc#_отримання_дозволу_на_відправку_email_у_aws[Отримання дозволу для поштового сервера в AWS-середовищі]

=== Налаштування обмежень доступу на мережевому рівні до адміністративних ендпоінтів Платформи

* xref:admin:registry-management/control-plane-cidr-access-endpoints.adoc#_обмеження_доступу_до_платформних_інфраструктурних_та_інших_компонентів[Обмеження доступу до платформних, інфраструктурних та інших компонентів]


=== Захист інфраструктури в AWS

#TBD# ::

Ігор Бакало

=== Захист інфраструктури у VSphere

#TBD# ::

Ігор Бакало

=== Оновлення інфраструктурних компонентів Платформи (Оновлення cluster-mgmt)

* xref:admin:update/update_cluster-mgmt.adoc[]

=== Міграція реєстрів

* xref:admin:migrate-registry.adoc[]

=== Спеціальні кроки для оновлення кластера Платформи

* xref:admin:update/special-steps-for-update/special-steps-overview.adoc[]

== Підготовчі дії на рівні реєстрів

=== Рекомендації щодо формування команд підтримки реєстрів L1, L2, L3

#TBD# ::

Визначено на 3-й сесії KT-L2.

=== Створення реєстру та його первинна перевірка

#TBD# ::

//TODO: До Діми Коритова або Ліани

. Додати про розгортання реєстру через Control Plane та smoke-testing.

* xref:admin:registry-management/control-plane-create-registry.adoc[]
* xref:admin:registry-management/control-plane-view-registry.adoc[]

. Додати інформацію про найперші дії, які має виконати тестувальник/адмін регламенту для того, щоб переконатися, що реєстр розгорнуто успішно.

=== Оновлення компонентів реєстру

* xref:admin:update/update-registry-components.adoc[]

=== #*! Типові проблеми з аутентифікацією у користувачів реєстру та при підписанні БП*#

#TBD# ::

//TODO: Check with Liana

* Перевірка ключа на https://id.gov.ua/sign +
* Перевірка, що в у ДСО реєстру і namespace user-management встановлені останні сертифікати ІІТ.

=== Спеціальні кроки для оновлення реєстру

* xref:admin:update/special-steps-for-update/special-steps-overview.adoc[]

=== Зміна режиму розгортання реєстру з production на development

* xref:registry-develop:registry-admin/change-dev-prod-mode.adoc[]

=== Особливості розгортання регламенту в production-середовищі

Розгортання регламенту: ::

* xref:registry-develop:registry-admin/regulations-deploy/registry-regulations-structure.adoc[]
* xref:registry-develop:study-project/index.adoc#preconditions-setup[Що необхідно для початку роботи?]
* xref:registry-develop:registry-admin/regulations-deploy/registry-admin-deploy-regulation.adoc[]
//TODO: UPDATE
* xref:platform-develop:registry-regulations-deployment.adoc[]
* xref:registry-develop:registry-admin/regulations-deploy/registry-regulations-auto-validation.adoc[]
* xref:registry-develop:registry-admin/admin-portal/overview.adoc[]

Інші корисні документи: ::
* xref:registry-develop:study-project/index.adoc[]

=== Рекомендований алгоритм внесення змін до регламенту реєстру

#TBD#

//TODO: Уточнити, які наші рекомендації

Оновлення компонентів регламенту відбувається за тим самим підходом, що й розгортання: файли оновлюються в локальному середовищі, публікуються до віддаленого Gerrit-репозиторію. Пайплайн публікацій відстежує зміни у файлах директорій регламенту, і при git merge змін до майстер-гілки репозиторію, спрацьовує пайплайн публікацій `Master-build-registry-regulations`, який збирає увесь код. Після виконання пайплайну, зміни набувають чинності, а регламент оновлюється до нової версії останнього комміта.

Також розказати про те, що у нас є можливість оновлювати регламент як за хардкорним шляхом, так і за більш зручним.

_Хардкорний шлях_ -- це робота з каталогами файлів, git та Gerrit, через Git Bash консоль, або в інших інструментах, робота з Jenkins тощо.

_Зручний спосіб_ -- це використання нового порталу адміністратора регламенту та його вбудованих можливостей.

* xref:registry-develop:registry-admin/regulations-deploy/registry-admin-deploy-regulation.adoc[]
* xref:registry-develop:registry-admin/admin-portal/overview.adoc[]

Інші корисні документи: ::

* xref:registry-develop:study-project/index.adoc[]

=== Налаштування ключів та сертифікатів цифрового підпису реєстру

. Створення ключів та сертифікатів цифрового підпису відбувається під час розгортання реєстру (_див. xref:admin:registry-management/control-plane-create-registry.adoc[]_).
* Загальна інформація про типи ключів на Платформі реєстрів: xref:admin:registry-management/system-keys/system-keys-overview.adoc[]
. Оновлення ключів та сертифікатів цифрового підпису:
* xref:admin:registry-management/system-keys/control-plane-registry-keys.adoc[]

=== Налаштування поштового клієнта (SMTP сервер)

* xref:admin:installation/internal-smtp-server-setup.adoc[]
* xref:registry-develop:registry-admin/user-notifications/email/config-smtp-server.adoc[]

=== Налаштування взаємодії з Дією

* Загальний алгоритм описаний тут: xref:registry-develop:registry-admin/external-integration/ext-integration-overview.adoc#exchange-data-ext-system[Обмін даними з іншими системами за допомогою REST]

* xref:registry-develop:registry-admin/external-integration/cp-integrate-ext-system.adoc[]

* xref:registry-develop:bp-modeling/bp/rest-connector.adoc[]

=== Налаштування взаємодії з іншими реєстрами та зовнішніми системами

* Загальний алгоритм описаний тут: xref:registry-develop:registry-admin/external-integration/ext-integration-overview.adoc#exchange-data-ext-system[Обмін даними з іншими системами за допомогою REST]

* xref:registry-develop:registry-admin/external-integration/cp-integrate-ext-system.adoc[]

* xref:registry-develop:bp-modeling/bp/rest-connector.adoc[]

* xref:registry-develop:registry-admin/external-integration/rest-api-no-trembita.adoc[]

=== Налаштування взаємодії через Трембіту на базі стандартних конекторів

* Загальний алгоритм описаний тут: xref:registry-develop:registry-admin/external-integration/ext-integration-overview.adoc#exchange-data-trembita[Обмін даними за допомогою SOAP через програмний інтерфейс "Трембіта"]
* xref:registry-develop:registry-admin/external-integration/cp-integrate-trembita.adoc[]

* xref:registry-develop:bp-modeling/external-integration/api-call/connectors-external-registry.adoc[]

=== Конфігурація реєстру під навантаження

#TBD# ::

// TODO: ask Yevgen Mospan

Поки незрозуміло, про що мова.

#Йдеться про можливість обрати шаблон реєстру із необхідною кількістю ресурсів?#

Чи, можливо, про розділ із ресурсами у Control Plane?

=== Планування місця для сховищ реєстру

#TBD# :: Доки від Віталія, передивитися запис по KT-L2, session 2.

_До Стаса/Віталія._

Наявна документація:

* xref:admin:file-system/ceph-space.adoc[]
* xref:admin:file-system/ceph_scaling.adoc[]

=== Отримання доступу для L2 до системи сповіщень, моніторингу та логування у реєстрі

#TBD# :: _До Віталія_

Сповіщення які: monitoring alerts?

=== Налаштування бекапів реєстру

* xref:admin:backup-restore/control-plane-backup-restore.adoc[]
* xref:admin:backup-restore/backup-schedule-registry-components.adoc[]

=== Налаштування реплікації файлів реєстру

#TBD# ::

#?..?#

//TODO: Щось про реплікейшн-джобу, до Толі або Олесі

=== Інтеграція з http://id.gov.ua[id.gov.ua] на рівні реєстру та використання стилізованого віджета

* xref:registry-develop:registry-admin/cp-auth-setup/cp-auth-setup-officers.adoc[]

* xref:user:citizen-officer-portal-auth.adoc[]






//TODO: HERE






=== Визначення порядку надання доступу надавачам послуг адміністратором доступу

#TBD# ::

До Ліани.

=== Рекомендації щодо онбордингу надавачів та отримувачів послуг

* Надавачам послуг:

** xref:registry-develop:registry-admin/cp-auth-setup/cp-officer-self-registration.adoc[]
** xref:registry-develop:best-practices/bp-officer-self-register-manual.adoc[]
** xref:registry-develop:best-practices/bp-officer-self-register-auto.adoc[]

* Отримувачам послуг:

#TBD# ::

//TODO:Оновлено процес онбордингу в рамках https://jiraeu.epam.com/browse/MDTUDDM-17161
* xref:arch:architecture/platform/operational/user-management/citizen-onboarding.adoc[]

=== Аутентифікація юридичних осіб до реєстру як отримувачів послуг

* xref:registry-develop:registry-admin/cp-auth-setup/cp-auth-setup-citizens.adoc[]
* xref:user:citizen-officer-portal-auth.adoc[]

=== Рекомендації щодо уникнення "покинутих" бізнес-процесів користувачами

#TBD# :: Не зрозуміло, про що йде мова. Уточнити у БА/QA

Cleanup?
xref:registry-develop:registry-admin/regulations-deploy/cleanup-job.adoc[]

=== Налаштування рейт-лімітів

* xref:registry-develop:registry-admin/api-rate-limits.adoc[]

=== Налаштування обмежень доступу на мережевому рівні до адміністративних ендпоінтів реєстру, кабінетів отримувачів та надавачів послуг (CIDR)

* xref:admin:registry-management/control-plane-cidr-access-endpoints.adoc#cidr-registry-components[Обмеження доступу до компонентів реєстру]

=== Налаштування власних DNS-імен

* xref:admin:registry-management/custom-dns/custom-dns-overview.adoc[]

=== Додавання нових користувачів (через Keycloak та імпорт)


* xref:registry-develop:registry-admin/create-users/manual-user-creation.adoc[]

* xref:registry-develop:registry-admin/create-users/import-users-officer.adoc[]

=== Призначення адміністраторів Платформи та реєстру

* xref:admin:registry-management/control-plane-assign-platform-admins.adoc[]

* xref:registry-develop:registry-admin/create-users/create-registry-admins.adoc[]

//TODO: Підправити наявні документи відповідно до останнього діалогу з Ліаною (незначні зміни).

=== Розгортання геосервера та робота з геоданими у реєстрі

* xref:registry-develop:registry-admin/geoserver.adoc[]

=== Первинне завантаження та дозавантаження даних до системи

. Первинне завантаження/дозавантаження даних до таблиць-довідників через процедуру на рівні моделі даних:

* xref:registry-develop:data-modeling/initial-load/index.adoc[]

. Завантаження даних із CSV-файлу масивом до БД (в рамках виконання бізнес-процесу):

* xref:registry-develop:bp-modeling/bp/loading-data-from-csv.adoc[]

[TIP]
====
Додаткові корисні матеріали:

Навчальний курс (Приклад первинного завантаження даних при проходженні тестового завдання):

* xref:registry-develop:study-project/study-tasks/task-1-registry-db-modeling.adoc[]
====

== Рекомендації щодо нефункціонального тестування реєстрів на платформі

=== Тестування продуктивності

//TODO: До Жені -- Якими інструментами ми виконуємо performance-тестування?
+
Тестування проводимо для кожного окремого реєстру.

* xref:testing:perf-test/1-9-3/perf-test-1-9-3.adoc[]

=== Тестування безпеки

Кажемо, що це *out-of-the-box*. Платформа регулярно тестується. Нічого робити не треба.
