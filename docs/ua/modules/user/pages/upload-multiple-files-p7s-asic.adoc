:toc-title: ЗМІСТ
:toc: auto
:toclevels: 5
:experimental:
:important-caption:     ВАЖЛИВО
:note-caption:          ПРИМІТКА
:tip-caption:           ПІДКАЗКА
:warning-caption:       ПОПЕРЕДЖЕННЯ
:caution-caption:       УВАГА
:example-caption:           Приклад
:figure-caption:            Зображення
:table-caption:             Таблиця
:appendix-caption:          Додаток
:sectnums:
:sectnumlevels: 5
:sectanchors:
:sectlinks:
:partnums:

= Завантаження файлів формату p7s та asics у Кабінетах

== Загальний опис

Платформа надає можливість завантажувати файли різних форматів до фабрики даних на формах Кабінетів користувачів. Користувачі можуть завантажити як одиничні файли, так і масив файлів визначених форматів.

Наразі підтримується завантаження (Upload) файлів наступних форматів: ::

* `.pdf`
* `.jpg`
* `.png`
* `.asics`
* `.p7s`

[TIP]
====
Детальніше про те, як змоделювати завантаження файлів на UI-формі та визначити допустимі формати в рамках бізнес-процесу, дивіться на сторінці xref:registry-develop:bp-modeling/forms/components/file/component-file-multiple-values.adoc[].
====

[.underline]#Окремим випадком# є функціональність [.underline]#завантаження/дозавантаження даних до БД масивом із CSV-файлу#.

[TIP]
====
Детальніше дивіться на сторінці xref:registry-develop:bp-modeling/bp/loading-data-from-csv.adoc[]
====

У цій статті розглянемо, як один із прикладів, завантаження файлів специфічних форматів `*.asics*` та `*.p7s*` у Кабінетах посадової особи та отримувача послуг. Вміст файлів і валідність КЕП, яким їх підписували, не перевіряється.

== Бізнес-процес завантаження файлів форматів asics та p7s

TIP: Файли форматів `*.asics*` та `*.p7s*` -- документи, що вже підписані КЕП.

Існує законодавча вимога для певних реєстрів (наприклад, Реєстр пошкодженого та знищеного майна) завантажувати акти оцінки у вигляді файлів, які вже підписані КЕП організації, що видала акт.

Наприклад, загальний процес може бути таким: ::
* Комісія складає акт про пошкоджене майно.
* Уповноважена особа завантажує акт в електронному вигляді (формат файлу *.pdf, *.docx тощо) на сайті https://id.gov.ua/.
* Підписує файл за допомогою КЕП.
* Вивантажує цей акт у форматі `.p7s` або `.asics`.
* Після цього підписаний акт необхідно завантажити в рамках бізнес-процесу до реєстру на Платформі для подальшого опрацювання.

'''
. Виконайте вхід до особистого Кабінету.
+
TIP: Детальніше про автентифікацію користувачів реєстру -- за xref:citizen-officer-portal-auth.adoc#kep-auth[посиланням].

. Перейдіть до розділу [.underline]#Доступні послуги# та оберіть попередньо змодельований бізнес-процес для завантаження файлів.
+
image:user:upload-files/p7s-asic/upload-multiple-values-p7s-asic-1.png[]

. Завантажте файли на форму: перетягніть або оберіть у каталозі на своєму носієві.

+
image:user:upload-files/p7s-asic/upload-multiple-values-p7s-asic-2-01.png[]

+
image:user:upload-files/p7s-asic/upload-multiple-values-p7s-asic-2-1.png[]

. Натисніть `Далі` для опрацювання файлів.

+
image:user:upload-files/p7s-asic/upload-multiple-values-p7s-asic-2.png[]

. У випадку вдалої операції, користувач побачить відповідне сповіщення у правому верхньому куті екрану:
+
`✅ Задача <Назва задачі> виконана успішно!`

+
image:user:upload-files/p7s-asic/upload-multiple-values-p7s-asic-3.png[]
+
[NOTE]
====
Якщо файли не відповідають передбаченому формату, то користувач отримає валідаційну помилку:

`Підтримувані формати *.p7s, *.asics. Будь ласка, завантажте файли підтримуваного формату.`

image:user:upload-files/p7s-asic/upload-multiple-values-p7s-asic-4.png[]
====

. Перейдіть на форму підписання даних КЕП, зчитайте особистий ключ та натисніть `Підписати`.

+
image:user:upload-files/p7s-asic/upload-multiple-values-p7s-asic-5.png[]

+
image:user:upload-files/p7s-asic/upload-multiple-values-p7s-asic-6.png[]

. У випадку успішного підписання даних, користувач отримає відповідне сповіщення у правому верхньому куті на екрані:
+
`✅ Задача <Назва задачі> виконана успішно!`
+
image:user:upload-files/p7s-asic/upload-multiple-values-p7s-asic-7.png[]
+
[NOTE]
====
Ви можете також відредагувати завантажені файли на окремій UI-формі бізнес-процесу, тобто видалити помилкові та завантажити правильні, натиснувши на хрестик (`*x*`) зліва біля файлу.

При спробі завантажити файл з однаковою назвою, користувач отримає валідаційну помилку:

`Файл із такою назвою вже завантажено`.

image:user:upload-files/p7s-asic/upload-multiple-values-p7s-asic-8.png[]

Після редагування та завантаження коректних файлів, користувач отримає відповідне сповіщення у правому верхньому куті на екрані:

`✅ Задача <Назва задачі> виконана успішно!`.

Підпишіть дані КЕП та завершіть процес.

image:user:upload-files/p7s-asic/upload-multiple-values-p7s-asic-9.png[]
====

. Перейдіть до списку виконаних задач та переконайтеся, що усі задачі з процесу дійсно виконані.
+
[.underline]#В результаті файли будуть завантажені масивом до фабрики даних#.
+
image:user:upload-files/p7s-asic/upload-multiple-values-p7s-asic-10.png[]