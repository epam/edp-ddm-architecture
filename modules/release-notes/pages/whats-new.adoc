:toc-title: ЗМІСТ
:toc: auto
:toclevels: 5
:experimental:
:important-caption:     ВАЖЛИВО
:note-caption:          ПРИМІТКА
:tip-caption:           ПІДКАЗКА
:warning-caption:       ПОПЕРЕДЖЕННЯ
:caution-caption:       УВАГА
:example-caption:           Приклад
:figure-caption:            Зображення
:table-caption:             Таблиця
:appendix-caption:          Додаток
:sectnums:
:sectnumlevels: 5
:sectanchors:
:sectlinks:
:partnums:

= Що нового у версії 1.9?

== Зміни у версії 1.9.2

=== Моделювання регламенту

==== Поєднання таблиць за допомогою JOIN із додатковими умовами AND та OR

Ми розширили можливості використання операції `*JOIN*` для поєднання таблиць-представлень (Search Conditions) у БД додатковою умовою `*OR*`, окрім вже наявної `AND`.

Тепер адміністратор регламенту зможе використовувати нову функціональність при роботі з моделлю даних реєстру.

Операція `*<ext:join>*` дозволяє поєднувати таблиці за певними умовами. Використовується при створенні критеріїв пошуку всередині тегу `*<ext:createSearchCondition>*` для отримання необхідних даних у зведених таблицях.

Операцію `*<ext:join>*` можна використовувати із додатковими умовами `*and*` та `*or*`, які визначаються в рамках тегу `*<ext:condition>*` як значення атрибута `*logicOperator*`.

[TIP]
====
Детальніше про функціональність ви можете переглянути на сторінках:

* xref:registry-develop:data-modeling/data/physical-model/liquibase-ddm-ext.adoc[]
* xref:registry-develop:data-modeling/data/physical-model/join-and-or-usage.adoc[]
====

==== Валідація бізнес-процесів за XSD-схемою
//https://jiraeu.epam.com/browse/MDTUDDM-21815

У цьому релізі імплементовано [.underline]#валідацію бізнес-процесів за XSD-схемою#.

Створено XSD-схему для валідації бізнес-процесів.
XSD імпортує схему Camunda та додатково валідує бізнес-назву процесу на наявність.

Створено кастомний валідатор бізнес-процесу через `spring-boot-starter-validation`.

image::registry-develop:registry-admin/admin-portal/process-models/process-models-12-1.png[]

[TIP]
====
Детальніше про функціональність ви можете переглянути на сторінці:

* xref:registry-develop:registry-admin/admin-portal/registry-modeling/process-models/components/tab-code.adoc[]
====

==== Валідація полів при створенні нового запита на внесення змін

Ми впровадили валідацію полів `Назва версії` та `Опис зміни` при створенні нового запита на внесення змін до регламенту реєстру.

Якщо поле `Опис зміни` міститиме подвійні лапки (`""`), то ви не зможете створити запит на внесення змін, оскільки спрацює валідація. Така ж логіка спрацює для інших перевірчих правил, описаних у підказці до кожного поля. При цьому на інтерфейсі ви побачите відповідну помилку у вигляді підказки: `"Перевірте формат поля"`:

image:registry-develop:registry-admin/admin-portal/new-admin-portal-3-1.png[]

[TIP]
====
Детальніше про функціональність ви можете переглянути на сторінці:

* xref:registry-develop:registry-admin/admin-portal/version-control/create-new-change-request.adoc[]
====

=== Кабінети посадової особи та отримувача послуг

==== Завантаження файлів формату p7s та asics на UI-формі
//https://jiraeu.epam.com/browse/MDTUDDM-21820

У цьому релізі ми розробили функціональність, яка дозволяє посадовим особам та отримувачам послуг реєстру [.underline]#працювати з файлами у форматах *`p7s`* та *`asics`* та використовувати їх у рамках бізнес-процесів#. Ці файли є документами, що підписані КЕП, і мають специфічне розширення.

image:user:upload-files/p7s-asic/upload-multiple-values-p7s-asic-2.png[]

Користувачі кабінетів можуть [.underline]#завантажити, або дозавантажити один або декілька таких файлів на UI-формі бізнес-процесу# до фабрики даних як один масив.

[TIP]
====
Детальніше про функціональність та особливості завантаження файлів ви можете переглянути на сторінках:

* xref:user:upload-multiple-files-p7s-asic.adoc[]
* xref:registry-develop:bp-modeling/forms/component-file-multiple-values.adoc[]
====

=== Керування Платформою та реєстрами у Control Plane

==== Керування розкладом створення резервних копій центральних компонент та часом їх зберігання
//https://jiraeu.epam.com/browse/MDTUDDM-21045

Відтепер Платформа дозволяє [.underline]#керувати розкладом створення резервних копій центральних компонентів, а також часом зберігання таких резервних копій у сховищі бекапів#.

image:admin:backup-restore/backup-schedule-cluster-mgmt/cp-backup-schedule-2.png[]

Перелік центральних компонентів, для яких можна налаштувати резервне копіювання за розкладом та час зберігання резервних копій: ::

* Сховище артефактів -- центральний компонент *`nexus`*.
* Панель керування Платформою та реєстрами -- центральний компонент *`control-plane`*.
* Керування користувачами -- центральний компонент *`user-management`*.
* Моніторинг -- центральний компонент *`monitoring`*.

[TIP]
====
Детальніше про функціональність ви можете переглянути на сторінці:

* xref:admin:backup-restore/backup-schedule-cluster-mgmt.adoc[]
====

== Зміни у версії 1.9.1

=== Адміністрування регламенту реєстру

==== Перевірка поля "Опис зміни" на наявність подвійних лапок при створенні нової версії змін

У цьому релізі ми імплементували додаткову [.underline]#валідацію при створенні нової версії-кандидата на внесення змін# у Кабінеті адміністратора регламенту.

При заповненні поля `Опис зміни` спрацьовує [.underline]#перевірка наявності подвійних лапок#.

image:registry-develop:registry-admin/admin-portal/new-admin-portal-3-1.png[]

NOTE: Довжина рядка -- до 512 символів. Допускаються всі символи, окрім `""` (подвійні лапки). Замість них використовуйте `''` (одинарні лапки).

Якщо поле `Опис зміни` міститиме подвійні лапки (`""`), то ви не зможете створити запит на внесення змін, оскільки спрацює валідація. При цьому на інтерфейсі ви побачите відповідну помилку у вигляді підказки: `"Перевірте формат поля"`.

[TIP]
====
Детальніше про функціональність ви можете переглянути на сторінці:

* xref:registry-develop:registry-admin/admin-portal/version-control/create-new-change-request.adoc[]
====

==== Валідація обов'язкових полів при збереженні змін на усіх вкладках бізнес-процесів та UI-форм

У цьому релізі ми зробили [.underline]#перевірку обов'язкових полів при збереженні змін для усіх вкладок бізнес-процесів та UI-форм# у Кабінеті адміністратора регламентів. Це дозволить уникнути збереження невалідних даних, або порожніх значень.

image:registry-develop:registry-admin/admin-portal/process-models/process-models-5-1.png[]

Коли користувач намагається зберегти зміни при створенні, або редагуванні бізнес-процесу, чи UI-форми, та знаходиться на будь-якій вкладці розділів [.underline]#Моделі процесів# та [.underline]#UI-форми#, то на усіх вкладках цих розділів спрацьовує валідація.

image:registry-develop:registry-admin/admin-portal/ui-forms/json-code/form-json-code-view-edit-5.png[]

[TIP]
====
Детальніше про оновлення ви можете переглянути на сторінках:

* xref:registry-develop:registry-admin/admin-portal/registry-modeling/process-models/create-process.adoc[]
* xref:registry-develop:registry-admin/admin-portal/registry-modeling/ui-forms/json-code-view-edit.adoc[]
====

==== Перегляд структури таблиць для майстер-версії регламенту: вкладка "Загальна"

Ми реалізували можливість переглядати структуру таблиць бази даних реєстру при роботі з майстер-версією регламенту у Кабінеті адміністратора. Працювати з таблицями можливо _лише_ у режимі перегляду (`read-only`). Імплементовано розбивку інтерфейсу за вкладками, зокрема впроваджено вкладку [.underline]#Загальна#.

image:registry-develop:registry-admin/admin-portal/tables-data-structures/tables-data-structures-6.png[]

Тепер адміністратори можуть швидко переглянути основну інформацію про таблицю та деякі її атрибути.

[TIP]
====
Детальніше про функціональність ви можете переглянути на сторінці:

* xref:registry-develop:registry-admin/admin-portal/registry-modeling/tables-data-structures.adoc[]
====

==== Перегляд структури таблиць для майстер-версії регламенту: вкладка "Індекси"

Ми реалізували можливість переглядати структуру таблиць бази даних реєстру при роботі з майстер-версією регламенту у Кабінеті адміністратора. Працювати з таблицями можливо _лише_ у режимі перегляду (`read-only`). Імплементовано розбивку інтерфейсу за вкладками, зокрема впроваджено вкладку [.underline]#Індекси#.

image:registry-develop:registry-admin/admin-portal/tables-data-structures/tables-data-structures-7.png[]

Вкладка [.underline]#Індекси# дозволяє переглядати перелік індексів конкретної таблиці у базі даних, а також правил, за якими вони працюють. Використання індексів та правил при пошуку даних у БД підвищує ефективність виконання запитів та пришвидшує вибірку.

[TIP]
====
Детальніше про функціональність ви можете переглянути на сторінці:

* xref:registry-develop:registry-admin/admin-portal/registry-modeling/tables-data-structures.adoc[]
====

==== Створення бізнес-процесів із використанням функціональності вкладки "Код"

Використовуйте можливості вкладки [.underline]#Код# для моделювання бізнес-процесів. Функціональність дозволяє працювати напряму з кодом процесу, тобто його XML-представленням.

image::registry-develop:registry-admin/admin-portal/process-models/process-models-11.png[]

Доступ до XML-коду відкриває нові можливості та полегшує моделювання, коли потрібно, наприклад:

* швидко підправити шматки діаграми (назву процесу, задач тощо);
* мігрувати старі бізнес-процеси, змодельовані в інших редакторах та системах (Camunda Modeler тощо);
* швидко інтегрувати процес до регламенту, якщо його передали електронною поштою, або у чаті;
* використати корисні приклади при розробці бізнес-процесу: шматки коду із різних тематичних спільнот (Stack Overflow, Camunda, BPMN-спільноти тощо), або готові рішення для ваших бізнес-процесів та задач.

Просто скопіюйте готову BPMN-діаграму та вставте XML-опис у відповідне поле на вкладці [.underline]#Код#.

[TIP]
====
Детальніше про функціональність ви можете переглянути на сторінці:

* xref:registry-develop:registry-admin/admin-portal/registry-modeling/process-models/components/tab-code.adoc[]

====

=== Кабінет посадової особи

==== Попередня валідація даних у СSV-файлі на користувацькій формі

У цьому релізі ми імплементували [.underline]#попередню валідацію даних у CSV-файлі одразу на UI-формі# Кабінету посадової особи.
Таким чином розширено функціональність завантаження даних до БД масивом з СSV-файлу.

Тепер, у випадку помилки, [.underline]#система попереджує# користувача [.underline]#про невідповідність формату та даних CSV-файлу ще до переходу на форму підписання# КЕП.

image::registry-develop:bp-modeling/bp/loading_data_from_csv/loading_data_from_csv-27.png[]

Наразі Платформа підтримує 3 типи перевірок при завантаженні файлу на UI-формі: ::

* [*] Перевірка формату (розширення) та кодування.
* [*] Перевірка кількості записів у файлі.
* [*] Перевірка структури даних, що завантажуються.

[TIP]
====
Детальніше про функціональність ви можете переглянути на сторінці:

* xref:registry-develop:bp-modeling/bp/loading-data-from-csv.adoc[]
====

==== Сортування послуг у виконанні за статусом

У цьому релізі ми імплементували можливість [.underline]#сортувати власні послуги у виконанні за статусом# для Кабінету посадової особи.

Реалізовано підтримку як висхідного `↑`, так і низхідного `↓` сортування за алфавітом для колонки `Статус виконання`.

image:user:officer-bp-sorting-by-status/officer-bp-sorting-by-status-1.png[]

При сортуванні, послуги групуються за статусом (`Очікує виконання задачі`, `У виконанні`, `Призупинено адміністратором` тощо), а також автоматично спрацьовує додаткова прив'язка до сортування за датою старту (ініціювання послуги). Таким чином при натисканні клавіші `Статус виконання`, послуги будуть також автоматично відсортовані й за датою старту, що дозволяє показувати згруповані заявки, що були створені раніше, знизу, або зверху у списку, залежно від типу сортування, яке ви застосуєте -- висхідне `↑`, або низхідне `↓`.

image:user:officer-bp-sorting-by-status/officer-bp-sorting-by-status-2.png[]

Таким чином, для кожного окремого статусу, відсортованого за алфавітом, працюватиме й окреме сортування за датою старту послуги.

[TIP]
====
Детальніше про функціональність ви можете переглянути на сторінці:

* xref:user:officer/sorting-pagination/officer-portal-bp-sorting-by-status.adoc[]
====

=== Інфраструктура

==== Доступ до реєстрових Jenkins та Gerrit через Kong API Gateway

У цьому релізі ми [.underline]#винесли сервіси Jenkins та Gerrit реєстру за Kong API Gateway#. Це дозволяє мати єдину точку входу до реєстрових роутів Jenkins та Gerrit через API-шлюз Kong для адміністраторів Платформи.

Функціональність забезпечує додатковий [.underline]#захист адміністративних ендпоінтів реєстру#, а також [.underline]#покращує безпекові характеристики Платформи# в цілому.

[TIP]
====

Детальніше про оновлення ви можете переглянути на сторінці:

* xref:arch:architecture/registry/administrative/ext-api-management/registry-admin-routes.yaml.adoc[]
====

== Зміни у версії 1.9.0

=== Моделювання бізнес-процесів

==== Делегат для пошуку користувачів за КАТОТТГ, ЄДРПОУ, ДРФО та ПІБ

Розроблено типове інтеграційне розширення-конектор *Keycloak Get Officer Users By Attributes Equals And Start With*.

image:registry-develop:bp-modeling/bp/element-temp/search-by-katottg-attr/search-by-katottg-attr-3.png[]

Делегат потрібний для того, щоб при виконанні бізнес-процесу отримувати список користувачів (посадових осіб) за атрибутами `KATOTTG`, `edrpou`, `drfo` та `fullName` із сервісу керування ідентифікацією та доступом Keycloak.

Пошук за атрибутами `edrpou`, `drfo` та `fullName` здійснюється за допомогою функції `equal`, яка повертає значення, що мають точну відповідність (дорівнюють) заданим.

Пошук за атрибутом `KATOTTG` здійснюється за допомогою функції `Inverse startsWith`, яка повертає значення зі вказаним префіксом, тобто значення, які "починаються із" заданої умови.

image:registry-develop:bp-modeling/bp/element-temp/search-by-katottg-attr/search-by-katottg-attr-1.png[]

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:registry-develop:bp-modeling/bp/element-templates/keycloak-get-officer-users-by-attributes-equals-start-with.adoc[]
====

==== Моделювання відправлення повідомлень користувачам

Для моделювання бізнес-процесу розроблено типове розширення для задач на відправлення повідомлення (Send Task) -- *Send User Notification*.

image:registry-develop:registry-admin/e-mail-notification/e-mail-notification-03.png[]

Розширення *Send User Notification* -- делегат для відправлення повідомлень отримувачам послуг через канали зв'язку *_inbox_*, *_email_*, *_diia_* з використанням заданих шаблонів у структурі регламенту реєстру.

Імплементовано підтримку двох сценаріїв моделювання відправлення повідомлень у межах моделювання бізнес-процесів:

* Відправлення повідомлень одному користувачу -- за допомогою базових налаштувань делегата.
+
image:registry-develop:registry-admin/e-mail-notification/e-mail-notification-01.png[]

* Відправлення повідомлень багатьом користувачам -- за допомогою
використання функції мультиекземпляра (Multi Instance). Ця функція дозволяє виконати одночасне відправлення повідомлень усім зазначеним користувачам із масиву.

image:registry-develop:registry-admin/e-mail-notification/e-mail-notification-07.png[]

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:registry-develop:registry-admin/user-notifications/user-notifications-overview.adoc[]
====

==== Завантаження даних із CSV-файлу масивом до БД

Можливість завантаження даних масивом до БД дозволяє створювати бізнес-процеси, завдяки яким користувачі реєстру можуть вносити масив даних одним файлом, наприклад, наповнення довідників реєстру або дозавантаження даних.

image:registry-develop:bp-modeling/bp/loading_data_from_csv/loading_data_from_csv-05.png[]

image:registry-develop:bp-modeling/bp/loading_data_from_csv/loading_data_from_csv-04.png[]

image:registry-develop:bp-modeling/bp/loading_data_from_csv/loading_data_from_csv-23.png[]

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:registry-develop:bp-modeling/bp/loading-data-from-csv.adoc[]
====

=== Моделювання UI-форм до бізнес-процесів

==== Перегляд та редагування коду JSON-представлення форми

Платформа надає можливість переглядати та редагувати JSON-представлення форми на вкладці [.underline]#Код#.

Функціональність дозволяє швидко та легко внести зміни до даних форми без використання конструктора для моделювання.

image:registry-develop:registry-admin/admin-portal/ui-forms/json-code/form-json-code-view-edit-3.png[]

Редагування складових регламенту реєстру можливо внести лише в рамках версій-кандидатів на внесення змін. Для майстер-версії доступна лише опція перегляду.

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:registry-develop:registry-admin/admin-portal/registry-modeling/ui-forms/json-code-view-edit.adoc[]
====

==== Сортування форм за датою і часом створення або редагування. Дослідження історичності форм

Платформа дозволяє відсортувати наявні форми за датою і часом створення або редагування у Кабінеті адміністратора регламентів. Такий тип сортування надає можливість сформувати висхідний, або низхідний список форм для зручності та покращення користувацького досвіду.

image::registry-develop:registry-admin/admin-portal/ui-forms/sorting/form-sorting-3.png[]

Після редагування форми, змінюється дата і час редагування, а форма підіймається уверх списку, якщо обрано низхідне сортування.

При застосуванні змін до майстер-версії, усі гілки-кандидати автоматично отримують оновлення, включно з датами редагування форм.

Такий підхід дозволяє розробникам регламенту працювати у різних гілках-кандидатах на внесення змін та досліджувати історичність форм.

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:registry-develop:registry-admin/admin-portal/registry-modeling/ui-forms/sorting-forms.adoc[]
====

==== Налаштування типу сортування для колонок у компоненті Edit Grid

При роботі з компонентом *Edit Grid* моделювальник може обирати тип сортування, який має застосовуватися для стовпців компонента.

Наразі можна сортувати значення _як числові_ (`Sort as number`, або _як текстові_ для компонентів, які є частиною сітки Edit Grid.

image:registry-develop:bp-modeling/forms/components/edit-grid/sort-as-number/edit-grid-sort-as-number-6.png[]
image:registry-develop:bp-modeling/forms/components/edit-grid/sort-as-number/edit-grid-sort-as-number-7.png[]

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:registry-develop:bp-modeling/forms/components/edit-grid.adoc[]
====

==== Збереження даних із форми масивом у БД

Завантажити дані масивом до фабрики даних можливо, якщо при моделюванні форми використати компонент *Edit Grid*.

Компонент *Edit Grid* дозволяє змоделювати записи з різних компонентів як єдиний масив і завантажити його до бази даних. Масив має відповідати структурі, визначеній моделлю даних.

image:registry-develop:bp-modeling/forms/components/edit-grid/submit-data-as-array/edit-grid-submit-data-as-array-2.png[]

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:registry-develop:bp-modeling/forms/components/edit-grid.adoc[]
====

==== Видалення пробілів на початку і в кінці (Trim Spaces) у компоненті Text Field

Ми покращили досвід моделювання UI-форм з використанням компонента Text Field. Додано підтримку функції *Trim Spaces*.

Функція `Trim Spaces` відпрацьовує таким чином, що коли користувач вносить у текстовому полі на формі значення, які містять пробіли на початку (перед текстом), або в кінці (після тексту), то при надсиланні запита з форми такі пробіли видаляються.

image::registry-develop:bp-modeling/forms/components/textfield/trim-spaces/text-field-trim-spaces-2.png[]

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:registry-develop:bp-modeling/forms/components/text-field.adoc[]
====

=== Моделювання та налаштування регламенту

==== Відправлення повідомлень користувачам

У цьому релізі додано функціональність відправлення електронних повідомлень громадянам із використанням різних каналів зв'язку, а саме:

* [*] *_inbox_* -- відправлення _in-app_-повідомлень у скриньку _Кабінету отримувача послуг_.
* [*] *_email_* -- відправлення поштових повідомлень користувачам з використанням _платформного_ або _зовнішнього_ поштового сервера.
* [*] *_diia_* -- відправлення _push_-нотифікацій у мобільний застосунок "Дія".

Налаштування шаблонів відбувається в регламенті реєстру, у директорії *_notifications_*.

Користувач (отримувач послуг) може дозволити отримання повідомлень, тобто верифікувати відповідний канал зв'язку у профілі Кабінету.

===== Відправлення in-app-повідомлень у скриньку Кабінету отримувача послуг

Для можливості надсилати текстові повідомлення до скриньки користувача у Кабінеті отримувача послуг, розширено можливості моделювання регламенту. Адміністратор регламенту може змоделювати відповідний шаблон для каналу зв'язку _inbox_ та додати його в структуру регламенту реєстру.

image::arch:architecture/registry/operational/notifications/inbox/inbox-portal-view.png[inbox-portal-view, 300]

Репозиторій розгортання регламенту registry-regulations розширено базовою директорією inbox/business-process-notification-template. Ця директорія містить файли шаблону in-app-повідомлень, які користувач може отримувати через канал зв’язку inbox в особистому кабінеті.

Адміністратор регламенту може змоделювати та додати будь-яку кількість шаблонів до структури регламенту, залежно від бізнес-потреб.

Типовий шаблон in-app-повідомлень має наступну структуру: ::

[plantuml, in-app-notification-structure, svg]
----
@startsalt
{
{T
+ <&folder> registry-regulations
++ ...
++ <&folder> notifications
+++ <&folder> inbox
++++ <&folder> <b><template-directory></b>
+++++ <&file> notification.ftl
+++++ <&file> notification.yml
++++ ...
}
}
@endsalt
----

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:registry-develop:registry-admin/user-notifications/inbox/inbox-overview.adoc[]
====

===== Відправлення поштових повідомлень користувачам з використанням платформного або зовнішнього поштового сервера

Реалізовано підтримку відправлення електронних повідомлень з використанням SMTP-протоколу для комунікації через канал зв'язку `email` за допомогою внутрішнього (платформного) або зовнішнього поштового сервера.

image::arch:architecture/registry/operational/notifications/email/email-notification.png[email-notification, 450]

Базовий репозиторій розгортання регламенту registry-regulations розширено директорією channel-confirmation, яка містить шаблон поштового повідомлення із плейсхолдером для OTP-коду, що генеруватиметься системою та надсилатиметься громадянам за вказаною адресою електронної пошти.

Шаблон повідомлення створюються у розмітці HTML за допомогою технології шаблонізації Apache FreeMarker (розширення файлів .ftlh та .ftl для HTML та текстових документів відповідно).

Типовий шаблон поштового повідомлення має наступну структуру:

[plantuml, email-notification-structure, svg]
----
@startsalt
{
{T
+ <&folder> registry-regulations
++ ...
++ <&folder> notifications
+++ <&folder> email
++++ <&folder> <b>channel-confirmation</b>
+++++ <&folder> css
++++++ <&file> style.css
+++++ <&folder> image
++++++ <&file> image.jpg
++++++ <&file> ...
+++++ <&file> notification.ftlh
+++++ <&file> notification.yml
++++ ...
}
}
@endsalt
----

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:registry-develop:registry-admin/user-notifications/email/email-overview.adoc[]
====

===== Відправлення push-нотифікацій у мобільний застосунок "Дія"

Реалізовано можливість надсилати повідомлення користувачам Кабінету отримувача послуг у їх мобільні застосунки "Дія".

image::arch:architecture/registry/operational/notifications/diia/diia-notification.jpg[diia-notification, 200]

Базовий репозиторій розгортання регламенту registry-regulations розширено директорією channel-confirmation, яка містить шаблон push-повідомлення із плейсхолдером для OTP-коду, що генеруватиметься системою та надсилатиметься громадянам у мобільний додаток "Дія".

Типовий шаблон для підтвердження каналу зв'язку "Дія" має наступну структуру: ::

[plantuml, diia-notification-structure, svg]
----
@startsalt
{
{T
+ <&folder> registry-regulations
++ ...
++ <&folder> notifications
+++ <&folder> diia
++++ <&folder> <b>channel-confirmation</b>
+++++ <&file> notification.diia
+++++ <&file> notification.yml
++++ ...
}
}
@endsalt
----

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:registry-develop:registry-admin/user-notifications/diia/diia-overview.adoc[]
====

==== Логування подій завантаження користувачів у журналі аудиту системи

Реалізовано логування подій завантаження користувачів у журналі аудиту системи. Змодельовано "Журнал управління користувачами".

Адміністратор безпеки (з відповідним правом доступу) має можливість переглянути в Redash "Журнал управління користувачами", наприклад, з метою проведення аудиту надання доступу користувачам.

Кожен користувач, якого було створено через імпорт файлом, відображається окремим рядком з зазначеним набором додаткових параметрів.

image:registry-develop:registry-admin/import-users(officer)/import-users(officer)-12.png[]

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:registry-develop:registry-admin/create-users/import-users-officer.adoc[]
====

==== Логування технічних подій завантаження користувачів у сервісі Kibana

Імплементовано логування технічних подій завантаження користувачів у сервісі Kibana.

Модуль перевіряє увесь файл і пише всі знайдені проблеми в сховище технічних логів `Kibana`. У логах фіксується інформація про кожен запис, пропущений при створенні, із зазначеною причиною пропуску, а успішно відпрацьовані порядково не фіксуються (показується лише загальна кількість успішних). Також присвоюється унікальний ідентифікатор користувача в Keycloak (Username), який дублюється.

image:registry-develop:registry-admin/import-users(officer)/import-users(officer)-08.png[]

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:registry-develop:registry-admin/create-users/import-users-officer.adoc[]
====

==== Логування подій відправлення повідомлень у БД аудиту системи

Реалізовано логування подій відправлення повідомлень у базі даних аудиту системи.

Події успішного, або неуспішного відправлення повідомлень користувачу через канали зв'язку *_inbox_*, *_email_* та *_diia_* логуються в журналі аудиту та зберігаються у базі даних `audit`.

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:registry-develop:registry-admin/user-notifications/email/e-mail-notification.adoc#audit-log[Логування відправлення повідомлень у журналі аудиту]
====

==== Управління глобальними налаштування реєстру

Платформа надає можливість керувати глобальними налаштуваннями реєстру в інтерфейсі порталу адміністратора регламенту.

image:registry-develop:registry-admin/admin-portal/global-settings/registry-global-settings-1.png[]

Наразі адміністратор регламенту може налаштувати такі параметри: ::

* Поштова адреса служби підтримки
* Повна назва реєстру
* Скорочена назва реєстру
* Тема інтерфейсу

Надалі перелік налаштувань буде розширено.

Редагування складових регламенту реєстру можливо внести лише в рамках версій-кандидатів на внесення змін. Для майстер-версії доступна лише опція перегляду.

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:registry-develop:registry-admin/admin-portal/registry-modeling/registry-global-settings.adoc[]
====

==== Таблиці моделі даних реєстру та їх структури

У цьому релізі ми імплементували можливість працювати із таблицями бази даних реєстру у режимі перегляду (read-only).

image:registry-develop:registry-admin/admin-portal/tables-data-structures/tables-data-structures-1.png[]

Адміністратор регламенту може виконати пошук таблиці за назвою (латиницею), сортувати таблиці за назвою, історичністю, суб'єктністю та описом, а також досліджувати їх структуру відповідно до моделі даних.

image:registry-develop:registry-admin/admin-portal/tables-data-structures/tables-data-structures-4.png[]

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:registry-develop:registry-admin/admin-portal/registry-modeling/tables-data-structures.adoc[]
====

==== Керування запитами на внесення змін до регламенту та внесення змін до майстер-гілки

Реалізовано можливість керувати запитами на внесення змін до регламенту реєстру. Адміністратор може:

* Створювати нові версії/гілки-кандидати:
+
image:registry-develop:registry-admin/admin-portal/new-admin-portal-3.png[]
* Перемикатися між версіями-кандидатами:
+
image:registry-develop:registry-admin/admin-portal/new-admin-portal-5.png[]

* Вносити зміни до певних версій-кандидатів та бачити перелік внесених змін:
+
image:registry-develop:registry-admin/admin-portal/new-admin-portal-9.png[]

* Отримувати оновлення та застосовувати зміни до майстер-версії:
+
image:registry-develop:registry-admin/admin-portal/new-admin-portal-10.png[]
+
image:registry-develop:registry-admin/admin-portal/new-admin-portal-11.png[]

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:registry-develop:registry-admin/admin-portal/version-control/version-control-overview.adoc[]
====

==== Відображення інформації про конфліктні зміни відносно майстер-версії

Адміністратор тепер має можливість переглядати інформацію щодо конфліктних змін у різних гілках (версіях-кандидатах) розробки регламенту.

Конфлікт злиття -- це подія, яка виникає, коли система (Git) не може автоматично вирішити відмінності в коді між двома версіями змін.

image:registry-develop:registry-admin/admin-portal/new-admin-portal-8.png[]

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:registry-develop:registry-admin/admin-portal/version-control/overview-new-change-request.adoc[]
====

=== Адміністративна панель Control Plane

==== Налаштування власного DNS-імені для Кабінетів

У цьому релізі ми розробили зручний інтерфейс, який дозволяє налаштовувати власні *DNS*-імена для публічних Кабінетів отримувача послуг та посадової особи. Адміністратор може зробити це в  адміністративній панелі керування платформою та реєстрами *Control Plane*.

При редагуванні реєстру адміністратор легко може завантажити файл SSL-сертифіката для власного імені у реєстрових кабінетах.

image:release-notes:wn-1-9-0/wn-1-9-0-custom-dns.png[]

Інтерфейс адміністрування розділяє отриманий сертифікат на CA-сертифікат (_Certificate Authority_) і ключ, зберігає їх в центральному сховищі секретів HashiCorp Vault та додає отримані DNS-імена до налаштувань реєстру _values.yaml_.

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:admin:registry-management/control-plane-custom-dns.adoc[]
====

==== Обмеження доступу до адміністративних та реєстрових компонентів

Ми імплементували можливість обмежувати доступ до компонентів, що використовуються на Платформі, за допомогою правил безкласової маршрутизації.

Адміністратор має можливість задавати список IP-адрес та підмереж окремо для Кабінетів посадової особи та отримувача послуг, окремо для адміністративних компонентів реєстру, а також для платформних та інфраструктурних компонентів.

image:release-notes:wn-1-9-0/wn-1-9-0-cidr.png[]

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:admin:registry-management/control-plane-cidr-access-endpoints.adoc[]
====

==== Перегляд та підтвердження запитів на внесення змін до реєстру

Віднині адміністративна панель Control Plane дозволяє переглядати та підтверджувати запити на внесення змін до конфігурації реєстру в Gerrit, тобто виконувати `git merge` до репозиторію, не виходячи за межі Control Plane.

Запропоновані зміни вносяться до конфігурації файлу _deploy-templates/values.yaml_.

image:admin:registry-management/cp-submit-mr/cp-submit-mr-2.png[]

image:admin:registry-management/cp-submit-mr/cp-submit-mr-3.png[]

[TIP]
====
Детальну інформацію з описом функціональності ви можете переглянути за посиланням:

* xref:admin:registry-management/control-plane-submit-mr.adoc[]
====

=== Налаштування зовнішніх інтеграцій

З метою покращення безпекових характеристик платформи, авторизаційний токен для налаштування інтеграції з ЄДР та зовнішніми системами перенесено до OpenShift.

Тепер у конфігураційному файлі _bp-trembita/configuration.yml_ не потрібно вказувати авторизаційний токен. Достатньо вказати ключ секрету та його значення у розділах `trembita-exchange-gateway` та `external-systems`. Наприклад:

----
secret-name: 'trembita-registries-secrets'
----

image:release-notes:wn-1-9-0/wn-1-9-0-secret-name-1.png[]

image:release-notes:wn-1-9-0/wn-1-9-0-secret-name-2.png[]

[TIP]
====
Детальніше про налаштування зовнішніх інтеграцій ви можете переглянути за посиланням:

* xref:registry-develop:registry-admin/external-integration/api-call/trembita/external-services-connection-config.adoc[]
====

=== Кабінет посадової особи

==== Сортування послуг у виконанні за статусом для посадових осіб

Тепер посадові особи можуть сортувати послуги у виконанні за статусом в особистому Кабінеті.

image:wn-1-9-0/wn-1-9-0-officer-sorting-bp-status.png[]

==== Проміжне збереження даних бізнес-процесів

Реалізовано функціональність проміжного збереження даних на формі з можливістю повернутися до виконання бізнес-процесу, в якому збережено внесені дані.

image::release-notes:wn-1-9-0/wn-1-9-0-officer-citizen-interim-data-storage.png[]

=== Кабінет отримувача послуг

==== Отримання повідомлень в особистих Кабінетах та підтвердження каналів зв'язку користувачами

Платформа дозволяє налаштовувати та підтверджувати відправлення повідомлень у Кабінеті отримувача послуг через канали зв'язку `inbox`, `email` та `diia`.

===== Відправлення inbox-повідомлень користувачам

Реалізовано функціональність відправлення inbox-повідомлень користувачам у Кабінеті отримувача послуг. Для того, щоб налаштувати відправлення повідомлень, необхідно пройти один з доступних бізнес-процесів.

image::user:citizen-inbox/inbox-notification-5.png[]

[TIP]
====
Детальніше про налаштування функціональності ви можете переглянути за посиланням:

* xref:user:citizen/user-notifications/inbox-notifications.adoc[]
====

===== Підтвердження електронної адреси за допомогою OTP-коду у профілі користувача

Реалізовано функціональність відправлення повідомлень з OTP-кодом на електронну пошту користувачам, а також підтвердження електронної пошти у профілі Кабінету отримувача послуг.

image::user:citizen-email-otp/email-otp-6.png[]

image::arch:architecture/registry/operational/notifications/email/email-notification.png[email-notification, 450]

[TIP]
====
Детальніше про налаштування функціональності ви можете переглянути за посиланням:

* xref:user:citizen/user-notifications/email-otp.adoc[]
====

===== Отримання push-повідомлень з OTP-кодом у застосунку "Дія"

Реалізовано функціональність отримання push-повідомлень з OTP-кодом у мобільному застосунку "Дія", а також підтвердження каналу зв'язку `Дія` у профілі Кабінету отримувача послуг.

image::user:citizen-diia-push-otp/diia-push-otp-2.png[]

image::user:citizen-diia-push-otp/diia-push-otp-10.png[]

[TIP]
====
Детальніше про налаштування функціональності ви можете переглянути за посиланням:

* xref:user:citizen/user-notifications/diia-push-otp.adoc[]
====

==== Проміжне збереження даних бізнес-процесів

Реалізовано функціональність проміжного збереження даних на формі з можливістю повернутися до виконання бізнес-процесу, в якому збережено внесені дані.

image::release-notes:wn-1-9-0/wn-1-9-0-officer-citizen-interim-data-storage.png[]



