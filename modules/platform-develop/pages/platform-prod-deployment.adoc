:toc-title: ЗМІСТ
:toc: auto
:toclevels: 5
:experimental:
:important-caption:     ВАЖЛИВО
:note-caption:          ПРИМІТКА
:tip-caption:           ПІДКАЗКА
:warning-caption:       ПОПЕРЕДЖЕННЯ
:caution-caption:       УВАГА
:example-caption:           Приклад
:figure-caption:            Зображення
:table-caption:             Таблиця
:appendix-caption:          Додаток
:sectnums:
:sectnumlevels: 5
:sectanchors:
:sectlinks:
:partnums:

= Вивід Платформи та реєстрів на Платформі в промислову експлуатацію

CAUTION: Сторінка у процесі формування.

== Вивід платформи в промислову експлуатацію

=== Базові передумови

Вивід платформи в промислову експлуатацію необхідно виконувати лише на базі віртуальних інфраструктур, що офіційно підтримуються (#*додати посилання, наразі це AWS та VSphere*#). На такій віртуальній інфраструктурі має бути розгорнутий OKD-кластер, версія якого офіційно підтримується Платформою, згідно з інструкціями, що надаються в офіційній документації Платформи (#*додати посилання*#).

Платформа має бути встановлена відповідно до процедури, визначеній в офіційній документації (#*додати посилання*#) на середовищах, що офіційно підтримуються.

=== Навчання технічного адміністратора реєстру

#TBD# ::

* Робота у Control Plane
* Робота з Keycloak
* Чого ще не вистачає?
* xref:registry-develop:study-project/index.adoc[]

=== Планування резервного сховища бекапів Платформи та реєстрів

Резервні копії (бекапи) зберігаються в окремому сховищі бекапів, яке є S3-сумісним (#додати посилання#). Параметри цього сховища з погляду доступного місця у сховищі та обчислювальних ресурсів повинні бути враховані, залежно від об'єму бекапів.

Основні параметри які враховуються: ::

* Кількість бекапів центральних компонент Платформи (зазвичай розмір одного бекапу приблизно #???100GB ??# (Перевірити з Віталієм та уточнити). #В UA Minio не показує чітко розмірів бекапів. Потрібен можливо аналіз папок бакетів, для цього пропоную залучити Столярова А.#
* Кількість та розмір бекапів реєстру (залежить від реєстру, платформа рекомендує закладати мінімум 20GB на кожен бекап кожного реєстру)
* Реплікація файлів, що підвантажуються до реєстрів (сукупний розмір файлів повинен розраховуватися окремо).

#Рекомендації щодо розміру віртуальний для дефолтного бекап сховища на базі Minio (визначити з Vitalii_Mospan та Roman Kovtun -- може у вас є розуміння?) Мінімал 1/1. Рекомендовано 2/4#.

=== Зберігання цифрових печаток адміністратора для платформи та реєстрів

У промисловій експлуатації рекомендованим сховищем зберігання ключів є програмно-апаратний комплекс #*Гряда*#, деталі щодо налаштування знаходяться тут (#*додати посилання*#). Це означає, що технічний адміністратор платформи повинен мати змогу генерувати та сертифікувати ключі для Платформи та реєстрів, що будуть на ній розгорнуті.

#*Нерекомендованим шляхом*#, _який не пройде КСЗІ згідно з законом_, є використання файлових ключів для підпису. Якщо інстанс знаходиться в AWS, потрібно забезпечити #*whitelisting*# зв'язку між дата-центром AWS та відповідними АЦСК (#*додати або створити посилання разом Федоренко*#).

Посилання на документацію: xref:admin:installation/griada-301-deployment.adoc[] #???#

=== Налаштування взаємодії з Трембітою та встановлення Шлюзу Безпечного Обміну (ШБО)

#TBD# ::

Перевірити наявну документацію та дописати (за потреби):

* xref:registry-develop:registry-admin/external-integration/registration-subsystem-trembita/registration-subsystem-trembita.adoc[]

=== Встановлення платформи та її первісна перевірка

#TBD#::

Розгортання Платформи з нуля на цільовому середовищі та первинне тестування (Smoke-тестування: перші кроки після встановлення, які покажуть, що все встановлено правильно).

Наявна документація (перевірити):

* xref:admin:installation/platform-admin-deployment.adoc[]
* xref:admin:installation/minio-vault-auto-deploy.adoc[]

=== Налаштування відправлення повідомлень моніторингу

#TBD#:: Взяти матеріал із сесій по КТ-L2

* Monitoring Alerts

=== Налаштування базових бордів в Kibana

* xref:registry-develop:registry-admin/kibana-request-dashboard.adoc[]

#TBD#:: Взяти матеріал із сесій по КТ-L2

Перевірити наявну документацію:

* xref:registry-develop:bp-modeling/bp/kibana.adoc[]

=== Налаштування бекапів центральних компонент

#TBD#::

Перевірити наявну документацію:

* xref:admin:backup-restore/control-plane-components-backup-restore.adoc[]

=== Інтеграція з id.gov.ua на рівні платформи та використання стилізованого віджета

#TBD#::

Врахувати створення, оновлення ЕЦП та окремо сертифікатів надавачів послуг.

=== Отримання дозволу для поштового сервера в AWS-середовищі

#TBD#::

Перевірити наявну документацію:

* xref:admin:installation/internal-smtp-server-setup.adoc#_отримання_дозволу_на_відправку_email_у_aws[Отримання дозволу для поштового сервера в AWS-середовищі]

=== Налаштування обмежень доступу на мережевому рівні до адміністративних ендпоінтів Платформи

#TBD# ::

Наявна документація:

* xref:admin:registry-management/control-plane-cidr-access-endpoints.adoc#_обмеження_доступу_до_платформних_інфраструктурних_та_інших_компонентів[Обмеження доступу до платформних, інфраструктурних та інших компонентів]


=== Захист інфраструктури в AWS

#TBD# ::

Віталій Моспан ??

=== Захист інфраструктури в VSphere

#TBD# ::

Віталій Моспан ??

=== Оновлення інфраструктурних компонентів Платформи (Оновлення cluster-mgmt)

Наявна документація:

* xref:admin:update/update_cluster-mgmt.adoc[]

== Вивід реєстру на Платформі у промислову експлуатацію

=== Визначення команди підтримку реєстру L1, L2, L3

#TBD# ::

Буде визначено на 3-й сесій KT-L2.

=== Створення реєстру та його первинна перевірка

#TBD# ::

Додати про розгортання реєстру через Control Plane та smoke-testing.

* xref:admin:registry-management/control-plane-create-registry.adoc[]

* xref:admin:registry-management/control-plane-view-registry.adoc[]

* Додати інформацію про найперші дії, які має виконати тестувальник/адмін регламенту для того, щоб переконатися, що реєстр розгорнуто успішно.

=== Оновлення компонентів реєстру

Наявна документація ::

* xref:admin:update/update-registry-components.adoc[]

=== #*! Типові проблеми з аутентифікацією у користувачів реєстру і при підписанні БП*#

#TBD# ::

* Перевірка ключа на https://id.gov.ua/sign +
* Перевірка, що в у ДСО реєстру і namespace user-management встановлені останні сертифікати ІІТ.

=== Режим роботи реєстру production vs development

#TBD# ::

Зробити більш лаконічну статтю на базі дизайну та показати, як у конфігурації регулюється deploymentMode:

* xref:arch:architecture/platform/administrative/config-management/dev-prod-deployment-mode.adoc[Розгортання Платформи реєстрів у промисловому середовищі без використання інструментів та роутів для розробки реєстру]

=== Особливості розгортання регламенту в production середовищі

#TBD# ::

Rollout (Накатка регламенту). Наявні документи:

* xref:registry-develop:registry-admin/regulations-deploy/registry-regulations-structure.adoc[]
* xref:registry-develop:registry-admin/regulations-deploy/registry-admin-instruments-access.adoc[] -- Необхідно оновити.
* xref:registry-develop:registry-admin/regulations-deploy/registry-admin-deploy-regulation.adoc[]
* xref:platform-develop:registry-regulations-deployment.adoc[]
* xref:registry-develop:registry-admin/regulations-deploy/registry-regulations-auto-validation.adoc[]
* xref:registry-develop:registry-admin/admin-portal/overview.adoc[]

=== Рекомендований алгоритм змін в регламент реєстру

#TBD# :: Уточнити, які наші рекомендації

Update (Внесення змін до регламенту):

Розказати, що оновлення компонентів регламенту відбувається за тим самим підходом, що й розгортання: файли оновлюються в локальному середовищі, публікуються до віддаленого Gerrit-репозиторію. Пайплайн публікацій відстежує зміни у файлах директорій регламенту, і при git merge змін до майстер-гілки репозиторію, спрацьовує пайплайн публікацій `Master-build-registry-regulations`, який збирає увесь код. Після виконання пайплайну, зміни набувають чинності, а регламент оновлюється до нової версії останнього комміта.

Також розказати про те, що у нас є можливість оновлювати регламент як за хардкорним шляхом, так і за більш зручним.

_Хардкорний шлях_ -- це робота з каталогами файлів, git та Gerrit, через Git Bash консоль, або в інших інструментах, робота з Jenkins тощо.

_Зручний спосіб_ -- це використання нового порталу адміністратора регламентут та його вбудованих можливостей.

* xref:registry-develop:registry-admin/regulations-deploy/registry-admin-deploy-regulation.adoc[]
* xref:registry-develop:registry-admin/admin-portal/overview.adoc[]


=== Налаштування цифрового ключа реєстру

#TBD# ::

Врахувати створення, оновлення ЕЦП та окремо сертифікатів надавачів послуг

https://ddm-architecture-mdtu-ddm-edp-cicd-documentation-dev.apps.cicd2.mdtu-ddm.projects.epam.com/platform/1.9/admin/registry-management/control-plane-change-key.html[Заміна системного ключа для реєстру]

=== Налаштування поштового клієнта (SMTP сервер)

#TBD# ::

Наявна інструкція:
xref:admin:installation/internal-smtp-server-setup.adoc[]

=== Налаштування взаємодії з Дією

#TBD# :: Що нам потрібно зробити, щоб інтегруватися з Дією?

Наявні інструкції:

* xref:registry-develop:registry-admin/user-notifications/diia/diia-overview.adoc[]

* xref:arch:architecture/registry/operational/notifications/diia-notifications-api.adoc[]

=== Налаштування взаємодії з іншими реєстрами та зовнішніми системами

#TBD# ::

Наявна документація:

* xref:registry-develop:registry-admin/external-integration/rest-api-no-trembita.adoc[]

=== Налаштування взаємодії через Трембіту на базі стандартних конекторів

#TBD# ::

Наявна документація:

* xref:registry-develop:bp-modeling/external-integration/api-call/connectors-external-registry.adoc[]

=== Конфігурація реєстру під навантаження

#TBD# ::

Поки незрозуміло, про що мова.

#Йдеться про можливість обрати шаблон реєстру із необхідною кількістю ресурсів?#

=== Планування місця для сховищ реєстру

#TBD# :: Доки від Віталія, передивитися запис по KT-L2, session 2.

_До Стаса/Віталія._

Наявна документація:

* xref:admin:file-system/ceph-space.adoc[]
* xref:admin:file-system/ceph_scaling.adoc[]

=== Отримання доступу для L2 до системи сповіщень, моніторингу та логування у реєстрі

#TBD# :: _До Віталія_

Сповіщення які: monitoring alerts?

=== Налаштування бекапів реєстру

#TBD# ::

Наявна інструкція:

* xref:admin:backup-restore/control-plane-backup-restore.adoc[]

=== Налаштування реплікації файлів реєстру

#TBD# ::

#?..?#

=== Інтеграція з http://id.gov.ua[id.gov.ua] на рівні реєстру та використання стилізованого віджета

#TBD# ::

Налаштування у Control Plane (Поки бачу, що це еволюція Платформи, а не реалізація):

* xref:arch:architecture/platform/operational/user-management/id-gov-ua-flow.adoc[]

+
Автентифікація на рівні отримувачів та надавачів послуг:

* xref:user:citizen-officer-portal-auth.adoc[]

=== Визначення порядку надання доступу надавачам послуг адміністратором доступу

#TBD# ::

До Ліани.

=== Рекомендації щодо онбордингу отримувачів послуг

#TBD# ::

xref:arch:architecture/platform/operational/user-management/citizen-onboarding.adoc[]
+
Оновлено процес онбордингу в рамках https://jiraeu.epam.com/browse/MDTUDDM-17161

=== Аутентифікація юридичних осіб до реєстру як отримувачів послуг

#TBD# :: На чому тут акцентувати увагу?
+
Наявна інструкція:

* xref:user:citizen-officer-portal-auth.adoc[]

=== Рекомендації щодо уникнення "покинутих" бізнес-процесів користувачами

#TBD# :: Не зрозуміло, про що йде мова. Уточнити у БА/QA

=== Налаштування рейт-лімітів

#TBD# :: Наявна інструкція:

* xref:registry-develop:registry-admin/api-rate-limits.adoc[]

=== Налаштування обмежень доступу на мережевому рівні до адміністративних ендпоінтів реєстру, кабінетів отримувачів та надавачів послуг (CIDR)

#TBD# :: Наявна інструкція:

* xref:admin:registry-management/control-plane-cidr-access-endpoints.adoc#cidr-registry-components[Обмеження доступу до компонентів реєстру]

=== Налаштування коротких DNS-імен

#TBD# :: Наявна інструкція:

* xref:admin:registry-management/control-plane-custom-dns.adoc[]

=== Додавання нових користувачів (через Keycloak та імпорт)

Наявні інструкції:

* xref:registry-develop:registry-admin/create-users/manual-user-creation.adoc[]

* xref:registry-develop:registry-admin/create-users/import-users-officer.adoc[]

//TODO:
=== Призначення адміністраторів Платформи та реєстру

#TBD# :: Наявні інструкція:

* xref:admin:registry-management/control-plane-assign-platform-admins.adoc[]

* xref:registry-develop:registry-admin/create-users/create-registry-admins.adoc[]

Оновити наявні документи відповідно до останнього діалогу з Ліаною (незначні зміни).

=== Налаштування Геосервера

#TBD# ::
Модуль ГІС і все, що з ним пов'язано.
+
Створити доку на базі дизайну:

* xref:arch:architecture/registry/operational/geo/overview.adoc[]

=== Первинне завантаження та дозавантаження даних до системи

#TBD# :: Наявні інструкції:

. Первинне завантаження/дозавантаження даних до таблиць-довідників через процедуру на рівні моделі даних:

* xref:registry-develop:data-modeling/initial-load/index.adoc[]

. Завантаження даних із CSV-файлу масивом до БД (в рамках виконання бізнес-процесу):

* xref:registry-develop:bp-modeling/bp/loading-data-from-csv.adoc[]

. Навчальний курс (Приклад первинного завантаження даних при проходженні тестового завдання):

* xref:registry-develop:study-project/study-tasks/task-1-registry-db-modeling.adoc[]

== Рекомендації щодо нефункціонального тестування реєстрів на платформі

=== Тестування продуктивності

#TBD# ::
Алгоритм — до Паші. Якими інструментами ми виконуємо performance-тестування?
+
Тестування проводимо для кожного окремого реєстру.

=== Тестування безпеки

#TBD# ::

Кажемо, що це *out-of-the-box*. Платформа регулярно тестується. Нічого робити не треба.
