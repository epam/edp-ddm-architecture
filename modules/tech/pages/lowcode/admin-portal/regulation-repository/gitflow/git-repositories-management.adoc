= Забезпечення одночасної роботи декількох користувачів над однією версію-кандидатом

== Основні принципи
- Один локальний репозиторій для всіх користувачів в розрізі однієї версії-кандидату
- Scheduled job для актуалізації даних

image::lowcode/admin-portal/regulation-repository/git/gitflow-current-solution.svg[]

== Проблеми xref:lowcode/admin-portal/regulation-repository/gitflow/gitflow-description.adoc[існуючого рішення]
- Втрата внесених змін користувачами при одночасній роботі декількох користувачів над однією сутністю в рамках однієї версії-кандидату
- Можлива неконсистентність файлів на файловій системі в момент виконання _git_ операцій (наприклад `git rebase`) при одночасній роботі декількох екземплярів admin-portal backend сервісу з одним persistent volume
- В разі необхідності горизонтального маштабування backend сервісу, Java based synchronisation відбувається лише на рівні одного екземпляру admin-portal backend сервісу.

== Варіанти вирішення проблеми

=== Організація структури репозиторіїв на файловій системі
* xref:tech:lowcode/admin-portal/regulation-repository/gitflow/gerrit-driven-structure.adoc[Окремий репозиторій на файловій системі для кожного користувача в розрізі кожної версії-кандидату. Отримання інформації про конфлікти з Gerrit]
* xref:tech:lowcode/admin-portal/regulation-repository/gitflow/gitflow-git-driven-structure.adoc[Окремий репозиторій на файловій системі для кожного користувача в розрізі кожної версії-кандидату. Окремий репозиторій для перегляду інформації про конфлікти]

=== Lock механізми доступу до ресурсів конфігурації
* xref:tech:lowcode/admin-portal/regulation-repository/gitflow/gitflow-pessimistic-locking.adoc[Використання Pessimistic locking]
* xref:tech:lowcode/admin-portal/regulation-repository/gitflow/gitflow-optimistic-locking.adoc[Використання Optimistic locking на рівні доступу до файлів конфігурації регламенту реєстру]
* xref:tech:lowcode/admin-portal/regulation-repository/gitflow/gitflow-optimistic-locking-http.adoc[Використання Optimistic locking на рівні RestAPI]
