= Відправка повідомлень користувачам

== Функціональні можливості

Для забезпечення вимог по роботі з повідомленнями, платформа підтримує наступні канали зв'язку з громадянами:

- _inbox_ - відправлення повідомлень у скриньку _Кабінету Громадянина_
- _email_ - відправлення поштових повідомлень користувачам з використанням платформенного або зовнішнього поштового сервера
- _diia_ - відправлення push-нотифікацій у мобільний додаток _Дія_

На даний момент реалізовано наступні сценарії:

- Налаштування каналів зв'язку для відправлення повідомлень на рівні реєстру
- Налаштування шаблонів формування повідомлень на рівні окремих каналів зв'язку
- Налаштування кроків відправлення повідомлень на рівні бізнес-процесу
- Налаштування преференцій за каналами зв'язку на рівні профілю користувача для отримання повідомлень
- Підтвердження каналу зв'язку при його активації користувачем
- Відправлення повідомлень користувачам з підтримкою шаблонізації
- Відправлення повідомлень користувачам згідно їх преференцій
- Відправлення повідомлень користувачам за окремими каналами системою (_OTP_-код, тощо.)

=== Відправлення _in-app_ повідомлень в inbox Кабінету Громадянина

==== Функціональні можливості

Для забезпечення вимог по роботі з inbox каналом повідомлень, платформа реалізує наступні сценарії:

* Надсилання повідомлень користувачу по каналу
* Отримання користувачем списку скорочених повідомлень через Кабінет
* Читання користувачем повного повідомлення

==== Основні принципи

* Канал є доступним для всіх зареєстрованих користувачів
* Канал не вимагає окремої активації
* Канал не може бути деактивований (повідомлення надсилаються незалежно від преференцій користувача)

image::lowcode/notifications/inbox/inbox-portal-view.png[inbox-portal-view, 450]

=== Відправлення поштових повідомлень

image::lowcode/notifications/email/email-notification.png[email-notification, 450]

=== Відправлення push-повідомлень у мобільний застосунок Дія

image::lowcode/notifications/diia/diia-notification.jpg[diia-notification, 250]

== Ролі користувачів

- _Адміністратор платформи_ - створення та послідуюче налаштування реєстрів _Адміністративний інтерфейс управління платформою_ (_канали зв'язків, тощо._)
- _Адміністратор реєстру_ - налаштування реєстру через _Адміністративний інтерфейс управління платформою_ (_канали зв'язків, тощо._)
- _Адміністратор регламенту_ - створення шаблонів повідомлень, моделювання бізнес-процесів з використанням елементів відправки повідомлень користувачам
- _Користувач кабінету громадянина_ - отримання повідомлень про стан чи результат виконання бізнес-процесу згідно налаштувань каналів зв'язку

== Базові принципи

* Відправка повідомлень системою можлива лише зареєстрованим користувачам
* Кожен користувач має обрати активний канал зв'язку та внести контактні дані при проходженні реєстрації
* Кожен канал зв'язку обраний користувачем у якості активного обов'язково має пройти верифікацію
* Кожен зареєстрований користувач повинен мати як мінімум один активний та верифікований канал зв'язку для користування кабінетом
* Відправка повідомлень користувачам є значущою подією, яка підлягаю фіксації в журналі аудиту системи
* Платформа надає можливість перевикористання шаблонів повідомлень між бізнес-процесами
* Платформа надає можливість налаштування шаблонів повідомлень окремо для кожного з каналів зв'язку
* Платформа надає спеціалізовані елементи у каталозі типових розширень для спрощення моделювання бізнес-процесів з відправкою повідомлень
* Платформа розповсюджується з налаштованими сервісами для обслуговування каналів зв'язку реєстру у якості опцій за замовчуванням
* Відправка повідомлень не має блокувати потік виконання бізнес-процесу та виконуватись асинхронно
* Для реалізації інтерфейсу асинхронної взаємодії з підсистемою відправки повідомлень обрано підхід з використанням _Kafka_ у якості брокера повідомлень, яка забезпечує гарантії доставки та _Exactly-Once_ семантику обробки повідомлень