= Розгортання екземпляру реєстру



Після успішного встановлення Платформи у цільовому оточенні, адміністратор Платформи отримує доступ до адміністративної панелі керування Платформою, що має назву **Control Plane** або **Admin Console** і доступна за посиланням: https://control-plane-console-{CP-NAMESPACE}.{DNS-WILDCARD}/[].



TIP: `{CP-NAMESPACE}` та `{DNS-WILDCARD}` є змінними, де `{CP-NAMESPACE}` -- назва namespace (простору імен) у Control Plane, а `{DNS-WILDCARD}` -- значення DNS wildcardfootnote:[В системі DNS можна задавати запис за замовчуванням для неоголошених піддоменів. Такий запис називається wildcard.].



IMPORTANT: Розгорнути реєстр в адмін-панелі *Control Plane* може лише адміністратор Платформи
з відповідними правами доступу.



Для розгортання нового реєстру необхідно виконати наступні кроки:



. Увійдіть до адміністративної панелі керування кластером та реєстрами *Control Plane*, використовуючи попередньо отримані логін та пароль.
+
image:admin:infrastructure/cluster-mgmt/update-cluster-mgmt-01.png[]



. Перейдіть до розділу _Реєстри_ -> далі натисніть `Створити новий`.
+
image:infrastructure/cluster-mgmt/cp-registry-deploy-1.png[]



. У новому вікні заповніть форми відповідними даними.
+
У полі `Назва реєстру` введіть назву реєстру, що буде розгорнуто.
+
CAUTION: Назва повинна бути унікальною і її неможливо буде змінити після створення реєстру.
Для введення доступні лише латинські літери та знак "-".
Довжина не повинна перевищувати 12 символів.
+
image:infrastructure/cluster-mgmt/cp-registry-deploy-2.png[]



. У полі `Адміністратори` зазначте адміністраторів регламенту реєстру,
яким буде надано доступ до реєстру.
+
Натисніть "+", і далі у вікні, що з'явилося, введіть дані кожного адміністратора реєстру, а саме:



* імя;
* прізвище;
* електронну пошту;
* тимчасовий пароль.
//TODO: нижний абзац поднять на уровень выше, исключив из подчинения верхнему списку
+
Для надання доступу декільком адміністраторам реєстру,
необхідно повторити дію для кожного адміністратора окремо (+ -> вказати дані -> `Підтвердити`).
+
[NOTE]
====
Дані електронної пошти мають бути введені у нижньому регістрі.



Доступні символи: `"0-9"`, `"a-z"`, `"_"`, `"-"`, `"@"`, `"."`, `","`.
====



+
[IMPORTANT]
====
Саме на цьому етапі визначаються _адміністратори реєстру_.



Можливість внесення нових адміністраторів буде доступна і згодом після розгортання, через опцію редагування реєстру.
====



+
image:infrastructure/cluster-mgmt/cp-registry-deploy-3.png[]
↓
image:infrastructure/cluster-mgmt/cp-registry-deploy-4.png[]

[NOTE]
====
Користувач-адміністратор реєстру автоматично створюється в `openshift`-реалмі сервісу Keycloak з роллю `cp-registry-admin-<registry-name>` та групою `/cp-registry-admin-<registry-name>`, де `<registry-name>` -- назва реєстру.
====

. Заповніть поле `Опис`, воно може містити офіційну назву реєстру або
його призначення.



. У полі `Шаблон реєстру` оберіть шаблон, який буде застосований для реєстру.
+
Шаблон реєстру визначає параметри конфігурації та кількість інстансів для реєстру,
що розгортається, тобто виділену кількість ресурсів (CPU, RAM тощо) та кількість нод в MachineSets.
+
image:infrastructure/cluster-mgmt/cp-registry-deploy-5.png[]



. У полі `Гілка шаблону реєстру` оберіть гілку, яка буде застосована при розгортанні реєстру.
+
Мається на увазі версія гілки компонента у Gerrit-репозиторії, що містить відповідну збірку реєстру.
+
image:infrastructure/cluster-mgmt/cp-registry-deploy-7.png[]
//Секція `Дані про ключ` має містити дані про файловий ключ та сертифікований орган, що такий ключ видав.
. У полі `Тип носія` оберіть відповідний тип ключа, що використовується.
+
image:infrastructure/cluster-mgmt/cp-registry-deploy-8.png[]
. Накладіть електронний ключ.
+
Поле `Файловий ключ (розширення .dat)` заповнюється операційним ключем із розширенням
`.dat` (`Key-6.dat`) адміністратора Платформи.
Завантажте файл із ключем, натиснувши `Browse`, оберіть ключ у відповідній директорії,
натисніть `Open`.
+
image:infrastructure/cluster-mgmt/cp-registry-deploy-9.png[]



. У полі `АЦСК, що видав ключ` відображається повна назва АЦСКfootnote:[**АЦСК** - Атестований центр сертифікації ключів.], що видав ключ.



. У полі `Пароль до файлового ключа` введіть пароль до завантаженого ключа.
+
image:infrastructure/cluster-mgmt/cp-registry-deploy-10.png[]



. Секція `Дані для перевірки ключа` має містити дані публічних сертифікатів та перелік АЦСК:



* У полі `Публічні сертифікати АЦСК (розширення `.p7b`)` завантажте файл із переліком сертифікатів (розширення `.p7b`).
* У полі `Список АЦСК (розширення .json)` завантажте файл із переліком АЦСК для перевірки.



+
[CAUTION]
====
[red]##Увага!## Цей ключ використовується для підпису витягів, сформованих Платформою, та підпису даних, що трансформуються згідно з логікою бізнес-процесів реєстру.
====
. Після виконання вищезазначених кроків натисніть `Підтвердити`.



Таким чином, реєстр додається до переліку реєстрів у розділі `Реєстри` панелі керування.



У разі успішного розгортання, реєстр позначається зеленою піктограмою в колонці `Статус`.



image:infrastructure/cluster-mgmt/cp-registry-deploy-11.png[]