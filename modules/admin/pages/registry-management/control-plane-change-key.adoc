:toc-title: ЗМІСТ
:toc: auto
:toclevels: 5
:experimental:
:important-caption:     ВАЖЛИВО
:note-caption:          ПРИМІТКА
:tip-caption:           ПІДКАЗКА
:warning-caption:       ПОПЕРЕДЖЕННЯ
:caution-caption:       УВАГА
:example-caption:           Приклад
:figure-caption:            Зображення
:table-caption:             Таблиця
:appendix-caption:          Додаток
:sectnums:
:sectnumlevels: 5
:sectanchors:
:sectlinks:
:partnums:

= Заміна системного ключа для реєстру
{empty} +

Для заміни системного ключа реєстру необхідно виконати наступні кроки:

== Редагування даних ключа

. Увійдіть до адміністративної панелі управління реєстрами *Control Plane*, використовуючи попередньо отримані логін та пароль.
+
image:admin:infrastructure/cluster-mgmt/update-cluster-mgmt-01.png[]

. Перейдіть до розділу `Реєстри` та оберіть відповідний реєстр, в якому необхідно змінити системний ключ.
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-01.png[]

. Натисніть кнопку `Редагувати`, що розташована у правому верхньому куті.
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-02.png[]

. Встановіть прапорець в рядку «`Редагувати дані про ключ`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-03.png[]

[#setting_key]
== Налаштування ключа

Доступно до налаштування два типи ключів:

* `файловий ключ` -- зберігається на користувацькому носії у форматі `*.dat`;
* `апаратний ключ` -- зберігаються на мережевому криптомодулі та управляється програмним забезпеченням АТ "ІІТ".

=== Налаштування ключа на файловому носії

. Оберіть «`Тип носія`» - «`Файловий носій`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-04.png[]

. Додайте новий системний ключ, натиснувши кнопку «`Вибрати файл`». У новому вікні перейдіть до директорії, де зберігається файл ключа формату `*.dat`, оберіть його і натисніть «`Відкрити`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-05.png[]

. Введіть пароль вибраного системного ключа у відповідному полі.
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-06.png[]

. Наступним кроком необхідно зазначити назву АЦСК у полі «`АЦСК, що видав ключ`».
+
[#iit]
* 4.1.  Щоб дізнатися назву АЦСК ключа необхідно завантажити додаток _«Користувач центру сертифікації ключів»_ з офіційного ресурсу АТ "ІІТ" за посиланням https://iit.com.ua/downloads.
+
Далі відкрийте завантажений файл для інсталяції ПЗ.
+
[NOTE]
====
Подальший приклад буде розглянуто для користувача ОС Microsoft Windows з додатком _EUInstall.exe_.
====
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-07.png[]

* 4.2. Інсталюйте програму _«ІІТ Користувач ЦСК»_, пройшовши всі запропоновані кроки та запустіть встановлену програму.
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-08.png[]
[#key_info]
* 4.3. У вікні програми натисніть «`Зчитати`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-09.png[]

* 4.4. Оберіть ключ у відповідній директорії. Далі введіть пароль ключа і натисніть «`Зчитати`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-10.png[]

* 4.5. Після зчитування ключа в інтерфейсі програми _«ІІТ Користувач ЦСК»_ з’явиться нове меню «`Переглянути власний сертифікат`» - натисніть на нього.
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-11.png[]

* 4.6. У новому вікні буде зазначена інформація з назвою АЦСК у полі «`ЦСК`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-12.png[]

* 4.7. Скопіюйте назву ЦСК на попередньому кроці і вставте її значення в поле «`АЦСК, що видав ключ`» в налаштуваннях реєстру *Control Plane*.
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-13.png[]

. Наступним кроком необхідно додати список сертифікатів сумісних ЦСК (link:https://iit.com.ua/download/productfiles/CACertificates.p7b[CACertificates.p7b]), який можна отримати на сайті АТ "ІІТ" за посиланням https://iit.com.ua/downloads.
+
Додайте файл сертифікату, натиснувши кнопку «`Вибрати файл`» у полі «`Публічні сертифікати АЦСК (розширення .p7b)`». У новому вікні перейдіть до директорії, де зберігається файл сертифікату, оберіть його і натисніть «`Відкрити`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-14.png[]

. Далі необхідно додати параметри взаємодії із сумісними ЦСК (link:https://iit.com.ua/download/productfiles/CAs.json[CAs.json]), який можна отримати на сайті АТ "ІІТ" за посиланням https://iit.com.ua/downloads.
+
Додайте файл сертифікату, натиснувши кнопку «`Вибрати файл`» у полі «`Перелік АЦСК (розширення .json)`». У новому вікні перейдіть до директорії, де зберігається файл з параметрами, оберіть його і натисніть «`Відкрити`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-15.png[]

. Далі необхідно вказати «`Перелік дозволених ключів`», підпис яких може вважатися достовірним.
+
[NOTE]
У цьому блоці зазначається перелік ключів, у тому числі і старих _(наприклад, при ротації ключів)_, щоб все, що раніше було підписано старим ключем, вважалося валідованим. Тобто перелік дозволених ключів повинен містити історію даних усіх ключів, що використовувались у системі для накладання підпису.
+
В переліку дозволених ключів вказуються наступні дані ключа:

** `«Емітент ключа»` _(кроки xref:#issuer_key[7.1. - 7.2. цієї інструкції])_;
** `«Серійний номер ключа»` _(кроки xref:#serial_number[7.3. - 7.4. цієї інструкції])_.

+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-16.png[]

+
[#issuer_key]
* 7.1. Для отримання інформації для поля «`Емітент ключа`» необхідно відрити детальну інформацію про ключ, після його зчитування в програмі _«ІІТ Користувач ЦСК»_ _(кроки xref:#key_info[4.3. – 4.6. цієї інструкції])_, натиснувши «`Детальна інформація`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-17.png[]

* 7.2. У новому вікні вибрати рядок «`Реквізити ЦСК`», і в нижньому полі скопіювати його повне значення для заповнення поля «`Емітент ключа`» в *Control Plane*.
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-18.png[]
+
[#serial_number]
* 7.3. Для отримання інформації для поля «`Серійний номер ключа`» необхідно відрити детальну інформацію про ключ, після його зчитування в програмі _«ІІТ Користувач ЦСК»_ _(кроки xref:#key_info[4.3. – 4.6. цієї інструкції])_, натиснувши «`Детальна інформація`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-17.png[]

* 7.4. У новому вікні вибрати рядок «`Реєстраційний номер`», і в нижньому полі скопіювати його повне значення для заповнення поля «`Серійний номер ключа`» в *Control Plane*.
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-19.png[]

. Для завершення перевірте внесену інформацію і натисніть кнопку «`Підтвердити`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-20.png[]
+
[WARNING]
====
Внесені зміни будуть доступні приблизно через 10-30 хвилин.
====

=== Налаштування апаратного ключа

. Оберіть «`Тип носія`» - «`Апаратний носій`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-21.png[]

. Значення поля «`Тип ключа`» зазначається за замовчуванням значенням _«`криптомод. ІІТ Гряда-301`»_.
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-22.png[]

. Введіть пароль апаратного ключа у відповідному полі.
+
[NOTE]
====
Пароль ключа має наступну структуру `&#35;&#35;User&#35;&#35;Password`.
====
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-23.png[]

. Наступним кроком необхідно зазначити назву АЦСК у полі «`Ім'я АЦСК`».
+
* 4.1. Отримати інформацію про назву АЦСК можливо у програмі _«ІІТ Користувач ЦСК»_, відкрийте її.
+
[TIP]
====
Кроки інсталяції програми описані у xref:#iit[пунктах 4.1-4.3] попереднього розділу.
====

* 4.2. У вікні програми натисніть «`Зчитати`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-09.png[]

* 4.3. Оберіть ключ у директорії «`криптомод. ІІТ Гряда-301`». Далі введіть пароль ключа _(у форматі `&#35;&#35;User&#35;&#35;Password`)_ і натисніть «`Зчитати`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-24.png[]

* 4.4. Після зчитування ключа в інтерфейсі програми _«ІІТ Користувач ЦСК»_ з’явиться нове меню «`Переглянути власний сертифікат`» - натисніть на нього.
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-11.png[]

* 4.5. Натисніть «`Детальна інформація`»
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-17.png[]

* 4.6. Скопіюйте назву ЦСК.
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-25.png[]

* 4.7. Вставте значення в поле «`Ім'я АЦСК`» в налаштуваннях реєстру Control Plane.
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-23.png[]

. Наступним кроком необхідно вказати параметр «`Хост АЦСК`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-28.png[]
+
[TIP]
====
Значення можна переглянути у файлі параметрів взаємодії із сумісними ЦСК (link:https://iit.com.ua/download/productfiles/CAs.json[CAs.json]), який можна отримати на сайті АТ "ІІТ" за посиланням https://iit.com.ua/downloads.

image:admin:infrastructure/cluster-mgmt/change-key/change-key-26.png[]
====

. Далі необхідно зазначити параметр «`Порт АЦСК`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-29.png[]
+
[TIP]
====
Значення можна переглянути у файлі параметрів взаємодії із сумісними ЦСК (link:https://iit.com.ua/download/productfiles/CAs.json[CAs.json]), який можна отримати на сайті АТ "ІІТ" за посиланням https://iit.com.ua/downloads.

image:admin:infrastructure/cluster-mgmt/change-key/change-key-27.png[]
====

. Вкажіть «`Серійний номер пристрою`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-32.png[]
+
[NOTE]
====
Наступні параметри зазначаються під час створення і налаштування мережевого криптомодуля.

image:admin:infrastructure/cluster-mgmt/change-key/change-key-31.png[]
====
+
[TIP]
====
Серійний номер пристрою відображається в назві ключа, наприклад:

`001:3016(10.0.200.102)`, де

* `001` -- серійний номер пристрою;
* `3016` -- порт ключа;
* `10.0.200.102` -- хост ключа.

image:admin:infrastructure/cluster-mgmt/change-key/change-key-30.png[]
====

. Вкажіть «`Порт ключа`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-33.png[]

. Вкажіть «`Хост ключа`» (IP-адреса).
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-34.png[]

. Вкажіть «`Маску ключа`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-35.png[]
+
[TIP]
====
За замовчуванням встановлюється значення -- `255.255.255.255`.
====

. На підставі усіх раніше вказаних параметрів буде автоматично сконфігуровано INI-файл, детальна інформація щодо його вмісту і додаткових параметрів відображається у відповідному полі «`INI конфігурація`», яке доступне до редагування.
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-36.png[]

. Наступним кроком необхідно додати список сертифікатів сумісних ЦСК (link:https://iit.com.ua/download/productfiles/CACertificates.p7b[CACertificates.p7b]), який можна отримати на сайті АТ "ІІТ" за посиланням https://iit.com.ua/downloads.
+
Додайте файл сертифікату, натиснувши кнопку «`Вибрати файл`» у полі «`Публічні сертифікати АЦСК (розширення .p7b)`». У новому вікні перейдіть до директорії, де зберігається файл сертифікату, оберіть його і натисніть «`Відкрити`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-14.png[]

. Далі необхідно додати параметри взаємодії із сумісними ЦСК (link:https://iit.com.ua/download/productfiles/CAs.json[CAs.json]), який можна отримати на сайті АТ "ІІТ" за посиланням https://iit.com.ua/downloads.
+
Додайте файл сертифікату, натиснувши кнопку «`Вибрати файл`» у полі «`Перелік АЦСК (розширення .json)`». У новому вікні перейдіть до директорії, де зберігається файл з параметрами, оберіть його і натисніть «`Відкрити`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-15.png[]

. Вкажіть «Перелік дозволених ключів», підпис яких може вважатися достовірним.
+
[NOTE]
У цьому блоці зазначається перелік ключів, у тому числі й старих _(наприклад, при ротації ключів)_, щоб все, що раніше було підписано старим ключем, вважалося валідованим. Тобто перелік дозволених ключів повинен містити історію даних усіх ключів, що використовувались у системі для накладання підпису.
+
В переліку дозволених ключів вказуються наступні дані ключа:

** `«Емітент ключа»` _(як отримати інформацію показано у кроках xref:#issuer_key[7.1. - 7.2. попереднього розділу])_;
** `«Серійний номер ключа»` _(як отримати інформацію показано у кроках xref:#serial_number[7.3. - 7.4. попереднього розділу])_.

+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-16.png[]

. Для завершення перевірте внесену інформацію і натисніть кнопку «`Підтвердити`».
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-37.png[]
+
[WARNING]
====
Внесені зміни будуть доступні приблизно через 10-30 хвилин.
====





