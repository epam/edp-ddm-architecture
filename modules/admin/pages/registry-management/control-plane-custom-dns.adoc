:toc-title: ЗМІСТ
:toc: auto
:toclevels: 5
:experimental:
:important-caption:     ВАЖЛИВО
:note-caption:          ПРИМІТКА
:tip-caption:           ПІДКАЗКА
:warning-caption:       ПОПЕРЕДЖЕННЯ
:caution-caption:       УВАГА
:example-caption:           Приклад
:figure-caption:            Зображення
:table-caption:             Таблиця
:appendix-caption:          Додаток
:sectnums:
:sectnumlevels: 5
:sectanchors:
:sectlinks:
:partnums:

= Налаштування власного DNS-імені для Кабінетів
{empty} +

[CAUTION]
====
Документ у процесі формування
====

== Загальний опис

В адміністративному інтерфейсі керування кластером та реєстрами Control Plane реалізовано можливість використання власного DNS-імені для публічних Кабінетів отримувача послуг та посадової особи.

[TIP]
====
*DNS* _(англ. Domain Name System)_ cистема доменних імен  — ієрархічна розподілена система перетворення імені будь-якого мережевого пристрою в IP-адресу.
====

Для налаштування власного DNS-ім'я для Кабінетів отримувача послуг та/або посадової особи необхідно мати зареєстроване доменне ім'я (наприклад, `_registry.example.com_`) та SSL-сертифікат для домену чи субдомену `_registry.example.com_` або одночасно для всіх субдоменів першого рівня `_*.example.com_`.

Інтерфейс адміністрування розділяє отриманий сертифікат на CA (_Certificate Authority_) сертифікат і ключ, та зберігає їх в центральному HashiCorp Vault, використовуючи KV engine, та додає отримані DNS-імена до *`values.yaml`* у форматі:

[source, yaml]
----
global:
  customDNS:
    officerPortal: "officer.example.com"
    citizenPortal: "citizen.example.com"
----

== Налаштування DNS-імен для Кабінетів

Для налаштування власного DNS-ім'я для Кабінетів отримувача послуг та/або посадової особи необхідно виконати наступні кроки:

[arabic]
. Увійдіть до адміністративної панелі реєстрами *Control Plane*, використовуючи попередньо отримані логін та пароль.
+
image:admin:infrastructure/cluster-mgmt/update-cluster-mgmt-01.png[]

. Перейдіть до розділу `Реєстри` та оберіть відповідний реєстр, в якому необхідно налаштувати DNS-ім'я.
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-01.png[]

. Натисніть кнопку `Редагувати`, що розташована у правому верхньому куті.
+
image:admin:infrastructure/cluster-mgmt/change-key/change-key-02.png[]
+
//TODO додати скріншот "редагувати dns-ім'я"

=== Налаштування DNS-імен для Кабінету отримувача послуг

Налаштуйте доменне ім'я для _Кабінету отримувача послуг_:

[arabic]
. Перейдіть до розділу "`Налаштування власних DNS`" та вкажіть `Доменне ім'я для кабінету громадянина`.
+
image:admin:registry-management/custom-dns/custom-dns-01.png[]

. Натисніть `Завантажити SSL-сертифікат`.
+
image:admin:registry-management/custom-dns/custom-dns-02.png[]

. У відповідній директорії оберіть необхідний сертифікат і натисніть `Відкрити`.
+
image:admin:registry-management/custom-dns/custom-dns-03.png[]

=== Налаштування DNS-імен для Кабінету посадової особи

Налаштуйте доменне ім'я для _Кабінету посадової особи_:

[arabic]
. Перейдіть до розділу "`Налаштування власних DNS`" та вкажіть `Доменне ім'я для кабінету чиновника`.
+
image:admin:registry-management/custom-dns/custom-dns-04.png[]

. Натисніть `Завантажити SSL-сертифікат`.
+
image:admin:registry-management/custom-dns/custom-dns-05.png[]

. У відповідній директорії оберіть необхідний сертифікат і натисніть `Відкрити`.
+
image:admin:registry-management/custom-dns/custom-dns-06.png[]

. Збережіть налаштування, натиснувши `Підтвердити`.
+
image:admin:registry-management/custom-dns/custom-dns-07.png[]

== Додаткова конфігурація за межами OpenShift-кластера та реєстру

. Виконайте зовнішню конфігурацію за межами OpenShift-кластера та реєстру.
+
[NOTE]
====
Посилання на інструкцію з налаштування доступну доступне на інтерфейсі консолі Control Plane.

image:admin:registry-management/custom-dns/custom-dns-08.png[]
====
[arabic]
. Створіть `CNAME` запис у свого постачальника DNS.
+
Він має вказувати на _Load Balancer_ прив'язаного до OpenShift роутера (_HAProxy_). Домен роутера OpenShift відрізняється для кожного кластера. Записи CNAME завжди повинні вказуватися на інше доменне ім’я, а не на IP-адресу.
+
[TIP]
====
`CNAME` (Запис канонічного імені) -- це тип запису ресурсу в системі доменних імен (DNS), який співставляє одне доменне ім’я (псевдонім) з іншим (канонічне ім’я).
====
+
`CNAME` запис може виглядати так:
+
____
www.example.net. CNAME www.example.com.
____
+
Подивитись на поточні встановлені CNAME записи можна за допомогою сервісу link:https://dns.google[dns.google].
+
[WARNING]
====
`CNAME` не може бути встановлений для *apex*-доменів (example.com), а піддомен повинен бути вказаний (www.example.com).
====

. Напишіть в Telegram каналі `[EPAM] IIT Digital Signature Library Questions` запит на додавання нової адреси до тестового віджету link:https://eu.iit.com.ua/[eu.iit.com.ua].
+

+
--
Кабінет посадової особи та отримувача послуг стає доступний за налаштованими DNS-іменами після додаткової (ручної) зовнішньої конфігурації адміністратором.

[CAUTION]
Зазвичай оновлення DNS-імен відбувається впродовж однієї години, хоча глобальне оновлення може тривати до 48 годин.
--

//TODO додати аналогічний опис до інструкції xref:admin:registry-management/control-plane-create-registry.adoc[Розгортання екземпляру реєстру]