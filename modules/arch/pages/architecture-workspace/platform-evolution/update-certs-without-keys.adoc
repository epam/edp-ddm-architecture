= Розділення процесу оновлення сертифікатів надавачів послуг та процесу оновлення ключів

Надання можливості технічним адміністраторам оновлювати сертифікати надавачів послуг та перелік АЦСК для Платформи та
реєстрів окремо від процедури оновлення ключів послуг.

== Загальний опис

=== Ролі користувачів
* Технічний адміністратор реєстру
* Технічний адміністратор Платформи

== Функціональні сценарії
* Оновлення даних для перевірки ключа (кореневих сертифікатів _CACertificates.p7b_ та переліку АЦСК _CAs.json_)
через адмін-консоль
* Оновлення даних про ключ
* Оновлення переліку дозволених ключів

== Загальні принципи та положення
* Після оновлення секретів ключів має відбутися перезавантаження компонента DSO для того, щоб нові значення підтягнулись
* При створенні та редагуванні реєстру або Платформи, пункти меню _Дані про ключ_, _Дані для перевірки ключа_ та
_Перелік дозволених ключів_ повинні налаштовуватись окремо та незалежно один від одного
* Окремі налаштування стосуються всіх типів ключів (апаратних та файлових)

== Дизайн існуючого рішення
Функціонал по оновленню ключів, сертифікатів та переліку АЦСК обʼєднаний разом та всі поля обовʼязкові для заповнення

=== Недоліки поточної реалізації
Для заміни сертифікатів _CACertificates.p7b_ та переліку АЦСК адміністратору необхідно також ввести оновлення ключів реєстру.

== Технічний дизайн рішення
У порівнянні з поточною реалізацією потрібно тільки додати до імені секрету в Gerrit поточну дату оновлення в форматі
short ISO8601 (без двокрапок та тире) й оновлюватись в values.yaml реєстру та платформи, щоб пайплайн міг тригернутись.

Подивитись поточну реалізацію можна xref:architecture/platform/administrative/config-management/registry-platform-keys.adoc[тут]

=== Орієнтовні макети дизайну адмін-консолі

.Макет налаштування даних про ключ
[png]
image::architecture-workspace/platform-evolution/reg-keys/mock-reg-keys.png[mock-reg-keys]

.Макет налаштування даних для перевірки ключів
[png]
image::architecture-workspace/platform-evolution/reg-keys/mock-reg-keys-2.png[mock-reg-keys-2]

== План розробки
=== Технічні експертизи
* DevOps
* FrontEnd/BE

=== План розробки
* Розділити логічно UI елементи по групах та налаштувати валідацію
* Додати до імені файлу в Gerrit поточну дату та час

=== Міграція даних при оновленні реєстру
Всі внесені зміни повинні бути зворотно сумісні з попередніми версіями консолі.

== Безпека