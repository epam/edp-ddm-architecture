= Налаштування компонента Select у додатку FormIO для підтягнення та фільтрації даних з API-ендпоінту
::toc-title: ЗМІСТ
:toc: auto
:toc-title: ЗМІСТ
:toclevels: 5
:experimental:
:important-caption:     ВАЖЛИВО
:note-caption:          ПРИМІТКА
:tip-caption:           ПІДКАЗКА
:warning-caption:       ПОПЕРЕДЖЕННЯ
:caution-caption:       УВАГА
:example-caption:           Приклад
:figure-caption:            Зображення
:table-caption:             Таблиця
:appendix-caption:          Додаток
:sectnums:
:sectnumlevels: 5
:sectanchors:
:sectlinks:
:partnums:

TIP: *API Endpoint (Кінцева точка інтеграційної взаємодії, ендпоінт)* -- це точка входу в канал зв’язку, при взаємодії двох систем.

Для інтеграції форм бізнес-процесів із фабрикою даних використовується компонент **Select** із додатковими налаштуваннями.

Поточна інструкція описує налаштування компонента Select для показу даних з ендпоінту та фільтрації даних з іншого компонента Select.

== Налаштування компонента Select для підтягнення даних з ендпоінту

* Увійдіть до **Кабінету адміністратора регламентів** та створіть форму.
* Перейдіть на вкладку **Компоненти** та додайте компонент **Select**.
* Відкрийте меню налаштувань для компонента (кнопка налаштувань із шестернею).

image:registry-develop:bp-modeling/forms/bp-select/bp-select-form-io-1.png[]

* На вкладці **Display**, у полі `Label`, зазначте назву компонента.

image:registry-develop:bp-modeling/forms/bp-select/bp-select-form-io-2.png[]

* На вкладці **API**, у полі `Property Name`, введіть назву компонента в API-ендпоінті (наприклад, значення `selectProcessInstanceId`).

image:registry-develop:bp-modeling/forms/bp-select/bp-select-form-io-3.png[]

* Перейдіть до вкладки **Data** -> далі в полі **Data Source Type** введіть значення `URL`.
* Вкажіть значення для endpoint URL у полі **Data Source URL** (наприклад, `https://user-proc-mng-lowcode-pipe-qa.apps.cicd.mdtu-ddm.projects.epam.com/api/process-instance`).

image:registry-develop:bp-modeling/forms/bp-select/bp-select-form-io-5.png[]

* Зазначте **Value Property** у відповідному полі -- назва властивості із JSON-відповіді ендпоінту, яка зберігатиметься як значення після селекту (наприклад, `id`).

* Встановіть **Item Template** -- HTML-шаблон для відображення значень у селекті, як показано на прикладі нижче.

NOTE: `processDefinitionName` _та `id` беруться із відповіді ендпоінту та відображатимуться в селекті)._

.Приклад HTML-шаблону

[source,html]
----
<span>{{ item.processDefinitionName }}</span>
<span>{{ item.id}}</span>
----

image:registry-develop:bp-modeling/forms/bp-select/bp-select-form-io-6.png[]

.Приклад запита та відповіді у Swagger UI

image:registry-develop:bp-modeling/forms/bp-select/bp-select-form-io-4.png[]

* Збережіть зміни до компонента, натиснувши кнопку `Save`.

image:registry-develop:bp-modeling/forms/bp-select/bp-select-form-io-7.png[]

В результаті у випадному списку підтягнеться назва та ідентифікатор (id) усіх послуг, ініційованих посадовою особою.

== Налаштування залежного компонента Select для фільтрації даних з іншого компонента

* Відкрийте форму із компонентом, дані якого потрібно фільтрувати.
* Перейдіть на вкладку **Компоненти** та додайте компонент **Select**.
* Відкрийте меню налаштувань для компонента (кнопка налаштувань із шестернею).

image:registry-develop:bp-modeling/forms/bp-select/bp-select-form-io-1.png[]

* На вкладці **Display**, у полі `Label`, зазначте назву компонента.

image:registry-develop:bp-modeling/forms/bp-select/bp-select-form-io-2.png[]

* На вкладці **API**, у полі `Property Name`, введіть назву компонента в API-ендпоінті FormIO (наприклад, значення `selectRelatedTasks`).

image:registry-develop:bp-modeling/forms/bp-select/bp-select-form-io-8.png[]

* Перейдіть до вкладки **Data** -> далі в полі **Data Source Type** введіть значення `URL`.
* Вкажіть значення для endpoint URL у полі **Data Source URL** (наприклад, `https://user-task-mng-lowcode-pipe-qa.apps.cicd.mdtu-ddm.projects.epam.com/api/task`).

image:registry-develop:bp-modeling/forms/bp-select/bp-select-form-io-9.png[]

* Зазначте **Value Property** у відповідному полі -- назва властивості із JSON-відповіді ендпоінту, яка зберігатиметься як значення після селекту (наприклад, `formKey`).
* Зазначте **Filter Query** у відповідному полі -- запит параметрів, який додаватиметься до ендпоінту та фільтруватиме його відповідь (наприклад, `processInstanceId={{data.selectProcessInstanceId}}`)

NOTE: `data.selectProcessInstanceId` -- _назва `Property Name` (вкладка **API**) компонента, дані якого необхідно фільтрувати, і який зберігається в об'єкті `data`._

* Встановіть **Item Template** -- HTML-шаблон для відображення значень у селекті, як показано на прикладі нижче.

NOTE: `name` _та `id` беруться із відповіді ендпоінту та відображатимуться в селекті)._

.Приклад HTML-шаблону
[source,html]
----
<span>{{ item.name}}</span>

<span>{{ item.id}}</span>
----

* Встановіть **Refresh On** -- компонент, на який повинен орієнтуватися поточний компонент під час фільтрації.
* Встановіть прапорець для `Clear Value On Refresh Options`

image:registry-develop:bp-modeling/forms/bp-select/bp-select-form-io-11.png[]

.Приклад запита у Swagger UI
image:registry-develop:bp-modeling/forms/bp-select/bp-select-form-io-10.png[]

* Збережіть зміни до компонента, натиснувши `Save`.

image:registry-develop:bp-modeling/forms/bp-select/bp-select-form-io-12.png[]

В результаті у випадному списку підтягнуться назва та ідентифікатор (id) усіх задач, які належать до послуги, обраної в іншому Select-компоненті.

[#select-refresh-option-on]
== Використання функції "Refresh Options on" в оновленому компоненті Select

Адміністратор регламенту має змогу одночасно підключати декілька стилізованих компонентів до функції `Refresh Options on` в рамках компонента Select.

[TIP]
====
Функція `Refresh option on` дозволяє оновлювати дані при зміні іншого поля.
====

Виконати такі налаштування можна в Кабінеті адміністратора регламентів, при моделюванні форм до бізнес-процесів.

. Увійдіть до кабінету адміністратора регламентів
+
image:registry-develop:registry-admin/import-users(officer)/import-users(officer)-01.png[]

. Оберіть розділ `Моделювання UI-форм`.
+
image:registry-develop:bp-modeling/forms/component-file-multiple-values/component-file-multiple-values-01.png[]

. Натисніть `Створити нову форму`.
+
image:registry-develop:bp-modeling/forms/component-file-multiple-values/component-file-multiple-values-02.png[]

. Вкажіть `бізнес-назву форми` й `службову назву форми`.
+
image:registry-develop:bp-modeling/forms/bp-select/bp-select-refresh-option-on-1.png[]

. Оберіть розділ `Оновлені`. Зі списку оберіть компонент `Select` і перетягніть його до області налаштування форми.
+
Далі натисніть `Save`.

. Аналогічно перетягніть до області налаштування форми та збережіть ще 2 компоненти: `Checkbox` та `Textfield`.

. Перейдіть до налаштувань оновленого компонента `Select`.
+
image:registry-develop:bp-modeling/forms/bp-select/bp-select-refresh-option-on-2.png[]
+
[TIP]
Для зручності змініть назву компонента (поля форми) з `Default Label` на `Select`.

. У полі `Data Source Values` внесіть тестові дані. Наприклад, `1,2,3`.
+
image:registry-develop:bp-modeling/forms/bp-select/bp-select-refresh-option-on-3.png[]

. Перейдіть на вкладку *Data*.
+
У полі `Refresh Options on` у випадному списку можна побачити попередньо обрані компоненти: `Checkbox` та `Textfield`.
+
Додайте обидва компоненти як значення у полі та натисніть `Submit`.
+
image:registry-develop:bp-modeling/forms/bp-select/bp-select-refresh-option-on-4.png[]
+
image:registry-develop:bp-modeling/forms/bp-select/bp-select-refresh-option-on-5.png[]
+
[TIP]
Таким чином ми підключаємо декілька стилізованих компонентів до функції `Refresh Options on`.

. Щоб дані могли змінюватися, активуйте поле `Clear Value on Refresh options`.

. Прокрутіть бігунок уверх і натисніть `Save`, щоб зберегти зміни.
+
image:registry-develop:bp-modeling/forms/bp-select/bp-select-refresh-option-on-6.png[]

. Активуйте режим попереднього перегляду (Preview).
+
image:registry-develop:bp-modeling/forms/bp-select/bp-select-refresh-option-on-7.png[]

. У полі компонента `Select` внесіть значення `1`.

. Активуйте поле `Checkbox`.
+
В результаті видалиться значення з поля `Select`.

. У полі `Select` внесіть значення ще раз. Наприклад, `3`.

. Внесіть значення у полі `Textfield`.
+
[TIP]
В результаті зникають значення з поля `Select`. Це відбувається завдяки покращенню функції `Refresh Options on`.