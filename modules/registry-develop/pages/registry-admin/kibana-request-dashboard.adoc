= Візуалізація стану запитів в Kibana при роботі реєстру

== Зовнішній вигляд
Даний дашборд дозволяє отримувати загальну інформацію про роботу реєстру на рівні статусів виконання зовнішніх запитів.
Містить в себе декілька візуалізацій:

* Запити до API Gateway (показує загальну кількість зовнішніх http запитів які прийшли до реєстру)
* Помилки в Rest API дата фабрики
* Використання КЕП в реєстрі (загальна кількість операцій, виконаних на криптосервісі з розділенням по типу по статусу
виконання)
* Запити до мікросервісів реєстрів (загальна кількість запитів з розділенням по http коду відповіді)

image:registry-admin/kibana/dashboard-1.png[]
image:registry-admin/kibana/dashboard-2.png[]

== Налаштування
Для встановлення даного дашборда необхідно виконати наступне:

1. Завантажити файл за link:{attachmentsdir}/kibana/request-dashboard.json[посиланням]

2. Замінити в файлі всі плейсхолдери з назвою *YOUR_REGISTRY_NAME* на назву потрібного реєстру в пошукових запитах (5 шт)
в зручному для Вас текстовому редакторі
image:registry-admin/kibana/file-prep-1.png[]
image:registry-admin/kibana/file-prep-2.png[]
image:registry-admin/kibana/file-prep-3.png[]

3. Створіть через веб інтерфейс Kibana 2 index pattern: _app-\*_ та _app-REGISTRY-NAME-*_,
де _REGISTRY-NAME_ - назва вашого реєстру
image:registry-admin/kibana/index-pattern-1.png[]

4. Імпортуйте підготовлений на 2 кроці файл через веб інтерфейс Kibana
image:registry-admin/kibana/import-dashboard-1.png[]
image:registry-admin/kibana/import-dashboard-2.png[]
При імпорті оберіть відповідні індекс паттерни для візуалізацій (_app-*_ та _app-REGISTRY-NAME-*_,)
image:registry-admin/kibana/import-dashboard-3.png[]

5. Налаштування динамічного фільтру. Для коректної роботи фільтра "Фільтр для мікросервісів" потрібно оновити значення
index pattern id. Для цього потрібно:

* Зайти у візуалізацію "Запити до API Gateway"
image:registry-admin/kibana/filter-setup-1.png[]
* Cкопіювати значення у полі index у секції "kibanaSavedObjectMeta.searchSourceJSON"
image:registry-admin/kibana/filter-setup-2.png[]
* Зайти у візуалізацію "Фільтр для мікросервісів" та Змінити значення поля params.controls[0].indexPattern (default value
APP-*_INDEX_ID) у секції "visState" на значення з попереднього пункту
image:registry-admin/kibana/filter-setup-3.png[]
image:registry-admin/kibana/filter-setup-4.png[]
image:registry-admin/kibana/filter-setup-5.png[]

6. На сторінці Dashboard/Стан запитів
image:registry-admin/kibana/final-result-1.png[]






