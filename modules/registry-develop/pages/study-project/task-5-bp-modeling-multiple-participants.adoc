= Завдання 5. Моделювання бізнес-процесу декількома учасниками
:sectnums:
:sectanchors:
:toc:
:toclevels: 5
:toc-title: ЗМІСТ

== Мета завдання

Виконання цього завдання має на меті:

* Навчити моделювати бізнес-процес, що має декількох учасників.
* Навчити моделювати форми та налаштовувати їх за допомогою *formVariables*.

== Передумови

Перед проходженням завдання необхідно виконати наступні передумови:

. xref:registry-develop:bp-modeling/bp/bp-element-templates-installation-configuration.adoc#business-process-modeler-extensions-installation[Встановіть додаток Camunda Modeler і типові розширення до нього].
. xref:registry-develop:bp-modeling/forms/bp-modeling-forms-general-description.adoc[Ознайомтеся із компонентами FormIO для моделювання форм].

== Процес виконання завдання

=== Моделювання бізнес-процесу

[TIP]
====
На етапі моделювання бізнес-процесу необхідно створити та зберегти відповідну BPMN-діаграму.

Використовуйте файл _link:{attachmentsdir}/study-project/task-5/bp-schema/citizen-add-lab.bpmn[citizen-add-lab.bpmn]_ із готовою схемою бізнес-процесу для прикладу.
====

==== Етапи моделювання бізнес-процесу

В рамках цього завдання моделювальник має створити бізнес-процес, що складається з наступних етапів:
//TODO: Add stages

==== Створення пулу для бізнес-процесу

Найперше, _змоделюйте пул для бізнес-процесу_. Для цього виконайте кроки, подані нижче:

NOTE: Моделювання діаграми бізнес-процесу має відбуватися в рамках елемента *Create Pool/Participant*.


. Відкрийте додаток *Camunda Modeler* та створіть нову діаграму BPMN. Для цього у лівому верхньому куті натисніть меню *File* -> *New File* -> *BPMN Diagram*:
+
image:registry-develop:bp-modeling/bp/modeling-instruction/bp-1.png[]

. На панелі інструментів зліва знайдіть елемент *Create pool/Participant* та перетягніть його до панелі моделювання:
+
image:registry-develop:bp-modeling/bp/modeling-instruction/bp-2.png[]

. Заповніть наступні поля відповідними значеннями:

* у полі `Name` введіть значення `Створення лабораторії`;
* у полі `Process id` вкажіть `citizen-add-lab`;
* у полі `Process name` вкажіть `Процес створення лабораторії`:

+
image:study-project/task-5/task-5-bp-1.png[]


[#create-start-event]
==== Створення початкової події

_Створіть початкову подію_. Для цього виконайте наступні кроки:

. На панелі інструментів, зліва, знайдіть елемент (коло) *CreateStartEvent* та перетягніть його до панелі моделювання:
+
image::registry-develop:bp-modeling/bp/bp-keys/bp-keys-create-start-event.png[]
+
image::registry-develop:bp-modeling/bp/bp-keys/bp-keys-create-start-event-1.png[]

. На панелі налаштувань справа заповніть наступні параметри відповідними значеннями:
** у полі `Name` введіть `Початок`;
** у полі `Initiator` введіть `initiator`.

+
image:study-project/task-5/task-5-bp-2.png[]

==== Створення задачі скриптування "Підготовка даних для показу"

На цьому етапі необхідно _змоделювати задачу скриптування для підготовки даних до показу_. Для цього виконайте наступні кроки:

. Оберіть коло із початковою подією, змодельованою на xref:#create-start-event[попередньому етапі], та приєднайте нову задачу, натиснувши іконку *Append Task*:
+
image:study-project/task-5/task-5-bp-03.png[]

. Вкажіть тип задачі, натиснувши іконку ключа та обравши з меню пункт *Script Task* (Задача скриптування):
+
image:study-project/task-5/task-5-bp-03-1.png[]

. Виділіть додану задачу скриптування та налаштуйте наступні параметри:

* у полі `Id` вкажіть `convertSignFormDataToDataFactoryFormatActivity`;
** у полі `Name` введіть `Підготовка даних для запису (transient var)`;
*** у полі `Script Format` зазначте формат (мову) скриптування `groovy`;
** у полі `Script type` вкажіть тип скрипту `InlineScript`;
* у полі `Script` вставте безпосередньо groovy-скрипт:
+
====
[%collapsible]
.Натисніть, щоб розгорнути або згорнути
=====
[source,groovy]
----
def cephData = [:]

cephData['edrpou'] = initiator().edrpou

execution.removeVariable('payload')
execution.setVariableLocalTransient('payload', S(cephData, 'application/json'))
----
=====
====
+
image:study-project/task-5/task-5-bp-3.png[]






